(function(){"use strict";var e={1719:function(e,t,n){var i=n(9242),s=n(3396),a=n(2268);function o(e,t,n,i,o,c){const r=(0,s.up)("router-view");return(0,s.wg)(),(0,s.iD)("div",{class:(0,a.C_)(["app",{loginColor:c.isSignIn}])},[(0,s.Wm)(r)],2)}var c=n(7139),r={computed:{isSignIn(){return"/login"===this.$route.path}},methods:{...(0,c.OI)(["loadDataFromLocalStorage","loadDataFromSessionStorage"])},mounted(){null===sessionStorage.getItem("token")?null===localStorage.getItem("token")?this.$router.push("/login"):this.loadDataFromLocalStorage():this.loadDataFromSessionStorage()}},l=n(89);const d=(0,l.Z)(r,[["render",o]]);var h=d;const p={class:"wrapper"};function u(e,t,n,i,a,o){const c=(0,s.up)("nav-bar"),r=(0,s.up)("meetings");return(0,s.wg)(),(0,s.iD)("div",p,[(0,s.Wm)(c),(0,s.Wm)(r)])}const m=e=>((0,s.dD)("data-v-194b2483"),e=e(),(0,s.Cn)(),e),g={class:"header"},w={class:"title-name title-names"},v={class:"nav-bar-list"},C=m((()=>(0,s._)("input",{type:"checkbox",name:"",id:"checkbox_toggle"},null,-1))),_=m((()=>(0,s._)("label",{for:"checkbox_toggle",class:"hamburger"},[(0,s._)("span",{class:"hamburger-line"})],-1))),y={class:"menu-items"},f=(0,s.Uk)("Мои клиенты"),k=(0,s.Uk)("Календарь"),D=(0,s.Uk)("Отчёты по встречам"),b=m((()=>(0,s._)("button",{class:"log-out-item"},"Выйти",-1))),M=[b],P=m((()=>(0,s._)("button",{class:"nav-bar-notify-button"},[(0,s._)("img",{src:"/svg/notify.svg",alt:"",class:"nav-bar-notify-icon"})],-1))),S={class:"popup_wrapper"},I=m((()=>(0,s._)("h1",{class:"popup-title"},"Доступные комнаты",-1))),$=m((()=>(0,s._)("img",{src:"/svg/add-meet.svg",alt:"",class:"nav-bar-icon-add"},null,-1))),H=[$],L=m((()=>(0,s._)("button",{class:"nav-bar-profile"},[(0,s._)("img",{src:"/svg/profile.svg",alt:"",class:"nav-bar-profile-icon"})],-1))),B=m((()=>(0,s._)("hr",{class:"line-header"},null,-1)));function E(e,t,n,o,c,r){const l=(0,s.up)("router-link"),d=(0,s.up)("loading-indicate"),h=(0,s.up)("v-popup");return(0,s.wg)(),(0,s.iD)("header",g,[(0,s._)("nav",null,[(0,s._)("div",w,[(0,s._)("h3",{class:"logo-name",onClick:t[0]||(t[0]=t=>e.$router.push("/"))},"Sber clients")]),(0,s._)("ul",v,[C,_,(0,s._)("div",y,[(0,s._)("li",{class:"nav-bar-list-item",onClick:t[1]||(t[1]=t=>e.$router.push("/clients"))},[(0,s.Wm)(l,{to:"/clients",class:"inactive","active-class":"active"},{default:(0,s.w5)((()=>[f])),_:1})]),(0,s._)("li",{class:"nav-bar-list-item",onClick:t[2]||(t[2]=t=>e.$router.push("/calendar"))},[(0,s.Wm)(l,{to:"/calendar",class:"inactive","active-class":"active"},{default:(0,s.w5)((()=>[k])),_:1})]),(0,s._)("li",{class:"nav-bar-list-item",onClick:t[3]||(t[3]=t=>e.$router.push("/results"))},[(0,s.Wm)(l,{to:"/results",class:"inactive","active-class":"active"},{default:(0,s.w5)((()=>[D])),_:1})]),(0,s._)("li",{class:"nav-bar-list-item button-exit",onClick:t[4]||(t[4]=(...e)=>r.logOutWrapper&&r.logOutWrapper(...e))},M)])]),P,(0,s._)("div",S,[c.isInfoPopupVisible?((0,s.wg)(),(0,s.j4)(h,{key:0,onClosePopup:r.closeInfoPopup,class:"modal-window"},{header:(0,s.w5)((()=>[I])),content:(0,s.w5)((()=>[c.isLoadedPlaces?(0,s.wy)(((0,s.wg)(),(0,s.iD)("select",{key:0,name:"",id:"",class:"select-room","onUpdate:modelValue":t[5]||(t[5]=e=>c.selected=e)},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(c.places,(e=>((0,s.wg)(),(0,s.iD)("option",{key:e},(0,a.zw)(e.name),1)))),128))],512)),[[i.bM,c.selected]]):((0,s.wg)(),(0,s.j4)(d,{key:1}))])),_:1},8,["onClosePopup"])):(0,s.kq)("",!0)]),(0,s._)("button",{class:"nav-bar-add-meet v-modal_add-meet",id:"btn-add",onClick:t[6]||(t[6]=(...e)=>r.showPopupInfo&&r.showPopupInfo(...e))},H),L,(0,s._)("button",{onClick:t[7]||(t[7]=(...e)=>r.logOutWrapper&&r.logOutWrapper(...e)),class:"log-out"},"Выйти")]),B])}const T={class:"popup_wrapper",ref:"popup_wrapper"},F={class:"v-popup__header"},U={class:"v-popup__content"},x={class:"v-popup__footer"};function W(e,t,n,a,o,c){return(0,s.wg)(),(0,s.iD)("div",T,[(0,s._)("form",{class:"v-popup animation",onSubmit:t[1]||(t[1]=(0,i.iM)((()=>{}),["prevent"]))},[(0,s._)("div",F,[(0,s.WI)(e.$slots,"header",{},void 0,!0),(0,s._)("span",null,[(0,s._)("i",{class:"material-icons",onClick:t[0]||(t[0]=(...e)=>c.closePopup&&c.closePopup(...e))}," close ")])]),(0,s._)("div",U,[(0,s.WI)(e.$slots,"content",{},void 0,!0)]),(0,s._)("div",x,[(0,s.WI)(e.$slots,"footer",{},void 0,!0)])],32)],512)}var N={props:{},data(){return{}},methods:{closePopup(){this.$emit("closePopup")}},mounted(){let e=this;document.addEventListener("click",(function(t){t.target===e.$refs["popup_wrapper"]&&e.closePopup()}))}};const O=(0,l.Z)(N,[["render",W],["__scopeId","data-v-b5ee4bea"]]);var z=O;const q=e=>((0,s.dD)("data-v-206c088c"),e=e(),(0,s.Cn)(),e),j={class:"loading-container"},Z=q((()=>(0,s._)("div",{class:"loading-indicator"},null,-1))),V=q((()=>(0,s._)("p",{class:"information-text"},"Загрузка данных...",-1))),A=[Z,V];function Y(e,t,n,i,a,o){return(0,s.wg)(),(0,s.iD)("div",j,A)}var K={};const R=(0,l.Z)(K,[["render",Y],["__scopeId","data-v-206c088c"]]);var Q=R,J=n(6265),G=n.n(J),X={actions:{async logIn(e,{username:t,password:n,isSavedSession:i}){const s=await oe.auth(t,n);if(null===s)return e.commit("setErrorMessage",oe.error),oe.error="",!1;e.commit("setToken",s.auth_token);let a=!0;const o=await e.dispatch("getUser");return null===o&&(a=!1),i&&e.commit("saveSessionToLocalStorage"),e.commit("saveSessionToSessionStorage"),a&&e.commit("setErrorMessage",""),a},async getUser(e){const t=await oe.currentUser(e.state.token);return null===t?(e.commit("setErrorMessage",oe.error),oe.error="",null):(e.commit("updateUser",t),t)}},mutations:{setToken(e,t){e.token=t,te()},saveSessionToLocalStorage(e){localStorage.setItem("token",e.token),localStorage.setItem("user",JSON.stringify(e.user))},saveSessionToSessionStorage(e){sessionStorage.setItem("token",e.token),sessionStorage.setItem("user",JSON.stringify(e.user))},updateUser(e,t){e.user=t},loadDataFromLocalStorage(e){e.token=localStorage.getItem("token"),e.user=JSON.parse(localStorage.getItem("user")),te()},loadDataFromSessionStorage(e){e.token=sessionStorage.getItem("token"),e.user=JSON.parse(sessionStorage.getItem("user")),te()},logOut(e){e.token="",e.user={},localStorage.removeItem("token"),localStorage.removeItem("user"),sessionStorage.removeItem("token"),sessionStorage.removeItem("user")},setErrorMessage(e,t){e.errorMessage=t}},state:{token:null,user:{},errorMessage:""},getters:{}};const ee=G().create({baseURL:"http://sbermeeting.tk/",headers:{accept:"application/json"}});function te(){ee.defaults.headers.common["Authorization"]="Token "+X.state.token}var ne=ee;const ie="api/v2/",se={auth:"users/auth/token/login/",user:"users/employee/current/",meetings:"meetings/",client:"clients/",contact:"clients/contacts/",place:"meetings/place/",employeelist:"employeelist/",users:"users/employee/",directions:"users/directions/",users_employee:"users/employee/"},ae={error:{},async auth(e,t){try{const n=await ne.post(ie+se["auth"],{username:e,password:t});return n.data}catch(n){return this.errorHandle(n),null}},async currentUser(){try{const e=await ne.get(ie+se["user"],{headers:{Authorization:"Token "+X.state.token}});return e.data}catch(e){return this.errorHandle(e),null}},async getMeetings(e=!1){try{const t=await ne.get(ie+se["meetings"]+"?employee="+X.state.user.id+(e?"&past=true":"&future=true"));return t.data}catch(t){return this.errorHandle(t),[]}},async getMeetingsInPlaceByDate(e,t){try{const n=await ne.get(ie+se["meetings"]+"?place="+t.id+"&date="+String(e.getFullYear())+"-"+String(e.getMonth()+1)+"-"+String(e.getDate()));return n.data}catch(n){return console.log(n),this.errorHandle(n),[]}},async getMeetingsByDate(e){try{const t=await ne.get(ie+se["meetings"]+"?date="+String(e.getFullYear())+"-"+String(e.getMonth()+1)+"-"+String(e.getDate()));return t.data}catch(t){return this.errorHandle(t),[]}},async getClients(e){try{let t=await ne.get(ie+se["client"]+(e?"?employee="+X.state.user.id:""));return t.data}catch(t){return this.errorHandle(t),[]}},async editClient(e){try{let t=await ne.patch(ie+se["client"]+e.id+"/",e);return t.data}catch(t){return this.errorHandle(t),{}}},async editContact(e){try{let t=await ne.patch(ie+se["contact"]+e.id+"/",e);return t.data}catch(t){return this.errorHandle(t),{}}},async getClientContacts(e){try{let t=await ne.get(ie+se["contact"]+"?client="+e);return t.data}catch(t){return this.errorHandle(t),[]}},async getPlaces(){try{let e=await ne.get(ie+se["place"]+"?my=true",{headers:{Authorization:"Token "+X.state.token}});return e.data}catch(e){return this.errorHandle(e),[]}},async getFreePlaces(e,t,n){try{let i=await ne.get(ie+se["place"]+"?date="+n+"&start="+e+"&end="+t+"&my=true");return i.data}catch(i){return this.errorHandle(i),[]}},async createMeeting(e){try{const t=await ne.post(ie+se["meetings"],e);return t.data}catch(t){return this.errorHandle(t),{}}},async createClient(e){try{let t=await ne.post(ie+se["client"],e);return t.data}catch(t){return this.errorHandle(t),{}}},async createContact(e){try{let t=await ne.post(ie+se["contact"],e);return t.data}catch(t){return this.errorHandle(t),{}}},async isExistClient(e){try{let t=await ne.get(ie+se["client"]+"?inn="+e.inn);return t.data.length}catch(t){return this.errorHandle(t),!1}},async isExistContact(e){try{let t=await ne.get(ie+se["contact"]+"?client="+e.client+"&first_name="+e.first_name+"&second_name="+e.second_name);return t.data.length}catch(t){return this.errorHandle(t),!1}},async getUsers(){try{let e=await ne.get(ie+se["users"]);return e.data}catch(e){return this.errorHandle(e),[]}},async deleteMeeting(e){try{let t=await ne["delete"](ie+se["meetings"]+e+"/");return t.data}catch(t){return this.errorHandle(t),{}}},async editMeeting(e){try{let t=await ne.patch(ie+se["meetings"]+e.id+"/",e);return t.data}catch(t){return this.errorHandle(t),{}}},async getDirections(){try{let e=await ne.get(ie+se["directions"]);return e.data}catch(e){return this.errorHandle(e),{}}},async getLinkedUsersByClientId(e){try{let t=await ne.get(ie+se["users_employee"]+"?client="+String(e));return t.data}catch(t){return this.errorHandle(t),{}}},async getClientLinkedUsersByDirection(e,t){try{let n=await ne.get(ie+se["users_employee"]+"?client="+String(e)+"&direction="+String(t));return n.data}catch(n){return this.errorHandle(n),{}}},errorHandle(e){if(e.response)switch(e.response.status){case 400:this.error="Неверный логин/пароль";break;case 401:this.error=e.response.statusText+"."+e.response.data.detail;break;default:this.error=e.message+"."+e.response.statusText}else e.request&&(this.error="Bad connection")}};var oe=ae,ce={components:{vPopup:z,LoadingIndicate:Q},methods:{...(0,c.OI)(["logOut"]),logOutWrapper(){this.$router.push("/login"),this.logOut()},showPopupInfo(){this.isInfoPopupVisible=!0},closeInfoPopup(){this.isInfoPopupVisible=!1}},data(){return{isInfoPopupVisible:!1,isLoadedPlaces:!1,places:[],selected:"test"}},async mounted(){this.places=await oe.getPlaces(),this.isLoadedPlaces=!0}};const re=(0,l.Z)(ce,[["render",E],["__scopeId","data-v-194b2483"]]);var le=re;const de=e=>((0,s.dD)("data-v-2dedb246"),e=e(),(0,s.Cn)(),e),he={class:"main-container"},pe={key:0,class:"near-meet"},ue=de((()=>(0,s._)("h2",{class:"near-meet-text"},"Ближайшая встреча:",-1))),me=de((()=>(0,s._)("button",{class:"pencil-meet"},[(0,s._)("img",{src:"/svg/pencil.svg",alt:"",class:"pencil-icon"})],-1))),ge={class:"client-name"},we={class:"window-tel-and-contact"},ve={class:"contact-window"},Ce={class:"tel-window"},_e={class:"theme-window"},ye={class:"data-and-time-window"},fe={class:"data-window"},ke={class:"time-window"},De={class:"place-window"},be={key:1,class:"container-window empty"},Me=de((()=>(0,s._)("p",null,"Нет ближайшей встречи",-1))),Pe=[Me],Se={class:"green-button-add"},Ie=(0,s.Uk)("Добавить встречу"),$e={key:3,class:"list-meet"},He=de((()=>(0,s._)("h2",{class:"list-meet-text"},"Список встреч:",-1))),Le=de((()=>(0,s._)("span",null,"Текущие",-1))),Be=de((()=>(0,s._)("span",null,"Прошедшие",-1))),Ee={key:0,class:"list-all-meet"},Te=["onClick"],Fe={class:"data-time-place-item"},Ue={class:"data-item"},xe={class:"time-item"},We={class:"place-item"},Ne={class:"theme-item"},Oe={class:"theme-item-container"},ze={class:"client-item"},qe={class:"client-item-container"},je={key:1,class:"list-all-meet"},Ze=de((()=>(0,s._)("li",{class:"all-meet-item empty"},[(0,s._)("p",null,"Нет встреч")],-1))),Ve=[Ze],Ae={class:"add-meeting-phone"},Ye=(0,s.Uk)("Добавить встречу");function Ke(e,t,n,i,o,c){const r=(0,s.up)("add-button"),l=(0,s.up)("create-meet"),d=(0,s.up)("segmented-control"),h=(0,s.up)("edit-button"),p=(0,s.up)("loading-indicate");return(0,s.wg)(),(0,s.iD)("main",he,[o.isLoadedMeetings?((0,s.wg)(),(0,s.iD)("div",pe,[ue,void 0!==o.nearMeeting?((0,s.wg)(),(0,s.iD)("div",{key:0,class:"container-window",onClick:t[0]||(t[0]=e=>c.editMeeting(this.nearMeeting))},[me,(0,s._)("p",ge,(0,a.zw)(o.nearMeeting.client_name),1),(0,s._)("div",we,[(0,s._)("p",ve,(0,a.zw)(o.nearMeeting.contact_name),1),(0,s._)("p",Ce,(0,a.zw)(o.nearMeeting.contact_phone),1)]),(0,s._)("p",_e,(0,a.zw)(o.nearMeeting.topic),1),(0,s._)("div",ye,[(0,s._)("p",fe,(0,a.zw)(o.nearMeeting.date),1),(0,s._)("p",ke,(0,a.zw)(o.nearMeeting.start)+" - "+(0,a.zw)(o.nearMeeting.end),1)]),(0,s._)("p",De,(0,a.zw)(o.nearMeeting.place_name),1)])):((0,s.wg)(),(0,s.iD)("div",be,Pe)),(0,s._)("div",Se,[(0,s.Wm)(r,{onClick:t[1]||(t[1]=e=>this.displayCreateMeetPopup=!0)},{default:(0,s.w5)((()=>[Ie])),_:1})])])):(0,s.kq)("",!0),o.displayEditMeetPopup?((0,s.wg)(),(0,s.j4)(l,{key:1,onClosePopup:c.closeEditPopup,isCreatePopup:!1,editingMeet:this.editingMeet,onCancelMeeting:c.deleteMeeting,onEditMeeting:c.changeEditedMeeting,class:"meet__modal-window"},null,8,["onClosePopup","editingMeet","onCancelMeeting","onEditMeeting"])):(0,s.kq)("",!0),o.displayCreateMeetPopup?((0,s.wg)(),(0,s.j4)(l,{key:2,onClosePopup:c.closeCreatePopup,onCreateMeeting:c.displayNewMeeting,class:"meet__modal-window"},null,8,["onClosePopup","onCreateMeeting"])):(0,s.kq)("",!0),o.isLoadedMeetings?((0,s.wg)(),(0,s.iD)("div",$e,[He,(0,s.Wm)(d,{class:"segmented-control",onSelected:c.selectedSegmentedControl},{item1:(0,s.w5)((()=>[Le])),item2:(0,s.w5)((()=>[Be])),_:1},8,["onSelected"]),o.meetings.length?((0,s.wg)(),(0,s.iD)("ul",Ee,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(o.meetings,(e=>((0,s.wg)(),(0,s.iD)("li",{key:e,class:"all-meet-item",onClick:t=>c.editMeeting(e)},[(0,s._)("div",Fe,[(0,s._)("p",Ue,(0,a.zw)(e.date),1),(0,s._)("p",xe,(0,a.zw)(e.start)+" - "+(0,a.zw)(e.end),1),(0,s._)("p",We,(0,a.zw)(e.place_name),1),(0,s.Wm)(h,{class:"edit-btn"})]),(0,s._)("p",Ne,[(0,s._)("span",Oe,(0,a.zw)(e.topic),1)]),(0,s._)("p",ze,[(0,s._)("span",qe,(0,a.zw)(e.client_name),1)])],8,Te)))),128))])):((0,s.wg)(),(0,s.iD)("ul",je,Ve))])):((0,s.wg)(),(0,s.j4)(p,{key:4,class:"indicator"})),(0,s._)("div",Ae,[(0,s.Wm)(r,{onClick:t[2]||(t[2]=e=>this.displayCreateMeetPopup=!0)},{default:(0,s.w5)((()=>[Ye])),_:1})])])}const Re={class:"add-meet-but"};function Qe(e,t,n,i,a,o){return(0,s.wg)(),(0,s.iD)("button",Re,[(0,s.WI)(e.$slots,"default",{},void 0,!0)])}var Je={};const Ge=(0,l.Z)(Je,[["render",Qe],["__scopeId","data-v-74fe8ef9"]]);var Xe=Ge;const et={class:"segmented-control-container"};function tt(e,t,n,i,o,c){return(0,s.wg)(),(0,s.iD)("div",et,[(0,s._)("button",{class:(0,a.C_)(["segmented-control-item",{active:o.isFirstItemActive}]),onClick:t[0]||(t[0]=(...e)=>c.touchItem&&c.touchItem(...e))},[(0,s.WI)(e.$slots,"item1",{class:"segmented-control-item-name"},void 0,!0)],2),(0,s._)("button",{class:(0,a.C_)(["segmented-control-item",{active:!o.isFirstItemActive}]),onClick:t[1]||(t[1]=(...e)=>c.touchItem&&c.touchItem(...e))},[(0,s.WI)(e.$slots,"item2",{class:"segmented-control-item-name"},void 0,!0)],2)])}var nt={data(){return{isFirstItemActive:!0}},methods:{touchItem(){this.isFirstItemActive=!this.isFirstItemActive,this.$emit("selected",this.isFirstItemActive)}}};const it=(0,l.Z)(nt,[["render",tt],["__scopeId","data-v-12f33ba4"]]);var st=it;const at={class:"edit-btn"};function ot(e,t,n,i,a,o){return(0,s.wg)(),(0,s.iD)("button",at,"...")}var ct={};const rt=(0,l.Z)(ct,[["render",ot],["__scopeId","data-v-d1647bac"]]);var lt=rt;const dt={class:"popup_wrapper",ref:"popup_wrapper"},ht={class:"v-popup__header"},pt={class:"popup-title"},ut={class:"v-popup__content"},mt={class:"info-meeting"},gt={class:"info-meet-main"},wt={class:"client-container"},vt=["value","disabled"],Ct={class:"contact-container"},_t=["value","disabled"],yt={class:"theme-container"},ft={key:0,class:"validate-error-message"},kt={class:"date-container"},Dt={key:0,class:"validate-error-message"},bt={key:1,class:"validate-error-message"},Mt={class:"time-start-end"},Pt={class:"time-start"},St={key:0,class:"validate-error-message"},It={key:1,class:"validate-error-message"},$t={class:"time-end"},Ht={key:0,class:"validate-error-message"},Lt={class:"place-container"},Bt=["value","disabled"],Et={key:0,class:"validate-error-message"},Tt={class:"worker-container"},Ft=["value","disabled"],Ut={class:"info-note"},xt={class:"note-container"},Wt={class:"footer-btns"},Nt=(0,s.Uk)("Удалить "),Ot=(0,s.Uk)("Сохранить ");function zt(e,t,n,o,c,r){const l=(0,s.up)("add-button");return(0,s.wg)(),(0,s.iD)("div",dt,[(0,s._)("form",{class:"v-popup animation",onSubmit:t[14]||(t[14]=(0,i.iM)((()=>{}),["prevent"]))},[(0,s._)("div",ht,[(0,s._)("span",pt,(0,a.zw)(r.popupTitle),1),(0,s._)("span",null,[(0,s._)("i",{class:"material-icons",onClick:t[0]||(t[0]=(...e)=>r.closePopup&&r.closePopup(...e))}," close ")])]),(0,s._)("div",ut,[(0,s._)("div",mt,[(0,s._)("div",gt,[(0,s._)("div",wt,[(0,s.wy)((0,s._)("select",{class:"client-input","onUpdate:modelValue":t[1]||(t[1]=e=>c.selectedClient=e),onChange:t[2]||(t[2]=(...e)=>r.selectClientHandler&&r.selectClientHandler(...e))},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(c.clients,(e=>((0,s.wg)(),(0,s.iD)("option",{value:e,disabled:0===e.id},(0,a.zw)(e.name),9,vt)))),256))],544),[[i.bM,c.selectedClient]])]),(0,s._)("div",Ct,[(0,s.wy)((0,s._)("select",{class:"contact-input","onUpdate:modelValue":t[3]||(t[3]=e=>c.selectedContact=e)},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(c.contacts,(e=>((0,s.wg)(),(0,s.iD)("option",{value:e,disabled:0===e.id},(0,a.zw)(e.name),9,_t)))),256))],512),[[i.bM,c.selectedContact]])]),(0,s._)("div",yt,[(0,s.wy)((0,s._)("input",{type:"text",class:(0,a.C_)(["theme-input",{invalid:o.v$.theme.$error}]),placeholder:"Тема","onUpdate:modelValue":t[4]||(t[4]=e=>c.theme=e)},null,2),[[i.nr,c.theme]]),o.v$.theme.$error?((0,s.wg)(),(0,s.iD)("small",ft," Тема встречи является обязательным полем! ")):(0,s.kq)("",!0)]),(0,s._)("div",kt,[(0,s.wy)((0,s._)("input",{type:"date",class:(0,a.C_)(["date-input",{invalid:o.v$.date.$error||!this.isCorrectDate}]),placeholder:"Дата",id:"datepicker","onUpdate:modelValue":t[5]||(t[5]=e=>c.date=e),onChange:t[6]||(t[6]=(...e)=>r.changeTime&&r.changeTime(...e))},null,34),[[i.nr,c.date]]),o.v$.date.$error?((0,s.wg)(),(0,s.iD)("small",Dt," Поле даты - обязательное поле! ")):(0,s.kq)("",!0),r.isCorrectDate?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("small",bt," Дата должна быть >= текущей даты! "))]),(0,s._)("div",Mt,[(0,s._)("div",Pt,[(0,s.wy)((0,s._)("input",{type:"time",class:(0,a.C_)(["date-start-input",{invalid:o.v$.start.$error||!this.isCorrectSelectedTime}]),placeholder:"Время начала",id:"start-picker","onUpdate:modelValue":t[7]||(t[7]=e=>c.start=e),onChange:t[8]||(t[8]=(...e)=>r.changeTime&&r.changeTime(...e))},null,34),[[i.nr,c.start]]),o.v$.start.$error?((0,s.wg)(),(0,s.iD)("small",St," Время начала встречи - обязательное поле! ")):(0,s.kq)("",!0),r.isCorrectSelectedTime?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("small",It," Время начало должно быть меньше время конца встречи! "))]),(0,s._)("div",$t,[(0,s.wy)((0,s._)("input",{type:"time",class:(0,a.C_)(["date-end-input",{invalid:o.v$.end.$error}]),placeholder:"Время окончания",id:"end-picker","onUpdate:modelValue":t[9]||(t[9]=e=>c.end=e),onChange:t[10]||(t[10]=(...e)=>r.changeTime&&r.changeTime(...e))},null,34),[[i.nr,c.end]]),o.v$.end.$error?((0,s.wg)(),(0,s.iD)("small",Ht," Время окончания встречи - обязательное поле! ")):(0,s.kq)("",!0)])]),(0,s._)("div",Lt,[(0,s.wy)((0,s._)("select",{class:(0,a.C_)(["place-input",{invalid:o.v$.end.$error}]),"onUpdate:modelValue":t[11]||(t[11]=e=>c.place=e)},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(c.freePlaces,(e=>((0,s.wg)(),(0,s.iD)("option",{value:e,disabled:0===e.id},(0,a.zw)(e.name),9,Bt)))),256))],2),[[i.bM,c.place]]),o.v$.place.$error?((0,s.wg)(),(0,s.iD)("small",Et," Место встречи - обязательное поле! ")):(0,s.kq)("",!0)])]),(0,s._)("div",Tt,[(0,s.wy)((0,s._)("select",{class:"worker-input","onUpdate:modelValue":t[12]||(t[12]=e=>c.selectedUsersInMeeting=e),multiple:"",style:{padding:"5px 0 0 5px"}},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(c.users,(e=>((0,s.wg)(),(0,s.iD)("option",{value:e,disabled:0===e.id},(0,a.zw)(r.prepareUserForDisplay(e)),9,Ft)))),256))],512),[[i.bM,c.selectedUsersInMeeting]])])]),(0,s._)("div",Ut,[(0,s._)("div",xt,[(0,s.wy)((0,s._)("textarea",{type:"text",class:"note-input",placeholder:"Заметки","onUpdate:modelValue":t[13]||(t[13]=e=>c.note=e),style:{padding:"5px 0 0 5px"},maxlength:"4096"},null,512),[[i.nr,c.note]])])])]),(0,s._)("div",Wt,[n.isCreatePopup?(0,s.kq)("",!0):((0,s.wg)(),(0,s.j4)(l,{key:0,class:"popup-footer-btn popup-edit",onClick:r.touchCancelMeetingButtonHandler},{default:(0,s.w5)((()=>[Nt])),_:1},8,["onClick"])),(0,s.Wm)(l,{class:"popup-footer-btn popup-save",onClick:r.touchSaveButtonHandler},{default:(0,s.w5)((()=>[Ot])),_:1},8,["onClick"])])],32)],512)}var qt=n(9117),jt=n(3053),Zt={components:{Popup:z,AddButton:Xe},props:{isCreatePopup:{type:Boolean,default:!0},editingMeet:{type:Object,default:null}},setup(){return{v$:(0,jt.ZP)()}},validations(){return{theme:{required:qt.C1},start:{required:qt.C1},end:{required:qt.C1},date:{required:qt.C1},place:{required:qt.C1}}},data(){return{selectedClient:{name:"Клиент",id:0,inn:""},selectedContact:{name:"Контактное лицо",id:0},selectedUsersInMeeting:[{name:"Сотрудники",id:0,direction:""}],clients:[{name:"Клиент",id:0,inn:""}],contacts:[{name:"Контактное лицо",id:0}],freePlaces:[{name:"Свободные переговорки",id:0,is_private:!1}],start:"",end:"",date:"",theme:"",place:{name:"Свободные переговорки",id:0,is_private:!1},note:"",users:[{name:"Сотрудники",id:0,direction:""}]}},methods:{async touchSaveButtonHandler(){const e=await this.isCorrectForm();if(!e)return;let t={date:this.date,start:this.start,end:this.end,place_name:this.place.name,place_id:null!==this.place.id?this.place.id:"",topic:this.theme,note:this.note,creator_id:X.state.user.id,contact_id:this.selectedContact.id,client_id:0!==this.selectedClient.id?this.selectedClient.id:"",employee_list:this.getEmployeeList()};if(this.isCreatePopup)t=await oe.createMeeting(t),this.$emit("createMeeting",t);else{t["id"]=this.editingMeet.id;const e=await oe.editMeeting(t);this.$emit("editMeeting",e)}this.closePopup()},closePopup(){this.$emit("closePopup"),this.clearPopup()},async isCorrectForm(){const e=await this.v$.theme.$validate(),t=await this.v$.start.$validate(),n=await this.v$.end.$validate(),i=await this.v$.date.$validate(),s=await this.v$.place.$validate();return!!(e&&t&&n&&i&&s&&this.isCorrectSelectedTime&&this.isCorrectDate)},clearPopup(){this.selectedClient="0",this.selectedContact="",this.clients=[],this.contacts=[],this.freePlaces=[],this.start="",this.end="",this.date="",this.theme="",this.place="",this.v$.$reset()},async selectClientHandler(){if(null!==this.selectedClient.id){const e=await oe.getClientContacts(this.selectedClient.id);this.fillContactsForSelect(e)}},async changeTime(){""!==this.start&&""!==this.end&&""!==this.date&&await this.fillFreePlaces()},getEmployeeList(){const e=[];for(let t in this.selectedUsersInMeeting)0!==this.selectedUsersInMeeting[t].id&&e.push(this.selectedUsersInMeeting[t].id);return e},async fillDataInputs(){this.selectedClient={name:this.editingMeet.client_name,id:this.editingMeet.client_id,inn:this.editingMeet.client_inn},await this.selectClientHandler(),this.selectedContact={name:this.editingMeet.contact_name,id:this.editingMeet.contact_id},this.theme=this.editingMeet.topic,this.note=this.editingMeet.note,this.date=this.editingMeet.date,this.start=this.editingMeet.start,this.end=this.editingMeet.end,await this.fillFreePlaces(),this.place={name:this.editingMeet.place_name,id:this.editingMeet.place_id,is_private:!1},-1===this.freePlaces.indexOf(this.place)&&this.freePlaces.push(this.place),await this.fillUsers(),await this.fillSelectedUsers()},fillContactsForSelect(e){this.contacts=[{name:"Контактное лицо",id:0}];for(let t in e){const n=e[t].second_name+" "+e[t].first_name+" "+e[t].third_name;this.contacts.push({name:n,id:e[t].id})}},async fillFreePlaces(){const e=await oe.getFreePlaces(this.start,this.end,this.date);this.freePlaces=[],this.freePlaces.push({name:"Свободные переговорки",id:0,is_private:!1});let t=!1;for(let n in e)e[n].id===this.place.id&&(t=!0),this.freePlaces.push(e[n]);t||(this.place={})},async fillUsers(){const e=await oe.getUsers();this.users=[];for(let t in this.selectedUsersInMeeting)this.users.push(this.selectedUsersInMeeting[t]);for(let t in e){const n=e[t].second_name+" "+e[t].first_name[0]+"."+e[t].third_name[0];this.users.push({name:n,id:e[t].id,direction:null===e[t].direction_name?"":e[t].direction_name})}},async fillSelectedUsers(){const e=new Map;for(let n in this.editingMeet.employee_list)e.set(this.editingMeet.employee_list[n],null);const t=this.users;for(let n in t){const i=t[n].second_name+" "+t[n].first_name+" "+t[n].third_name;e.has(t[n].id)&&e.set(t[n].id,i)}this.selectedUsersInMeeting=[];for(let n in this.users)void 0!==e.get(this.users[n].id)&&this.selectedUsersInMeeting.push(this.users[n])},async touchCancelMeetingButtonHandler(){await oe.deleteMeeting(this.editingMeet.id),this.$emit("cancelMeeting",this.editingMeet.id),this.closePopup()},prepareUserForDisplay(e){return e.name+(0!==e.id?"("+e.direction+")":"")}},async mounted(){let e=this;document.addEventListener("click",(function(t){t.target===e.$refs["popup_wrapper"]&&e.closePopup()}));const t=await oe.getClients(!0);for(let n in t)this.clients.push(t[n]);this.isCreatePopup?await this.fillUsers():await this.fillDataInputs()},computed:{isCorrectSelectedTime(){if(""===this.start||""===this.end)return!0;const e=new Date,t=this.start.split(":")[0],n=this.start.split(":")[1];e.setHours(Number(t),Number(n));const i=new Date,s=this.end.split(":")[0],a=this.end.split(":")[1];return i.setHours(Number(s),Number(a)),e<i},isCorrectDate(){if(""===this.date)return!0;if(!this.isCreatePopup)return!0;const e=new Date(this.date),t=new Date;return t.setHours(0,0,0,0),e>=t},popupTitle(){return this.isCreatePopup?"Новая встреча":"Редактирование встречи"}}};const Vt=(0,l.Z)(Zt,[["render",zt],["__scopeId","data-v-bf464cfe"]]);var At=Vt,Yt={components:{AddButton:Xe,LoadingIndicate:Q,SegmentedControl:st,EditButton:lt,CreateMeet:At},data(){return{meetings:[],nearMeeting:void 0,isLoadedMeetings:!1,isCreateMeetMode:!1,displayCreateMeetPopup:!1,displayEditMeetPopup:!1,editingMeet:{}}},async mounted(){this.meetings=await oe.getMeetings(),this.meetings.length&&(this.nearMeeting=this.meetings[0],this.prepareMeetingsForDisplay()),this.isLoadedMeetings=!0},methods:{async prepareMeetingsForDisplay(){this.meetings.forEach((e=>{e.start=e.start.substr(0,5),e.end=e.end.substr(0,5)}))},async selectedSegmentedControl(e){if(e)return this.meetings=await oe.getMeetings(),void this.prepareMeetingsForDisplay();this.meetings=await oe.getMeetings(!0),this.prepareMeetingsForDisplay()},touchCreateMeet(){this.showPopupForMeet()},showPopupForMeet(){this.displayCreateMeetPopup=!0},closeCreatePopup(){this.displayCreateMeetPopup=!1},closeEditPopup(){this.displayEditMeetPopup=!1},displayNewMeeting(e){e.start=e.start.substr(0,5),e.end=e.end.substr(0,5),this.meetings.push(e),this.meetings.length&&(this.nearMeeting=this.meetings[0])},editMeeting(e){this.displayEditMeetPopup=!0,this.editingMeet=e},deleteMeeting(e){this.meetings=this.meetings.filter((t=>t.id!==e)),this.meetings.length?this.nearMeeting=this.meetings[0]:this.newMeeting={}},changeEditedMeeting(e){this.meetings=this.meetings.map((t=>t.id===e.id?e:t)),this.meetings.length&&(this.nearMeeting=this.meetings[0]),this.prepareMeetingsForDisplay()}}};const Kt=(0,l.Z)(Yt,[["render",Ke],["__scopeId","data-v-2dedb246"]]);var Rt=Kt,Qt={components:{NavBar:le,meetings:Rt}};const Jt=(0,l.Z)(Qt,[["render",u],["__scopeId","data-v-50463f30"]]);var Gt=Jt;const Xt=e=>((0,s.dD)("data-v-48251e62"),e=e(),(0,s.Cn)(),e),en={class:"login-container"},tn=Xt((()=>(0,s._)("h1",{class:"title"},"Вход в систему",-1))),nn={key:0,class:"validate-error-message",id:"test"},sn={key:1,class:"validate-error-message"},an={key:2,class:"validate-error-message"},on={class:"save-container"},cn=Xt((()=>(0,s._)("label",{for:"save",class:"save-label"},"Запомнить",-1))),rn={key:3,class:"error-container"};function ln(e,t,n,o,c,r){return(0,s.wg)(),(0,s.iD)("div",en,[(0,s._)("form",{onSubmit:t[4]||(t[4]=(0,i.iM)((()=>{}),["prevent"]))},[tn,(0,s.wy)((0,s._)("input",{type:"text",id:"login",name:"user_login","onUpdate:modelValue":t[0]||(t[0]=e=>c.username=e),placeholder:"Введите логин...",class:(0,a.C_)({invalid:o.v$.username.$error})},null,2),[[i.nr,c.username]]),o.v$.username.$error?((0,s.wg)(),(0,s.iD)("small",nn," Логин не должен быть пустым! ")):(0,s.kq)("",!0),(0,s.wy)((0,s._)("input",{type:"password",id:"password",name:"user_password","onUpdate:modelValue":t[1]||(t[1]=e=>c.password=e),placeholder:"Введите пароль...",class:(0,a.C_)({invalid:o.v$.password.$error})},null,2),[[i.nr,c.password]]),o.v$.password.$dirty&&o.v$.password.required.$invalid?((0,s.wg)(),(0,s.iD)("small",sn," Пароль является обязательным полем! ")):(0,s.kq)("",!0),o.v$.password.minLength.$invalid?((0,s.wg)(),(0,s.iD)("small",an," Длина пароля должна быть больше 3 символов! ")):(0,s.kq)("",!0),(0,s._)("div",on,[(0,s.wy)((0,s._)("input",{type:"checkbox",id:"save",name:"selected_save","onUpdate:modelValue":t[2]||(t[2]=e=>c.isSavedSession=e)},null,512),[[i.e8,c.isSavedSession]]),cn]),(0,s._)("button",{type:"submit",onClick:t[3]||(t[3]=(...e)=>r.touchLogIn&&r.touchLogIn(...e))},"Далее"),r.isHaveErrorAuth()?((0,s.wg)(),(0,s.iD)("div",rn,(0,a.zw)(this.$store.state.auth.errorMessage),1)):(0,s.kq)("",!0)],32)])}var dn={setup(){return{v$:(0,jt.ZP)()}},data(){return{username:"",password:"",isSavedSession:!1,passwordPlaceholder:"Введите пароль...",loginPlaceholder:"Введите логин..."}},validations(){return{username:{required:qt.C1},password:{required:qt.C1,minLength:(0,qt.Ei)(4)}}},methods:{...(0,c.nv)(["logIn"]),async touchLogIn(){const e=await this.v$.$validate();if(!e)return;const t=await this.logIn({username:this.username,password:this.password,isSavedSession:this.isSavedSession});t?this.$router.push("/"):this.$router.push("/login")},isHaveErrorAuth(){return""!==this.$store.state.auth.errorMessage},isValidForm(){const e=4;return this.validationErrors=[],!!(this.username.length&&this.password.length>=e)}}};const hn=(0,l.Z)(dn,[["render",ln],["__scopeId","data-v-48251e62"]]);var pn=hn;const un={class:"calendar-container"};function mn(e,t,n,i,a,o){const c=(0,s.up)("nav-bar"),r=(0,s.up)("calendar-container");return(0,s.wg)(),(0,s.iD)("div",un,[(0,s.Wm)(c),(0,s._)("main",null,[(0,s.Wm)(r)])])}const gn={class:"multicheckbox-container"};function wn(e,t,n,i,a,o){const c=(0,s.up)("checkbox");return(0,s.wg)(),(0,s.iD)("div",gn,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(a.options,(e=>((0,s.wg)(),(0,s.j4)(c,{key:e,checked:e.isSelected,"onUpdate:checked":t=>e.isSelected=t,option:e.name,class:"option-item"},null,8,["checked","onUpdate:checked","option"])))),128))])}const vn=e=>((0,s.dD)("data-v-5d833826"),e=e(),(0,s.Cn)(),e),Cn={class:"checkbox-container"},_n=["checked"],yn=vn((()=>(0,s._)("span",{class:"check-style"},null,-1))),fn={class:"option-content"};function kn(e,t,n,i,o,c){return(0,s.wg)(),(0,s.iD)("label",Cn,[(0,s._)("input",{onInput:t[0]||(t[0]=t=>e.$emit("update:checked",t.target.checked)),type:"checkbox",checked:n.checked,class:"checkbox"},null,40,_n),yn,(0,s._)("span",fn,(0,a.zw)(n.option),1)])}var Dn={props:{option:String,checked:{type:Boolean}}};const bn=(0,l.Z)(Dn,[["render",kn],["__scopeId","data-v-5d833826"]]);var Mn=bn,Pn={components:{Checkbox:Mn},props:{dataOptions:{type:Array,default:[]}},data(){return{options:this.dataOptions}}};const Sn=(0,l.Z)(Pn,[["render",wn],["__scopeId","data-v-b1b2225a"]]);var In=Sn;const $n=e=>((0,s.dD)("data-v-4d86c64e"),e=e(),(0,s.Cn)(),e),Hn={class:"calendar-main-container"},Ln=$n((()=>(0,s._)("h1",null,"Календарь",-1))),Bn={class:"calendar-header-level"},En=$n((()=>(0,s._)("div",{class:"blank-space"},null,-1))),Tn={class:"calendar-body-level"},Fn={class:"blank-mini-calendar"},Un={class:"slice-container"};function xn(e,t,n,i,a,o){const c=(0,s.up)("calendar-header"),r=(0,s.up)("meet-places"),l=(0,s.up)("calendar-day-slice"),d=(0,s.up)("calendar-week-slice"),h=(0,s.up)("calendar-month-slice");return(0,s.wg)(),(0,s.iD)("div",Hn,[Ln,(0,s._)("div",Bn,[En,(0,s.Wm)(c,{class:"calendar-header",onSwitchSlice:o.showSelectedSlice,onSelectedDate:o.handleSelectDate},null,8,["onSwitchSlice","onSelectedDate"])]),(0,s._)("div",Tn,[(0,s._)("div",Fn,[(0,s.Wm)(r,{onTakePlace:o.handleTakePlace},null,8,["onTakePlace"])]),(0,s._)("div",Un,[a.isPressedDayBtn?((0,s.wg)(),(0,s.j4)(l,{key:0,class:"day-slice-container","selected-place":a.selectedPlace,"selected-date":a.selectedDate},null,8,["selected-place","selected-date"])):(0,s.kq)("",!0),a.isPressedWeekBtn?((0,s.wg)(),(0,s.j4)(d,{key:1})):(0,s.kq)("",!0),a.isPressedMonthBtn?((0,s.wg)(),(0,s.j4)(h,{key:2})):(0,s.kq)("",!0)])])])}const Wn=e=>((0,s.dD)("data-v-170d124a"),e=e(),(0,s.Cn)(),e),Nn={class:"day-container",ref:"gridLine"},On={class:"grid-container"},zn={class:"row-cell-container"},qn=["onClick"],jn={class:"topic-meeting-event"},Zn={class:"place-meeting-event"},Vn={class:"current-time"},An={class:"red-point",ref:"redPoint"},Yn=Wn((()=>(0,s._)("div",{class:"red-line"},null,-1)));function Kn(e,t,n,o,c,r){const l=(0,s.up)("event-tooltip");return(0,s.wg)(),(0,s.iD)("div",Nn,[(0,s._)("ul",On,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(this.cells,(e=>((0,s.wg)(),(0,s.iD)("li",{class:"grid-row",ref_for:!0,ref:"infoBox",key:e},[(0,s._)("div",zn,[(0,s._)("div",{class:"divider-cell-line-container",ref_for:!0,ref:"forStartCalculate"},[(0,s.wy)((0,s._)("span",{class:"time-item",ref_for:!0,ref:"lineTime"},(0,a.zw)(r.prepareHoursForDisplay(e)),513),[[i.F8,!c.hideTimeInLine.get(e)]]),(0,s._)("div",{class:"divider-cell-line",ref_for:!0,ref:"dividerLine"},null,512)],512)]),void 0!==c.meetingEvents.get(e)?((0,s.wg)(),(0,s.iD)("div",{key:0,onClick:t=>r.pressedOnMeetingEvent(c.meetingEvents.get(e)),class:"meeting-event-element",style:(0,a.j5)({top:c.meetingEvents.get(e)["start-coordinate"],height:c.meetingEvents.get(e)["end-coordinate"]})},[(0,s.Wm)(l,{"is-show":r.showTooltipForMeetingEvent(e),event:c.meetingEvents.get(e)},{default:(0,s.w5)((()=>[(0,s._)("label",jn,(0,a.zw)(c.meetingEvents.get(e).topic),1),(0,s._)("label",Zn,(0,a.zw)(c.meetingEvents.get(e).place_name),1)])),_:2},1032,["is-show","event"])],12,qn)):(0,s.kq)("",!0)])))),128)),r.isToday?((0,s.wg)(),(0,s.iD)("li",{class:"red-line-container",style:(0,a.j5)({top:r.getRedLinePosition()}),key:c.updateRedLineComponent},[(0,s._)("label",Vn,(0,a.zw)(r.displayCurrentTime()),1),(0,s._)("div",An,null,512),Yn],4)):(0,s.kq)("",!0)])],512)}const Rn=6e4,Qn=e=>((0,s.dD)("data-v-1dff1371"),e=e(),(0,s.Cn)(),e),Jn={class:"tooltip-wrapper"},Gn={key:0,class:"tooltip-element"},Xn=Qn((()=>(0,s._)("div",{class:"tooltip-header"},null,-1))),ei=Qn((()=>(0,s._)("div",{class:"tooltip-content-header"},null,-1))),ti={class:"tooltip-content"},ni={class:"content-title-container"},ii={class:"content-title"},si={class:"event-date-container"},ai={class:"start time"},oi={class:"event-date"},ci={class:"end time"},ri={class:"event-place"},li={class:"event-creater"};function di(e,t,n,i,o,c){return(0,s.wg)(),(0,s.iD)("div",Jn,[(0,s.WI)(e.$slots,"default",{},void 0,!0),n.isShow?((0,s.wg)(),(0,s.iD)("div",Gn,[Xn,ei,(0,s._)("div",ti,[(0,s._)("div",ni,[(0,s._)("label",ii,(0,a.zw)(n.event.topic),1)]),(0,s._)("div",si,[(0,s._)("label",ai,(0,a.zw)(c.deleteSecondsInTime(n.event.start)),1),(0,s._)("label",oi,(0,a.zw)(n.event.date.toLocaleDateString())+",",1),(0,s._)("label",ci,(0,a.zw)(c.getWeekDay(n.event.date))+" - "+(0,a.zw)(c.deleteSecondsInTime(n.event.end)),1)]),(0,s._)("label",ri,(0,a.zw)(n.event.place_name),1),(0,s._)("label",li,(0,a.zw)(n.event.creator_name),1)])])):(0,s.kq)("",!0)])}var hi={name:"EventTooltip",props:{event:{type:Object,default:{}},isShow:{type:Boolean,default:!1}},data(){return{}},mounted(){this.event.date=new Date(this.event.date)},methods:{getWeekDay(e){const t={"понедельник":"Пн","вторник":"Вт","среда":"Ср","четверг":"Чт","пятница":"Пт","суббота":"Сб","воскресенье":"Вс"},n={weekday:"long"};let i=e.toLocaleString("ru",n);return t[i]},deleteSecondsInTime(e){return e.slice(0,5)}}};const pi=(0,l.Z)(hi,[["render",di],["__scopeId","data-v-1dff1371"]]);var ui=pi,mi={name:"CalendarDaySlice",components:{EventTooltip:ui},props:{selectedPlace:{type:Object,default:{id:1}},selectedDate:{type:Date,default:new Date}},data(){return{gridLineHeight:0,dividerLineDivHeight:0,redPointHeight:0,dividerLineHeight:0,cells:[],meetingEvents:new Map,updateRedLineComponent:0,hideTimeInLine:new Map,now:new Date,showTooltipForSelectedEvent:new Map}},created(){window.setInterval((()=>{this.updateRedLineComponent+=1,this.now=new Date}),Rn)},async mounted(){this.createTimeGrid();let e=await oe.getMeetingsByDate(this.selectedDate);this.setHideTimeInLineMap(),await this.$nextTick((function(){this.gridLineHeight=this.getClientHeight(this.$refs.infoBox[0]),this.dividerLineDivHeight=this.getClientHeight(this.$refs.forStartCalculate[0]),this.redPointHeight=this.getClientHeight(this.$refs.redPoint),this.dividerLineHeight=this.getClientHeight(this.$refs.dividerLine[0]),this.now=new Date,this.handleMeetingEvents(e),this.scrollToStartWorkTime()})),this.meetingEvents.forEach((e=>this.showTooltipForSelectedEvent.set(e.id,!1)))},methods:{createTimeGrid(){for(let e=0;e<24;e++)this.cells.push(e)},handleMeetingEvents(e){e.forEach((e=>{let t=e.start.slice(0,2),n="0"===t[0]?+t[1]:+t;e["start-coordinate"]=this.calculateStartCoordinateForEvent(e.start),e["end-coordinate"]=this.calculateEndCoordinateForEvent(e.start,e.end),this.meetingEvents.set(n,e)}))},getClientHeight(e){return e.clientHeight},calculateStartCoordinateForEvent(e){e=this.deleteSecondsInTime(e);let t=+e.slice(3,e.length);return String(t/60*100-100+100*this.getStartOffsetByDividerLineInPercent())+"%"},calculateEndCoordinateForEvent(e,t){e=this.deleteSecondsInTime(e),t=this.deleteSecondsInTime(t);const n=+e.slice(0,2),i=+e.slice(3,e.length),s=+t.slice(0,2),a=+t.slice(3,t.length),o=new Date;o.setHours(n),o.setMinutes(i);const c=new Date;c.setHours(s),c.setMinutes(a);const r=(c-o)/1e3/60/60,l=r*this.gridLineHeight;return String(l)+"px"},deleteSecondsInTime(e){return e.slice(0,e.length-3)},scrollToStartWorkTime(){this.$refs.gridLine.scrollTop=this.$refs.gridLine.scrollHeight/3-this.dividerLineDivHeight/2},getRedLinePosition(){const e=new Date;e.setHours(0,0,0,0);const t=new Date;let n=100*(t-e)/1e3/60/60/24;return n+=100*this.getStartOffsetByDividerLineInPercent()/24,n-=100*this.getOffsetForRedLineByRedCircle()/24,String(n)+"%"},prepareHoursForDisplay(e){return e<10?"0"+e+":00":e+":00"},getStartOffsetByDividerLineInPercent(){return(this.dividerLineDivHeight-this.dividerLineHeight)/this.gridLineHeight/2},getOffsetForRedLineByRedCircle(){return this.redPointHeight/this.gridLineHeight/2},displayCurrentTime(){const e=new Date,t=e.getHours(),n=e.getMinutes(),i=t<10?"0"+String(t):String(t),s=n<10?"0"+String(n):String(n);return i+":"+s},setHideTimeInLineMap(){this.hideTimeInLine.clear();for(let e=0;e<24;e++)this.hideTimeInLine.set(e,!1)},hideTimeWhenIntersectWithTimeInRedLine(e){e.getHours()+1!==24&&this.isToday&&(e.getMinutes()>=50?this.hideTimeInLine.set(e.getHours()+1,!0):e.getMinutes()<=10?this.hideTimeInLine.set(e.getHours(),!0):this.hideTimeInLine.set(e.getHours(),!1))},pressedOnMeetingEvent(e){const t=!this.showTooltipForSelectedEvent.get(e.id);this.showTooltipForSelectedEvent.set(e.id,t)},showTooltipForMeetingEvent(e){const t=this.meetingEvents.get(e);return this.showTooltipForSelectedEvent.get(t.id)}},watch:{async selectedDate(e){let t=await oe.getMeetingsByDate(e);this.meetingEvents.clear(),this.handleMeetingEvents(t),this.now=new Date,this.isToday||this.setHideTimeInLineMap()},async selectedPlace(e){let t=await oe.getMeetingsInPlaceByDate(this.selectedDate,e);this.meetingEvents.clear(),this.handleMeetingEvents(t)},now(e){this.hideTimeWhenIntersectWithTimeInRedLine(e)}},computed:{isToday(){let e=this.selectedDate;e.setHours(0,0,0,0);let t=new Date;return t.setHours(0,0,0,0),e-t===0}}};const gi=(0,l.Z)(mi,[["render",Kn],["__scopeId","data-v-170d124a"]]);var wi=gi;const vi=e=>((0,s.dD)("data-v-2535a8c4"),e=e(),(0,s.Cn)(),e),Ci={class:"week-container"},_i=vi((()=>(0,s._)("h1",null,"Week-container",-1))),yi=[_i];function fi(e,t,n,i,a,o){return(0,s.wg)(),(0,s.iD)("div",Ci,yi)}var ki={name:"CalendarWeekSlice"};const Di=(0,l.Z)(ki,[["render",fi],["__scopeId","data-v-2535a8c4"]]);var bi=Di;const Mi=e=>((0,s.dD)("data-v-1bb64320"),e=e(),(0,s.Cn)(),e),Pi={class:"month-container"},Si=Mi((()=>(0,s._)("h1",null,"Month-container",-1))),Ii=[Si];function $i(e,t,n,i,a,o){return(0,s.wg)(),(0,s.iD)("div",Pi,Ii)}var Hi={name:"CalendarMonthSlice"};const Li=(0,l.Z)(Hi,[["render",$i],["__scopeId","data-v-1bb64320"]]);var Bi=Li;const Ei=e=>((0,s.dD)("data-v-1fa43006"),e=e(),(0,s.Cn)(),e),Ti={class:"calendar-header-container"},Fi={class:"calendar-header-btns"},Ui={class:"select-time-container"},xi={class:"selected-date"},Wi=Ei((()=>(0,s._)("div",{class:"design-line-element"},null,-1)));function Ni(e,t,n,i,o,c){return(0,s.wg)(),(0,s.iD)("div",Ti,[(0,s._)("div",Fi,[(0,s._)("button",{class:"today-btn",onClick:t[0]||(t[0]=(...e)=>c.pressTodayBtn&&c.pressTodayBtn(...e))},"Сегодня"),(0,s._)("button",{class:(0,a.C_)(["day-btn slice",{activate:this.isPressedDayBtn}]),onClick:t[1]||(t[1]=(...e)=>c.pressDayBtn&&c.pressDayBtn(...e))},"День",2),(0,s._)("button",{class:(0,a.C_)(["week-btn slice",{activate:this.isPressedWeekBtn}]),onClick:t[2]||(t[2]=(...e)=>c.pressWeekBtn&&c.pressWeekBtn(...e))},"Неделя",2),(0,s._)("button",{class:(0,a.C_)(["month-btn slice",{activate:this.isPressedMonthBtn}]),onClick:t[3]||(t[3]=(...e)=>c.pressMonthBtn&&c.pressMonthBtn(...e))},"Месяц",2),(0,s._)("div",Ui,[(0,s._)("label",xi,(0,a.zw)(this.formatDate(o.selectedDate)),1),(0,s._)("i",{class:"material-icons prev-date-btn",onClick:t[4]||(t[4]=e=>c.selectedNewDate(-1))}," arrow_back_ios "),(0,s._)("i",{class:"material-icons next-date-btn",onClick:t[5]||(t[5]=e=>c.selectedNewDate())}," arrow_forward_ios ")])]),Wi])}var Oi={name:"CalendarHeader",data(){return{isPressedDayBtn:!0,isPressedWeekBtn:!1,isPressedMonthBtn:!1,selectedDate:new Date}},mounted(){this.$emit("switchSlice",this.sliceState)},methods:{activateSliceBtn(e={day:!1,week:!1,month:!1}){this.isPressedMonthBtn=e.month,this.isPressedWeekBtn=e.week,this.isPressedDayBtn=e.day},pressDayBtn(){this.isPressedDayBtn=!this.isPressedDayBtn,this.activateSliceBtn({day:!0,month:!1,week:!1}),this.$emit("switchSlice",this.sliceState)},pressWeekBtn(){this.isPressedWeekBtn=!this.isPressedWeekBtn,this.activateSliceBtn({day:!1,week:!0,month:!1}),this.$emit("switchSlice",this.sliceState)},pressMonthBtn(){this.isPressedMonthBtn=!this.isPressedMonthBtn,this.activateSliceBtn({day:!1,week:!1,month:!0}),this.$emit("switchSlice",this.sliceState)},pressTodayBtn(){this.isPressedDayBtn=!0,this.activateSliceBtn({day:!0,month:!1,week:!1}),this.selectedDate=new Date,this.$emit("switchSlice",this.sliceState),this.$emit("selectedDate",this.selectedDate)},selectedNewDate(e=1){let t=this.selectedDate;t.setDate(t.getDate()+e),this.selectedDate=new Date(t),this.$emit("selectedDate",this.selectedDate)},formatDate(e){let t={year:"numeric",month:"long",day:"numeric"};return e.toLocaleString("ru",t)}},computed:{sliceState(){return{isPressedDayBtn:this.isPressedDayBtn,isPressedWeekBtn:this.isPressedWeekBtn,isPressedMonthBtn:this.isPressedMonthBtn,selectedDate:this.selectedDate}}}};const zi=(0,l.Z)(Oi,[["render",Ni],["__scopeId","data-v-1fa43006"]]);var qi=zi;const ji={class:"meet-places"},Zi={class:"meet-places-list"},Vi=["onClick"];function Ai(e,t,n,i,o,c){const r=(0,s.up)("loading-indicate");return(0,s.wg)(),(0,s.iD)("div",ji,[(0,s._)("ul",Zi,[o.places.length?(0,s.kq)("",!0):((0,s.wg)(),(0,s.j4)(r,{key:0})),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(o.places,(e=>((0,s.wg)(),(0,s.iD)("li",{key:e,class:"meet-place-item"},[(0,s._)("button",{onClick:t=>c.takePlace(e),class:"meet-place-item-button"},(0,a.zw)(e.name),9,Vi)])))),128))])])}var Yi={components:{LoadingIndicate:Q},data(){return{places:[]}},async created(){this.places=await oe.getPlaces()},methods:{takePlace(e){this.$emit("takePlace",e)}}};const Ki=(0,l.Z)(Yi,[["render",Ai],["__scopeId","data-v-d3e2eb68"]]);var Ri=Ki,Qi={name:"CalendarContainer",components:{CalendarDaySlice:wi,CalendarWeekSlice:bi,CalendarMonthSlice:Bi,CalendarHeader:qi,MeetPlaces:Ri},data(){return{isPressedDayBtn:!1,isPressedWeekBtn:!1,isPressedMonthBtn:!1,selectedPlace:{},selectedDate:new Date}},methods:{showSelectedSlice(e){this.isPressedDayBtn=e.isPressedDayBtn,this.isPressedMonthBtn=e.isPressedMonthBtn,this.isPressedWeekBtn=e.isPressedWeekBtn},handleTakePlace(e){this.selectedPlace=e},handleSelectDate(e){this.selectedDate=e}}};const Ji=(0,l.Z)(Qi,[["render",xn],["__scopeId","data-v-4d86c64e"]]);var Gi=Ji,Xi={components:{NavBar:le,LoadingIndicate:Q,MultiCheckbox:In,CalendarContainer:Gi},data(){return{}},async mounted(){}};const es=(0,l.Z)(Xi,[["render",mn],["__scopeId","data-v-f680bf2c"]]);var ts=es;const ns=e=>((0,s.dD)("data-v-1861f258"),e=e(),(0,s.Cn)(),e),is={class:"wrapper"},ss={class:"list-checkbox"},as=ns((()=>(0,s._)("h1",null,"Список клиентов",-1))),os={class:"checkbox"},cs={class:"display"},rs=ns((()=>(0,s._)("label",{for:"highload1","data-onlabel":"","data-offlabel":"",class:"lb1"},null,-1))),ls={action:"",class:"search-form"},ds=ns((()=>(0,s._)("img",{src:"/svg/search.svg",alt:"",class:"search-icon"},null,-1))),hs={key:0,class:"client-list-container"},ps={class:"clients-container"},us={key:0,class:"clients-list"},ms={key:1,class:"clients-list empty"},gs=ns((()=>(0,s._)("li",{class:"clients-item clients-item-empty"},[(0,s._)("span",{class:"empty-message"},"Нет клиентов")],-1))),ws=[gs],vs=(0,s.Uk)("Добавить нового клиента"),Cs={class:"popup-title"},_s={class:"company-name-container"},ys={key:0,class:"validate-error-message"},fs={class:"company-inn-container"},ks={key:0,class:"validate-error-message"},Ds={key:1,class:"validate-error-message"},bs={class:"directions-container"},Ms=ns((()=>(0,s._)("div",{class:"multicheckbox-title-container"},[(0,s._)("label",{class:"multicheckbox-title"},"Выбрать менеджера")],-1))),Ps={key:0,class:"validate-error-message"},Ss={class:"popup-title"},Is={class:"contact-name-container first-name"},$s={key:0,class:"validate-error-message"},Hs={class:"contact-name-container second-name"},Ls={key:0,class:"validate-error-message"},Bs={class:"contact-name-container third-name"},Es={class:"contact-phone-container"},Ts={class:"contact-position-container"},Fs={class:"contact-email-container"},Us={key:0,class:"validate-error-message"};function xs(e,t,n,o,c,r){const l=(0,s.up)("nav-bar"),d=(0,s.up)("client"),h=(0,s.up)("add-button"),p=(0,s.up)("loading-indicate"),u=(0,s.up)("multicheckbox"),m=(0,s.up)("popup");return(0,s.wg)(),(0,s.iD)("div",is,[(0,s.Wm)(l),(0,s._)("main",null,[(0,s._)("div",ss,[as,(0,s._)("div",os,[(0,s._)("h3",cs,(0,a.zw)(r.checkboxTitle),1),(0,s._)("input",{type:"checkbox",name:"highload1",id:"highload1",onClick:t[0]||(t[0]=(...e)=>r.touchCheckbox&&r.touchCheckbox(...e)),checked:""}),rs])]),(0,s._)("form",ls,[(0,s.wy)((0,s._)("input",{type:"text",class:"search-input","onUpdate:modelValue":t[1]||(t[1]=e=>c.searchQuery=e),placeholder:""},null,512),[[i.nr,c.searchQuery]]),ds]),c.isLoadedClientsFromApi?((0,s.wg)(),(0,s.iD)("div",hs,[(0,s._)("div",ps,[c.clients.length?((0,s.wg)(),(0,s.iD)("ul",us,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(r.searchedClients,(e=>((0,s.wg)(),(0,s.iD)("li",{key:e,class:"client-item"},[(0,s.Wm)(d,{clientData:e,onEdit:r.touchEditClient,onCreate:r.touchCreateContact,onEditContact:r.touchEditContact,newContact:r.prepareNewContactForChildComponent(e.id)},null,8,["clientData","onEdit","onCreate","onEditContact","newContact"])])))),128))])):((0,s.wg)(),(0,s.iD)("ul",ms,ws))]),(0,s.Wm)(h,{class:"add-button",onClick:r.touchCreateClient},{default:(0,s.w5)((()=>[vs])),_:1},8,["onClick"])])):((0,s.wg)(),(0,s.j4)(p,{key:1})),c.displayClientPopup?((0,s.wg)(),(0,s.j4)(m,{key:2,onClosePopup:r.closePopupForClient,class:"client__modal-window"},{header:(0,s.w5)((()=>[(0,s._)("span",Cs,(0,a.zw)(r.clientPopupTitle),1)])),content:(0,s.w5)((()=>[(0,s._)("div",_s,[(0,s.wy)((0,s._)("input",{type:"text",class:(0,a.C_)(["company-name-input",{invalid:o.v$.newClientName.$error}]),placeholder:"Имя клиента","onUpdate:modelValue":t[2]||(t[2]=e=>c.newClientName=e)},null,2),[[i.nr,c.newClientName]]),o.v$.newClientName.$error?((0,s.wg)(),(0,s.iD)("small",ys," Имя клиента не должно быть пустым! ")):(0,s.kq)("",!0)]),(0,s._)("div",fs,[(0,s.wy)((0,s._)("input",{type:"text",class:(0,a.C_)(["company-inn-input",{invalid:o.v$.newClientInn.$error}]),placeholder:"ИНН","onUpdate:modelValue":t[3]||(t[3]=e=>c.newClientInn=e)},null,2),[[i.nr,c.newClientInn]]),o.v$.newClientInn.$dirty&&o.v$.newClientInn.required.$invalid?((0,s.wg)(),(0,s.iD)("small",ks," ИНН является обязательным полем! ")):(0,s.kq)("",!0),o.v$.newClientInn.minLength.$invalid||o.v$.newClientInn.maxLength.$invalid?((0,s.wg)(),(0,s.iD)("small",Ds," Длина ИНН должна быть длиной 12 символов! ")):(0,s.kq)("",!0)]),(0,s._)("div",bs,[Ms,(0,s.Wm)(u,{dataOptions:c.users,class:"directions-list"},null,8,["dataOptions"])])])),footer:(0,s.w5)((()=>[(0,s.Wm)(h,{class:"popup-footer-btn",onClick:r.clientPopupActionHandler},{default:(0,s.w5)((()=>[(0,s.Uk)((0,a.zw)(r.popupButtonTitle),1)])),_:1},8,["onClick"]),c.isExistClient?((0,s.wg)(),(0,s.iD)("small",Ps," Клиент с таким ИНН уже существует! ")):(0,s.kq)("",!0)])),_:1},8,["onClosePopup"])):(0,s.kq)("",!0),c.displayContactPopup?((0,s.wg)(),(0,s.j4)(m,{key:3,onClosePopup:r.closePopupForContact,class:"contact__modal-window"},{header:(0,s.w5)((()=>[(0,s._)("span",Ss,(0,a.zw)(r.contactPopupTitle),1)])),content:(0,s.w5)((()=>[(0,s._)("div",Is,[(0,s.wy)((0,s._)("input",{type:"text",class:(0,a.C_)(["contact-name-input",{invalid:o.v$.newContactFirstName.$error}]),placeholder:"Имя","onUpdate:modelValue":t[4]||(t[4]=e=>c.newContactFirstName=e)},null,2),[[i.nr,c.newContactFirstName]]),o.v$.newContactFirstName.$error?((0,s.wg)(),(0,s.iD)("small",$s," Имя контакта не должно быть пустым! ")):(0,s.kq)("",!0)]),(0,s._)("div",Hs,[(0,s.wy)((0,s._)("input",{type:"text",class:(0,a.C_)(["contact-name-input",{invalid:o.v$.newContactSecondName.$error}]),placeholder:"Фамилия","onUpdate:modelValue":t[5]||(t[5]=e=>c.newContactSecondName=e)},null,2),[[i.nr,c.newContactSecondName]]),o.v$.newContactSecondName.$error?((0,s.wg)(),(0,s.iD)("small",Ls," Фамилия контакта не должна быть пустой! ")):(0,s.kq)("",!0)]),(0,s._)("div",Bs,[(0,s.wy)((0,s._)("input",{type:"text",class:"contact-name-input",placeholder:"Отчество","onUpdate:modelValue":t[6]||(t[6]=e=>c.newContactThirdName=e)},null,512),[[i.nr,c.newContactThirdName]])]),(0,s._)("div",Es,[(0,s.wy)((0,s._)("input",{type:"text",class:"contact-phone-input",placeholder:"Телефон","onUpdate:modelValue":t[7]||(t[7]=e=>c.newContactPhone=e)},null,512),[[i.nr,c.newContactPhone]])]),(0,s._)("div",Ts,[(0,s.wy)((0,s._)("input",{type:"text",class:"contact-position-input",placeholder:"Должность","onUpdate:modelValue":t[8]||(t[8]=e=>c.newContactPosition=e)},null,512),[[i.nr,c.newContactPosition]])]),(0,s._)("div",Fs,[(0,s.wy)((0,s._)("input",{type:"text",class:"contact-email-input",placeholder:"Почта","onUpdate:modelValue":t[9]||(t[9]=e=>c.newContactEmail=e)},null,512),[[i.nr,c.newContactEmail]])])])),footer:(0,s.w5)((()=>[(0,s.Wm)(h,{class:"popup-footer-btn",onClick:r.contactPopupActionHandler},{default:(0,s.w5)((()=>[(0,s.Uk)((0,a.zw)(r.popupButtonTitle),1)])),_:1},8,["onClick"]),c.isExistContact?((0,s.wg)(),(0,s.iD)("small",Us," Контакт с таким именем и клиентом уже существует! ")):(0,s.kq)("",!0)])),_:1},8,["onClosePopup"])):(0,s.kq)("",!0)])])}n(6699);const Ws=e=>((0,s.dD)("data-v-9ccc5ff4"),e=e(),(0,s.Cn)(),e),Ns={class:"client-container"},Os=Ws((()=>(0,s._)("div",{class:"client-icon-container"},[(0,s._)("img",{class:"client-icon",src:"/svg/client-icon.svg"})],-1))),zs={class:"client-name"},qs={class:"client-name-content"},js={class:"client-inn"},Zs={class:"client-inn-content"},Vs={class:"header-buttons"},As={class:"direction-list"},Ys=["onClick"],Ks={key:1,class:"direction-users-list-container"},Rs={key:0,class:"direction-users-list"},Qs=Ws((()=>(0,s._)("div",{class:"divider"},null,-1))),Js={key:1,class:"direction-users-list"},Gs=Ws((()=>(0,s._)("div",{class:"divider"},null,-1))),Xs={key:2,class:"contact-list-container"},ea={key:0,class:"contact-list"},ta={key:1,class:"contact-list"};function na(e,t,n,o,c,r){const l=(0,s.up)("edit-button"),d=(0,s.up)("show-info-btn"),h=(0,s.up)("client-history"),p=(0,s.up)("direction-user"),u=(0,s.up)("contact");return(0,s.wg)(),(0,s.iD)("div",Ns,[(0,s._)("div",{class:"client",onClick:t[2]||(t[2]=(...e)=>r.touchClientInfoButton&&r.touchClientInfoButton(...e))},[Os,(0,s._)("div",zs,[(0,s._)("p",qs,(0,a.zw)(c.client.name),1)]),(0,s._)("div",js,[(0,s._)("p",Zs,"ИНН: "+(0,a.zw)(c.client.inn),1)]),(0,s._)("div",Vs,[(0,s.Wm)(l,{class:"edit-btn",onClick:r.editClient},null,8,["onClick"]),(0,s._)("button",{class:"create-contact-btn",onClick:t[0]||(t[0]=(...e)=>r.touchCreateContact&&r.touchCreateContact(...e))}),(0,s._)("button",{class:"show-client-history",onClick:t[1]||(t[1]=(...e)=>r.touchShowCLientHistory&&r.touchShowCLientHistory(...e))}," Встречи "),(0,s.Wm)(d,{class:"show-info-btn",showInfo:c.isShowContactList},null,8,["showInfo"])])]),c.isShowClientHistory?((0,s.wg)(),(0,s.j4)(h,{key:0,onClose:r.closeHistory},null,8,["onClose"])):(0,s.kq)("",!0),(0,s.wy)((0,s._)("ul",As,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(c.directions,(e=>((0,s.wg)(),(0,s.iD)("li",{key:e,class:"direction-item"},[(0,s._)("button",{class:"direction-segment",onClick:t=>r.showUsersByDirection(e)},(0,a.zw)(e.name),9,Ys)])))),128))],512),[[i.F8,c.isShowContactList]]),-1!==c.selectedDirection?((0,s.wg)(),(0,s.iD)("div",Ks,[c.directionUsers.length?((0,s.wg)(),(0,s.iD)("ul",Rs,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(c.directionUsers,(e=>((0,s.wg)(),(0,s.iD)("li",{class:"direction-users-item",key:e},[(0,s.Wm)(p,{directionUserData:e},null,8,["directionUserData"])])))),128)),Qs])):((0,s.wg)(),(0,s.iD)("ul",Js,[(0,s.Wm)(p),Gs]))])):(0,s.kq)("",!0),c.isShowContactList?((0,s.wg)(),(0,s.iD)("div",Xs,[r.allContacts.length?((0,s.wg)(),(0,s.iD)("ul",ea,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(r.allContacts,(e=>((0,s.wg)(),(0,s.iD)("li",{class:"contact-item",key:e},[(0,s.Wm)(u,{contactData:e,onEdit:t=>r.touchEditContact(e)},null,8,["contactData","onEdit"])])))),128))])):((0,s.wg)(),(0,s.iD)("ul",ta,[(0,s.Wm)(u)]))])):(0,s.kq)("",!0)])}const ia=e=>((0,s.dD)("data-v-659f6a41"),e=e(),(0,s.Cn)(),e),sa={class:"contact-item__header"},aa={class:"contact-name"},oa={class:"contact-name-content"},ca={class:"header-buttons"},ra={key:0,class:"contact-details__content"},la={class:"contact-email"},da={class:"contact-email-content"},ha={class:"drop"},pa=ia((()=>(0,s._)("p",{class:"copy-true"},"Скопированно",-1))),ua={class:"contact-position"},ma={class:"contact-position-content"},ga={class:"contact-number"},wa={class:"contact-number-content"},va={key:1,class:"contact-item empty"},Ca=ia((()=>(0,s._)("span",null,"Нет контактов",-1))),_a=[Ca];function ya(e,t,n,i,o,c){const r=(0,s.up)("edit-button"),l=(0,s.up)("show-info-btn");return void 0!==this.contact?((0,s.wg)(),(0,s.iD)("div",{key:0,class:"contact-item",onClick:t[3]||(t[3]=(...e)=>c.touchContactInfoButton&&c.touchContactInfoButton(...e))},[(0,s._)("div",sa,[(0,s._)("div",aa,[(0,s._)("span",oa,(0,a.zw)(o.contact.first_name)+" "+(0,a.zw)(o.contact.second_name)+" "+(0,a.zw)(o.contact.third_name),1)]),(0,s._)("div",ca,[(0,s.Wm)(r,{onClick:c.editContact},null,8,["onClick"]),(0,s.Wm)(l,{class:"show-info-btn",showInfo:o.showContactInfo},null,8,["showInfo"])])]),o.showContactInfo?((0,s.wg)(),(0,s.iD)("div",ra,[(0,s._)("div",la,[(0,s._)("p",da,"Почта: "+(0,a.zw)(o.contact.email),1),(0,s._)("div",ha,[(0,s._)("i",{class:"material-icons copy-btn qwe",onClick:t[0]||(t[0]=e=>c.copyContentToBuffer(o.contact.email))}," content_copy "),pa])]),(0,s._)("div",ua,[(0,s._)("p",ma," Должность: "+(0,a.zw)(o.contact.position),1),(0,s._)("i",{class:"material-icons copy-btn",onClick:t[1]||(t[1]=e=>c.copyContentToBuffer(o.contact.position))}," content_copy ")]),(0,s._)("div",ga,[(0,s._)("p",wa,"Телефон: "+(0,a.zw)(o.contact.phone),1),(0,s._)("i",{class:"material-icons copy-btn",onClick:t[2]||(t[2]=e=>c.copyContentToBuffer(o.contact.phone))}," content_copy ")])])):(0,s.kq)("",!0)])):((0,s.wg)(),(0,s.iD)("div",va,_a))}const fa={class:"show-info"},ka={class:"show-info-content"};function Da(e,t,n,i,o,c){return(0,s.wg)(),(0,s.iD)("div",fa,[(0,s._)("button",ka,(0,a.zw)(c.buttonTitle),1)])}var ba={props:{showInfo:{type:Boolean,default:!1}},computed:{buttonTitle:function(){return this.showInfo?"Скрыть":"Подробнее"}},data(){return{}}};const Ma=(0,l.Z)(ba,[["render",Da],["__scopeId","data-v-15611764"]]);var Pa=Ma,Sa={components:{ShowInfoBtn:Pa,EditButton:lt},data(){return{showContactInfo:!1,contact:this.contactData}},props:{contactData:{type:Object,default:void 0}},methods:{touchContactInfoButton(){this.showContactInfo=!this.showContactInfo},async editContact(){this.$emit("edit",this.contact)},copyContentToBuffer(e){navigator.clipboard.writeText(null===e?"":e)}}};const Ia=(0,l.Z)(Sa,[["render",ya],["__scopeId","data-v-659f6a41"]]);var $a=Ia;const Ha=e=>((0,s.dD)("data-v-61a1c5ba"),e=e(),(0,s.Cn)(),e),La={class:"client-history-container"},Ba={class:"close-container"},Ea=Ha((()=>(0,s._)("p",null,"x",-1))),Ta=[Ea],Fa={key:0,class:"history-list-container"},Ua={key:0,class:"client-history-list"},xa={class:"history-item-number"},Wa={class:"history-item-date"},Na={class:"history-item-meeting-topic"},Oa={key:1,class:"client-history-list empty"},za=Ha((()=>(0,s._)("li",{class:"history-list-item empty-item"},"История пуста...",-1))),qa=[za];function ja(e,t,n,i,o,c){const r=(0,s.up)("loading-indicate");return(0,s.wg)(),(0,s.iD)("div",La,[(0,s._)("div",Ba,[(0,s._)("button",{class:"close-btn",onClick:t[0]||(t[0]=(...e)=>c.closeHistory&&c.closeHistory(...e))},Ta)]),o.isLoadedData?((0,s.wg)(),(0,s.iD)("div",Fa,[o.historyList.length?((0,s.wg)(),(0,s.iD)("ul",Ua,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(o.historyList,(e=>((0,s.wg)(),(0,s.iD)("li",{class:"history-list-item",key:e},[(0,s._)("span",xa,(0,a.zw)(this.historyList.indexOf(e)+1)+".",1),(0,s._)("span",Wa,(0,a.zw)(e.date),1),(0,s._)("span",Na,(0,a.zw)(e.topic),1)])))),128))])):((0,s.wg)(),(0,s.iD)("ul",Oa,qa))])):((0,s.wg)(),(0,s.j4)(r,{key:1,class:"loading-indicate"}))])}var Za={components:{LoadingIndicate:Q},data(){return{historyList:[],isLoadedData:!1}},async mounted(){this.isLoadedData=!0},methods:{closeHistory(){this.$emit("close")}},props:{client:{type:Object}}};const Va=(0,l.Z)(Za,[["render",ja],["__scopeId","data-v-61a1c5ba"]]);var Aa=Va;const Ya=e=>((0,s.dD)("data-v-503f7a54"),e=e(),(0,s.Cn)(),e),Ka={key:0,class:"direction-user-item"},Ra={class:"direction-user__header"},Qa={class:"direction-user-name"},Ja={class:"direction-user-name-content"},Ga={key:1,class:"direction-user-item empty"},Xa=Ya((()=>(0,s._)("span",null,"Нет сотрудников",-1))),eo=[Xa];function to(e,t,n,i,o,c){return void 0!==this.directionUser?((0,s.wg)(),(0,s.iD)("div",Ka,[(0,s._)("div",Ra,[(0,s._)("div",Qa,[(0,s._)("span",Ja,(0,a.zw)(o.directionUser.first_name)+" "+(0,a.zw)(o.directionUser.second_name)+" "+(0,a.zw)(o.directionUser.third_name),1)])])])):((0,s.wg)(),(0,s.iD)("div",Ga,eo))}var no={data(){return{directionUser:this.directionUserData}},props:{directionUserData:{type:Object,default:void 0}}};const io=(0,l.Z)(no,[["render",to],["__scopeId","data-v-503f7a54"]]);var so=io,ao={components:{Contact:$a,ShowInfoBtn:Pa,EditButton:lt,ClientHistory:Aa,DirectionUser:so},data(){return{isShowContactList:!1,directions:[],isShowClientHistory:!1,contacts:[],client:this.clientData,isCreateContactMode:!0,directionUsers:[],selectedDirection:-1}},props:{clientData:{type:Object,default:{}},newContact:{type:Object,default:void 0}},methods:{async touchClientInfoButton(){this.isShowContactList||(this.contacts=await oe.getClientContacts(this.clientData.id)),this.isShowContactList=!this.isShowContactList,this.selectedDirection=-1},touchCreateContact(){this.$emit("create",this.clientData),this.isCreateContactMode=!0},editClient(){this.$emit("edit",this.clientData)},touchEditContact(e){this.$emit("editContact",e),this.isCreateContactMode=!1},touchShowCLientHistory(){this.isShowClientHistory=!0},closeHistory(){this.isShowClientHistory=!1},async showUsersByDirection(e){this.isShowContactList&&(this.selectedDirection!==e.id?(this.directionUsers=await oe.getClientLinkedUsersByDirection(this.clientData.id,e.id),this.selectedDirection=e.id):this.selectedDirection=-1)}},computed:{allContacts(){if(void 0===this.newContact)return this.contacts;return this.contacts=this.contacts.map(((e,t)=>e.id===this.newContact.id?(!1,this.newContact):e)),this.isCreateContactMode&&this.contacts.push(this.newContact),this.contacts}},async mounted(){this.directions=await oe.getDirections()}};const oo=(0,l.Z)(ao,[["render",na],["__scopeId","data-v-9ccc5ff4"]]);var co=oo,ro={components:{NavBar:le,LoadingIndicate:Q,Client:co,AddButton:Xe,Popup:z,Multicheckbox:In},setup(){return{v$:(0,jt.ZP)()}},validations(){return{newClientName:{required:qt.C1},newClientInn:{required:qt.C1,minLength:(0,qt.Ei)(12),maxLength:(0,qt.BS)(12)},newContactFirstName:{required:qt.C1},newContactSecondName:{required:qt.C1}}},data(){return{clients:[],isLoadedClientsFromApi:!1,searchQuery:"",isMyClients:!0,displayClientPopup:!1,displayContactPopup:!1,newClientName:"",newClientInn:"",newContactFirstName:"",newContactThirdName:"",newContactSecondName:"",newContactPhone:"",newContactPosition:"",newContactEmail:"",isExistClient:!1,isExistContact:!1,isCreateClientMode:!1,isCreateContactMode:!1,editContactObject:{},clientIdForNewContact:"",newContactForClient:new Map,users:[],editClientObject:{name:"",inn:""}}},async mounted(){this.clients=await oe.getClients(!0),this.users=await oe.getUsers(),this.prepareUserOptions(),this.isLoadedClientsFromApi=!0},computed:{searchedClients(){return this.clients.filter((e=>e.name.toLowerCase().includes(this.searchQuery.toLowerCase())||e.inn.includes(this.searchQuery)))},checkboxTitle(){return this.isMyClients?"Мои клиенты":"Все клиенты"},employee_list(){let e=[];return this.isCreateClientMode&&e.push(X.state.user.id),this.users.forEach((t=>{t.isSelected&&e.push(t.id)})),e},popupButtonTitle(){return this.isCreateClientMode||this.isCreateContactMode?"Создать":"Сохранить"},clientPopupTitle(){return this.isCreateClientMode?"Создание клиента":"Редактирование клиента"},contactPopupTitle(){return this.isCreateContactMode?"Создание контакта":"Редактирование контакта"}},methods:{prepareNewContactForChildComponent(e){const t=this.newContactForClient.get(e);return this.newContactForClient.delete(e),t},async editClient(){const e=await this.isCorrectClientForm();e&&(this.editClientObject.name=this.newClientName,this.editClientObject.inn=this.newClientInn,this.editClientObject.employee_list=this.employee_list,await oe.editClient(this.editClientObject),this.closePopupForClient())},async touchEditClient(e){this.editClientObject=e,this.newClientName=e.name,this.newClientInn=e.inn;const t=await oe.getLinkedUsersByClientId(e.id);this.fillSelectedUsersLinkedWithClient(t),this.isCreateClientMode=!1,this.showPopupForClient()},touchCreateClient(){this.isCreateClientMode=!0,this.showPopupForClient()},touchCreateContact(e){this.isCreateContactMode=!0,this.showPopupForContact(),this.clientIdForNewContact=e.id},touchEditContact(e){this.isCreateContactMode=!1,this.showPopupForContact(),this.editContactObject=e,this.newContactFirstName=e.first_name,this.newContactSecondName=e.second_name,this.newContactThirdName=e.third_name,this.newContactPosition=e.position,this.newContactPhone=e.phone,this.newContactEmail=e.email},async createClient(){this.isExistClient=!1;const e=await this.isCorrectClientForm();if(!e)return;const t={name:this.newClientName,inn:this.newClientInn,employee_list:this.employee_list};if(this.isExistClient=await oe.isExistClient(t),this.isExistClient)return;const n=await oe.createClient(t);this.clients.push(n),this.closePopupForClient()},async touchCheckbox(){this.isLoadedClientsFromApi=!1,this.isMyClients=!this.isMyClients,this.clients=await oe.getClients(this.isMyClients),this.isLoadedClientsFromApi=!0},closePopupForClient(){this.displayClientPopup=!1,this.cleareCreateClientPopup(),this.isExistClient=!1,this.isCreateClientMode=!1,this.users.forEach((e=>e.isSelected=!1))},closePopupForContact(){this.displayContactPopup=!1,this.cleareCreateContactPopup(),this.isExistContact=!1},showPopupForClient(){this.displayClientPopup=!0},showPopupForContact(){this.displayContactPopup=!0},cleareCreateClientPopup(){this.newClientName="",this.newClientInn="",this.v$.$reset()},cleareCreateContactPopup(){this.newContactFirstName="",this.newContactSecondName="",this.newContactThirdName="",this.newContactPhone="",this.newContactPosition="",this.newContactEmail="",this.v$.$reset()},async clientPopupActionHandler(){this.isCreateClientMode?await this.createClient():await this.editClient()},async contactPopupActionHandler(){this.isCreateContactMode?await this.createContact():await this.editContact()},async createContact(){this.isExistContact=!1;const e=await this.isCorrectContactForm();if(!e)return;const t={client:this.clientIdForNewContact,first_name:this.newContactFirstName,second_name:this.newContactSecondName,third_name:this.newContactThirdName,phone:this.newContactPhone,position:this.newContactPosition,email:this.newContactEmail};if(this.isExistContact=await oe.isExistContact(t),this.isExistContact)return;const n=await oe.createContact(t);this.newContactForClient.set(t.client,n),this.closePopupForContact()},async editContact(){const e=await this.isCorrectContactForm();if(!e)return;const t=await oe.editContact({first_name:this.newContactFirstName,second_name:this.newContactSecondName,third_name:this.newContactThirdName,phone:this.newContactPhone,position:this.newContactPosition,email:this.newContactEmail,client:this.editContactObject.client,id:this.editContactObject.id});this.newContactForClient.set(this.editContactObject.client,t),this.closePopupForContact()},async isCorrectContactForm(){const e=await this.v$.newContactFirstName.$validate(),t=await this.v$.newContactSecondName.$validate();return!(!e||!t)},async isCorrectClientForm(){const e=await this.v$.newClientName.$validate(),t=await this.v$.newClientInn.$validate();return!(!e||!t)},prepareUserOptions(){return this.users=this.users.map((e=>(e.isSelected=!1,e.name=this.fullNameWithDirection(e),e))),this.users},fullNameWithDirection(e){return e.second_name+" "+e.first_name[0]+e.third_name[0]+"("+e.direction_name+")"},fillSelectedUsersLinkedWithClient(e){this.users.forEach((t=>{e.forEach((e=>{t.id===e.id&&(t.isSelected=!0)}))}))}}};const lo=(0,l.Z)(ro,[["render",xs],["__scopeId","data-v-1861f258"]]);var ho=lo;const po=e=>((0,s.dD)("data-v-40dbb8c9"),e=e(),(0,s.Cn)(),e),uo={class:"wrapper"},mo=po((()=>(0,s._)("h1",null,"Meeting results page",-1)));function go(e,t,n,i,a,o){const c=(0,s.up)("nav-bar"),r=(0,s.up)("loading-indicate");return(0,s.wg)(),(0,s.iD)("div",uo,[(0,s.Wm)(c),mo,(0,s.Wm)(r)])}var wo={components:{NavBar:le,LoadingIndicate:Q}};const vo=(0,l.Z)(wo,[["render",go],["__scopeId","data-v-40dbb8c9"]]);var Co=vo,_o=n(2483);const yo=[{path:"/",component:Gt,name:"Главная"},{path:"/login",component:pn,name:"Вход"},{path:"/calendar",component:ts,name:"Календарь"},{path:"/results",component:Co,name:"Отчеты"},{path:"/clients",component:ho,name:"Клиенты"}],fo=(0,_o.p7)({routes:yo,history:(0,_o.PO)()});fo.beforeEach(((e,t,n)=>{document.title=e.name,n()}));var ko=fo;const Do=(0,c.MT)({modules:{auth:X}});var bo=Do;const Mo=(0,i.ri)(h);Mo.use(ko),Mo.use(bo),Mo.mount("#app")}},t={};function n(i){var s=t[i];if(void 0!==s)return s.exports;var a=t[i]={exports:{}};return e[i](a,a.exports,n),a.exports}n.m=e,function(){var e=[];n.O=function(t,i,s,a){if(!i){var o=1/0;for(d=0;d<e.length;d++){i=e[d][0],s=e[d][1],a=e[d][2];for(var c=!0,r=0;r<i.length;r++)(!1&a||o>=a)&&Object.keys(n.O).every((function(e){return n.O[e](i[r])}))?i.splice(r--,1):(c=!1,a<o&&(o=a));if(c){e.splice(d--,1);var l=s();void 0!==l&&(t=l)}}return t}a=a||0;for(var d=e.length;d>0&&e[d-1][2]>a;d--)e[d]=e[d-1];e[d]=[i,s,a]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,i){var s,a,o=i[0],c=i[1],r=i[2],l=0;if(o.some((function(t){return 0!==e[t]}))){for(s in c)n.o(c,s)&&(n.m[s]=c[s]);if(r)var d=r(n)}for(t&&t(i);l<o.length;l++)a=o[l],n.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return n.O(d)},i=self["webpackChunkvue_project"]=self["webpackChunkvue_project"]||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))}();var i=n.O(void 0,[998],(function(){return n(1719)}));i=n.O(i)})();
//# sourceMappingURL=app.d0507b03.js.map