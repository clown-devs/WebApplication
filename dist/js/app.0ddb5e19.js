(function(){"use strict";var e={1780:function(e,t,n){var i=n(9242),s=n(3396),a=n(2268);function o(e,t,n,i,o,c){const r=(0,s.up)("router-view");return(0,s.wg)(),(0,s.iD)("div",{class:(0,a.C_)(["app",{loginColor:c.isSignIn}])},[(0,s.Wm)(r)],2)}var c=n(7139),r=n(6265),l=n.n(r),d={actions:{async logIn(e,{username:t,password:n,isSavedSession:i}){const s=await C.isValidToken();s||(e.commit("logOut"),p());const a=await C.auth(t,n);if(null===a)return e.commit("setErrorMessage",C.error),C.error="",!1;e.commit("setToken",a.auth_token);let o=!0;const c=await e.dispatch("getUser");return null===c&&(o=!1),i&&e.commit("saveSessionToLocalStorage"),e.commit("saveSessionToSessionStorage"),o&&e.commit("setErrorMessage",""),o},async getUser(e){const t=await C.currentUser(e.state.token);return null===t?(e.commit("setErrorMessage",C.error),C.error="",null):(e.commit("updateUser",t),t)}},mutations:{setToken(e,t){e.token=t,u()},saveSessionToLocalStorage(e){localStorage.setItem("token",e.token),localStorage.setItem("user",JSON.stringify(e.user))},saveSessionToSessionStorage(e){sessionStorage.setItem("token",e.token),sessionStorage.setItem("user",JSON.stringify(e.user))},updateUser(e,t){e.user=t},loadDataFromLocalStorage(e){e.token=localStorage.getItem("token"),e.user=JSON.parse(localStorage.getItem("user")),u()},loadDataFromSessionStorage(e){e.token=sessionStorage.getItem("token"),e.user=JSON.parse(sessionStorage.getItem("user")),u()},logOut(e){e.token="",e.user={},localStorage.removeItem("token"),localStorage.removeItem("user"),sessionStorage.removeItem("token"),sessionStorage.removeItem("user")},setErrorMessage(e,t){e.errorMessage=t}},state:{token:null,user:{},errorMessage:""},getters:{}};const h=l().create({baseURL:"http://sbermeeting.tk/",headers:{accept:"application/json"}});function u(){h.defaults.headers.common["Authorization"]="Token "+d.state.token}function p(){h.defaults.headers.common["Authorization"]=null}var m=h;const g="api/v2/",w={auth:"users/auth/token/login/",user:"users/employee/current/",meetings:"meetings/",client:"clients/",contact:"clients/contacts/",place:"meetings/place/",employeelist:"employeelist/",users:"users/employee/",directions:"users/directions/",users_employee:"users/employee/",check_token:"users/check_token/"},v={error:{},async auth(e,t){try{const n=await m.post(g+w["auth"],{username:e,password:t});return n.data}catch(n){return this.errorHandle(n),null}},async isValidToken(){try{const e=await m.post(g+w["check_token"],{token:d.state.token});return e.data.is_valid}catch(e){return this.errorHandle(e),null}},async currentUser(){try{const e=await m.get(g+w["user"],{headers:{Authorization:"Token "+d.state.token}});return e.data}catch(e){return this.errorHandle(e),null}},async getMeetings(e=!1){try{const t=await m.get(g+w["meetings"]+"?employee="+d.state.user.id+(e?"&past=true":"&future=true"));return t.data}catch(t){return this.errorHandle(t),[]}},async getMeetingsInPlaceByDate(e,t){try{const n=await m.get(g+w["meetings"]+"?place="+t.id+"&date="+String(e.getFullYear())+"-"+String(e.getMonth()+1)+"-"+String(e.getDate()));return n.data}catch(n){return console.log(n),this.errorHandle(n),[]}},async getMeetingsByDate(e){try{const t=await m.get(g+w["meetings"]+"?date="+String(e.getFullYear())+"-"+String(e.getMonth()+1)+"-"+String(e.getDate()));return t.data}catch(t){return this.errorHandle(t),[]}},async getClients(e){try{let t=await m.get(g+w["client"]+(e?"?employee="+d.state.user.id:""));return t.data}catch(t){return this.errorHandle(t),[]}},async editClient(e){try{let t=await m.patch(g+w["client"]+e.id+"/",e);return t.data}catch(t){return this.errorHandle(t),{}}},async editContact(e){try{let t=await m.patch(g+w["contact"]+e.id+"/",e);return t.data}catch(t){return this.errorHandle(t),{}}},async getClientContacts(e){try{let t=await m.get(g+w["contact"]+"?client="+e);return t.data}catch(t){return this.errorHandle(t),[]}},async getPlaces(){try{let e=await m.get(g+w["place"]+"?my=true",{headers:{Authorization:"Token "+d.state.token}});return e.data}catch(e){return this.errorHandle(e),[]}},async getFreePlaces(e,t,n){try{let i=await m.get(g+w["place"]+"?date="+n+"&start="+e+"&end="+t+"&my=true");return i.data}catch(i){return this.errorHandle(i),[]}},async createMeeting(e){try{const t=await m.post(g+w["meetings"],e);return t.data}catch(t){return this.errorHandle(t),{}}},async createClient(e){try{let t=await m.post(g+w["client"],e);return t.data}catch(t){return this.errorHandle(t),{}}},async createContact(e){try{let t=await m.post(g+w["contact"],e);return t.data}catch(t){return this.errorHandle(t),{}}},async isExistClient(e){try{let t=await m.get(g+w["client"]+"?inn="+e.inn);return t.data.length}catch(t){return this.errorHandle(t),!1}},async isExistContact(e){try{let t=await m.get(g+w["contact"]+"?client="+e.client+"&first_name="+e.first_name+"&second_name="+e.second_name);return t.data.length}catch(t){return this.errorHandle(t),!1}},async getUsers(){try{let e=await m.get(g+w["users"]);return e.data}catch(e){return this.errorHandle(e),[]}},async deleteMeeting(e){try{let t=await m["delete"](g+w["meetings"]+e+"/");return t.data}catch(t){return this.errorHandle(t),{}}},async editMeeting(e){try{let t=await m.patch(g+w["meetings"]+e.id+"/",e);return t.data}catch(t){return this.errorHandle(t),{}}},async getDirections(){try{let e=await m.get(g+w["directions"]);return e.data}catch(e){return this.errorHandle(e),{}}},async getLinkedUsersByClientId(e){try{let t=await m.get(g+w["users_employee"]+"?client="+String(e));return t.data}catch(t){return this.errorHandle(t),{}}},async getClientLinkedUsersByDirection(e,t){try{let n=await m.get(g+w["users_employee"]+"?client="+String(e)+"&direction="+String(t));return n.data}catch(n){return this.errorHandle(n),{}}},errorHandle(e){if(e.response)switch(e.response.status){case 400:this.error="Неверный логин/пароль";break;case 401:this.error=e.response.statusText+"."+e.response.data.detail;break;default:this.error=e.message+"."+e.response.statusText}else e.request&&(this.error="Bad connection")}};var C=v,_={computed:{isSignIn(){return"/login"===this.$route.path}},methods:{...(0,c.OI)(["loadDataFromLocalStorage","loadDataFromSessionStorage"])},async mounted(){null===sessionStorage.getItem("token")?null===localStorage.getItem("token")?this.$router.push("/login"):this.loadDataFromLocalStorage():this.loadDataFromSessionStorage()}},y=n(89);const f=(0,y.Z)(_,[["render",o]]);var k=f;const D={class:"wrapper"};function b(e,t,n,i,a,o){const c=(0,s.up)("nav-bar"),r=(0,s.up)("meetings");return(0,s.wg)(),(0,s.iD)("div",D,[(0,s.Wm)(c),(0,s.Wm)(r)])}const M=e=>((0,s.dD)("data-v-194b2483"),e=e(),(0,s.Cn)(),e),P={class:"header"},S={class:"title-name title-names"},I={class:"nav-bar-list"},$=M((()=>(0,s._)("input",{type:"checkbox",name:"",id:"checkbox_toggle"},null,-1))),H=M((()=>(0,s._)("label",{for:"checkbox_toggle",class:"hamburger"},[(0,s._)("span",{class:"hamburger-line"})],-1))),L={class:"menu-items"},T=(0,s.Uk)("Мои клиенты"),B=(0,s.Uk)("Календарь"),E=(0,s.Uk)("Отчёты по встречам"),F=M((()=>(0,s._)("button",{class:"log-out-item"},"Выйти",-1))),U=[F],x=M((()=>(0,s._)("button",{class:"nav-bar-notify-button"},[(0,s._)("img",{src:"/svg/notify.svg",alt:"",class:"nav-bar-notify-icon"})],-1))),W={class:"popup_wrapper"},N=M((()=>(0,s._)("h1",{class:"popup-title"},"Доступные комнаты",-1))),O=M((()=>(0,s._)("img",{src:"/svg/add-meet.svg",alt:"",class:"nav-bar-icon-add"},null,-1))),z=[O],q=M((()=>(0,s._)("button",{class:"nav-bar-profile"},[(0,s._)("img",{src:"/svg/profile.svg",alt:"",class:"nav-bar-profile-icon"})],-1))),j=M((()=>(0,s._)("hr",{class:"line-header"},null,-1)));function Z(e,t,n,o,c,r){const l=(0,s.up)("router-link"),d=(0,s.up)("loading-indicate"),h=(0,s.up)("v-popup");return(0,s.wg)(),(0,s.iD)("header",P,[(0,s._)("nav",null,[(0,s._)("div",S,[(0,s._)("h3",{class:"logo-name",onClick:t[0]||(t[0]=t=>e.$router.push("/"))},"Sber clients")]),(0,s._)("ul",I,[$,H,(0,s._)("div",L,[(0,s._)("li",{class:"nav-bar-list-item",onClick:t[1]||(t[1]=t=>e.$router.push("/clients"))},[(0,s.Wm)(l,{to:"/clients",class:"inactive","active-class":"active"},{default:(0,s.w5)((()=>[T])),_:1})]),(0,s._)("li",{class:"nav-bar-list-item",onClick:t[2]||(t[2]=t=>e.$router.push("/calendar"))},[(0,s.Wm)(l,{to:"/calendar",class:"inactive","active-class":"active"},{default:(0,s.w5)((()=>[B])),_:1})]),(0,s._)("li",{class:"nav-bar-list-item",onClick:t[3]||(t[3]=t=>e.$router.push("/results"))},[(0,s.Wm)(l,{to:"/results",class:"inactive","active-class":"active"},{default:(0,s.w5)((()=>[E])),_:1})]),(0,s._)("li",{class:"nav-bar-list-item button-exit",onClick:t[4]||(t[4]=(...e)=>r.logOutWrapper&&r.logOutWrapper(...e))},U)])]),x,(0,s._)("div",W,[c.isInfoPopupVisible?((0,s.wg)(),(0,s.j4)(h,{key:0,onClosePopup:r.closeInfoPopup,class:"modal-window"},{header:(0,s.w5)((()=>[N])),content:(0,s.w5)((()=>[c.isLoadedPlaces?(0,s.wy)(((0,s.wg)(),(0,s.iD)("select",{key:0,name:"",id:"",class:"select-room","onUpdate:modelValue":t[5]||(t[5]=e=>c.selected=e)},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(c.places,(e=>((0,s.wg)(),(0,s.iD)("option",{key:e},(0,a.zw)(e.name),1)))),128))],512)),[[i.bM,c.selected]]):((0,s.wg)(),(0,s.j4)(d,{key:1}))])),_:1},8,["onClosePopup"])):(0,s.kq)("",!0)]),(0,s._)("button",{class:"nav-bar-add-meet v-modal_add-meet",id:"btn-add",onClick:t[6]||(t[6]=(...e)=>r.showPopupInfo&&r.showPopupInfo(...e))},z),q,(0,s._)("button",{onClick:t[7]||(t[7]=(...e)=>r.logOutWrapper&&r.logOutWrapper(...e)),class:"log-out"},"Выйти")]),j])}const V={class:"popup_wrapper",ref:"popup_wrapper"},A={class:"v-popup__header"},Y={class:"v-popup__content"},K={class:"v-popup__footer"};function R(e,t,n,a,o,c){return(0,s.wg)(),(0,s.iD)("div",V,[(0,s._)("form",{class:"v-popup animation",onSubmit:t[1]||(t[1]=(0,i.iM)((()=>{}),["prevent"]))},[(0,s._)("div",A,[(0,s.WI)(e.$slots,"header",{},void 0,!0),(0,s._)("span",null,[(0,s._)("i",{class:"material-icons",onClick:t[0]||(t[0]=(...e)=>c.closePopup&&c.closePopup(...e))}," close ")])]),(0,s._)("div",Y,[(0,s.WI)(e.$slots,"content",{},void 0,!0)]),(0,s._)("div",K,[(0,s.WI)(e.$slots,"footer",{},void 0,!0)])],32)],512)}var Q={props:{},data(){return{}},methods:{closePopup(){this.$emit("closePopup")}},mounted(){let e=this;document.addEventListener("click",(function(t){t.target===e.$refs["popup_wrapper"]&&e.closePopup()}))}};const J=(0,y.Z)(Q,[["render",R],["__scopeId","data-v-b5ee4bea"]]);var G=J;const X=e=>((0,s.dD)("data-v-206c088c"),e=e(),(0,s.Cn)(),e),ee={class:"loading-container"},te=X((()=>(0,s._)("div",{class:"loading-indicator"},null,-1))),ne=X((()=>(0,s._)("p",{class:"information-text"},"Загрузка данных...",-1))),ie=[te,ne];function se(e,t,n,i,a,o){return(0,s.wg)(),(0,s.iD)("div",ee,ie)}var ae={};const oe=(0,y.Z)(ae,[["render",se],["__scopeId","data-v-206c088c"]]);var ce=oe,re={components:{vPopup:G,LoadingIndicate:ce},methods:{...(0,c.OI)(["logOut"]),logOutWrapper(){this.$router.push("/login"),this.logOut()},showPopupInfo(){this.isInfoPopupVisible=!0},closeInfoPopup(){this.isInfoPopupVisible=!1}},data(){return{isInfoPopupVisible:!1,isLoadedPlaces:!1,places:[],selected:"test"}},async mounted(){this.places=await C.getPlaces(),this.isLoadedPlaces=!0}};const le=(0,y.Z)(re,[["render",Z],["__scopeId","data-v-194b2483"]]);var de=le;const he=e=>((0,s.dD)("data-v-2dedb246"),e=e(),(0,s.Cn)(),e),ue={class:"main-container"},pe={key:0,class:"near-meet"},me=he((()=>(0,s._)("h2",{class:"near-meet-text"},"Ближайшая встреча:",-1))),ge=he((()=>(0,s._)("button",{class:"pencil-meet"},[(0,s._)("img",{src:"/svg/pencil.svg",alt:"",class:"pencil-icon"})],-1))),we={class:"client-name"},ve={class:"window-tel-and-contact"},Ce={class:"contact-window"},_e={class:"tel-window"},ye={class:"theme-window"},fe={class:"data-and-time-window"},ke={class:"data-window"},De={class:"time-window"},be={class:"place-window"},Me={key:1,class:"container-window empty"},Pe=he((()=>(0,s._)("p",null,"Нет ближайшей встречи",-1))),Se=[Pe],Ie={class:"green-button-add"},$e=(0,s.Uk)("Добавить встречу"),He={key:3,class:"list-meet"},Le=he((()=>(0,s._)("h2",{class:"list-meet-text"},"Список встреч:",-1))),Te=he((()=>(0,s._)("span",null,"Текущие",-1))),Be=he((()=>(0,s._)("span",null,"Прошедшие",-1))),Ee={key:0,class:"list-all-meet"},Fe=["onClick"],Ue={class:"data-time-place-item"},xe={class:"data-item"},We={class:"time-item"},Ne={class:"place-item"},Oe={class:"theme-item"},ze={class:"theme-item-container"},qe={class:"client-item"},je={class:"client-item-container"},Ze={key:1,class:"list-all-meet"},Ve=he((()=>(0,s._)("li",{class:"all-meet-item empty"},[(0,s._)("p",null,"Нет встреч")],-1))),Ae=[Ve],Ye={class:"add-meeting-phone"},Ke=(0,s.Uk)("Добавить встречу");function Re(e,t,n,i,o,c){const r=(0,s.up)("add-button"),l=(0,s.up)("create-meet"),d=(0,s.up)("segmented-control"),h=(0,s.up)("edit-button"),u=(0,s.up)("loading-indicate");return(0,s.wg)(),(0,s.iD)("main",ue,[o.isLoadedMeetings?((0,s.wg)(),(0,s.iD)("div",pe,[me,void 0!==o.nearMeeting?((0,s.wg)(),(0,s.iD)("div",{key:0,class:"container-window",onClick:t[0]||(t[0]=e=>c.editMeeting(this.nearMeeting))},[ge,(0,s._)("p",we,(0,a.zw)(o.nearMeeting.client_name),1),(0,s._)("div",ve,[(0,s._)("p",Ce,(0,a.zw)(o.nearMeeting.contact_name),1),(0,s._)("p",_e,(0,a.zw)(o.nearMeeting.contact_phone),1)]),(0,s._)("p",ye,(0,a.zw)(o.nearMeeting.topic),1),(0,s._)("div",fe,[(0,s._)("p",ke,(0,a.zw)(o.nearMeeting.date),1),(0,s._)("p",De,(0,a.zw)(o.nearMeeting.start)+" - "+(0,a.zw)(o.nearMeeting.end),1)]),(0,s._)("p",be,(0,a.zw)(o.nearMeeting.place_name),1)])):((0,s.wg)(),(0,s.iD)("div",Me,Se)),(0,s._)("div",Ie,[(0,s.Wm)(r,{onClick:t[1]||(t[1]=e=>this.displayCreateMeetPopup=!0)},{default:(0,s.w5)((()=>[$e])),_:1})])])):(0,s.kq)("",!0),o.displayEditMeetPopup?((0,s.wg)(),(0,s.j4)(l,{key:1,onClosePopup:c.closeEditPopup,isCreatePopup:!1,editingMeet:this.editingMeet,onCancelMeeting:c.deleteMeeting,onEditMeeting:c.changeEditedMeeting,class:"meet__modal-window"},null,8,["onClosePopup","editingMeet","onCancelMeeting","onEditMeeting"])):(0,s.kq)("",!0),o.displayCreateMeetPopup?((0,s.wg)(),(0,s.j4)(l,{key:2,onClosePopup:c.closeCreatePopup,onCreateMeeting:c.displayNewMeeting,class:"meet__modal-window"},null,8,["onClosePopup","onCreateMeeting"])):(0,s.kq)("",!0),o.isLoadedMeetings?((0,s.wg)(),(0,s.iD)("div",He,[Le,(0,s.Wm)(d,{class:"segmented-control",onSelected:c.selectedSegmentedControl},{item1:(0,s.w5)((()=>[Te])),item2:(0,s.w5)((()=>[Be])),_:1},8,["onSelected"]),o.meetings.length?((0,s.wg)(),(0,s.iD)("ul",Ee,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(o.meetings,(e=>((0,s.wg)(),(0,s.iD)("li",{key:e,class:"all-meet-item",onClick:t=>c.editMeeting(e)},[(0,s._)("div",Ue,[(0,s._)("p",xe,(0,a.zw)(e.date),1),(0,s._)("p",We,(0,a.zw)(e.start)+" - "+(0,a.zw)(e.end),1),(0,s._)("p",Ne,(0,a.zw)(e.place_name),1),(0,s.Wm)(h,{class:"edit-btn"})]),(0,s._)("p",Oe,[(0,s._)("span",ze,(0,a.zw)(e.topic),1)]),(0,s._)("p",qe,[(0,s._)("span",je,(0,a.zw)(e.client_name),1)])],8,Fe)))),128))])):((0,s.wg)(),(0,s.iD)("ul",Ze,Ae))])):((0,s.wg)(),(0,s.j4)(u,{key:4,class:"indicator"})),(0,s._)("div",Ye,[(0,s.Wm)(r,{onClick:t[2]||(t[2]=e=>this.displayCreateMeetPopup=!0)},{default:(0,s.w5)((()=>[Ke])),_:1})])])}const Qe={class:"add-meet-but"};function Je(e,t,n,i,a,o){return(0,s.wg)(),(0,s.iD)("button",Qe,[(0,s.WI)(e.$slots,"default",{},void 0,!0)])}var Ge={};const Xe=(0,y.Z)(Ge,[["render",Je],["__scopeId","data-v-74fe8ef9"]]);var et=Xe;const tt={class:"segmented-control-container"};function nt(e,t,n,i,o,c){return(0,s.wg)(),(0,s.iD)("div",tt,[(0,s._)("button",{class:(0,a.C_)(["segmented-control-item",{active:o.isFirstItemActive}]),onClick:t[0]||(t[0]=(...e)=>c.touchItem&&c.touchItem(...e))},[(0,s.WI)(e.$slots,"item1",{class:"segmented-control-item-name"},void 0,!0)],2),(0,s._)("button",{class:(0,a.C_)(["segmented-control-item",{active:!o.isFirstItemActive}]),onClick:t[1]||(t[1]=(...e)=>c.touchItem&&c.touchItem(...e))},[(0,s.WI)(e.$slots,"item2",{class:"segmented-control-item-name"},void 0,!0)],2)])}var it={data(){return{isFirstItemActive:!0}},methods:{touchItem(){this.isFirstItemActive=!this.isFirstItemActive,this.$emit("selected",this.isFirstItemActive)}}};const st=(0,y.Z)(it,[["render",nt],["__scopeId","data-v-12f33ba4"]]);var at=st;const ot={class:"edit-btn"};function ct(e,t,n,i,a,o){return(0,s.wg)(),(0,s.iD)("button",ot,"...")}var rt={};const lt=(0,y.Z)(rt,[["render",ct],["__scopeId","data-v-d1647bac"]]);var dt=lt;const ht={class:"popup_wrapper",ref:"popup_wrapper"},ut={class:"v-popup__header"},pt={class:"popup-title"},mt={class:"v-popup__content"},gt={class:"info-meeting"},wt={class:"info-meet-main"},vt={class:"client-container"},Ct=["value","disabled"],_t={class:"contact-container"},yt=["value","disabled"],ft={class:"theme-container"},kt={key:0,class:"validate-error-message"},Dt={class:"date-container"},bt={key:0,class:"validate-error-message"},Mt={key:1,class:"validate-error-message"},Pt={class:"time-start-end"},St={class:"time-start"},It={key:0,class:"validate-error-message"},$t={key:1,class:"validate-error-message"},Ht={class:"time-end"},Lt={key:0,class:"validate-error-message"},Tt={class:"place-container"},Bt=["value","disabled"],Et={key:0,class:"validate-error-message"},Ft={class:"worker-container"},Ut=["value","disabled"],xt={class:"info-note"},Wt={class:"note-container"},Nt={class:"footer-btns"},Ot=(0,s.Uk)("Удалить "),zt=(0,s.Uk)("Сохранить ");function qt(e,t,n,o,c,r){const l=(0,s.up)("add-button");return(0,s.wg)(),(0,s.iD)("div",ht,[(0,s._)("form",{class:"v-popup animation",onSubmit:t[14]||(t[14]=(0,i.iM)((()=>{}),["prevent"]))},[(0,s._)("div",ut,[(0,s._)("span",pt,(0,a.zw)(r.popupTitle),1),(0,s._)("span",null,[(0,s._)("i",{class:"material-icons",onClick:t[0]||(t[0]=(...e)=>r.closePopup&&r.closePopup(...e))}," close ")])]),(0,s._)("div",mt,[(0,s._)("div",gt,[(0,s._)("div",wt,[(0,s._)("div",vt,[(0,s.wy)((0,s._)("select",{class:"client-input","onUpdate:modelValue":t[1]||(t[1]=e=>c.selectedClient=e),onChange:t[2]||(t[2]=(...e)=>r.selectClientHandler&&r.selectClientHandler(...e))},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(c.clients,(e=>((0,s.wg)(),(0,s.iD)("option",{value:e,disabled:0===e.id},(0,a.zw)(e.name),9,Ct)))),256))],544),[[i.bM,c.selectedClient]])]),(0,s._)("div",_t,[(0,s.wy)((0,s._)("select",{class:"contact-input","onUpdate:modelValue":t[3]||(t[3]=e=>c.selectedContact=e)},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(c.contacts,(e=>((0,s.wg)(),(0,s.iD)("option",{value:e,disabled:0===e.id},(0,a.zw)(e.name),9,yt)))),256))],512),[[i.bM,c.selectedContact]])]),(0,s._)("div",ft,[(0,s.wy)((0,s._)("input",{type:"text",class:(0,a.C_)(["theme-input",{invalid:o.v$.theme.$error}]),placeholder:"Тема","onUpdate:modelValue":t[4]||(t[4]=e=>c.theme=e)},null,2),[[i.nr,c.theme]]),o.v$.theme.$error?((0,s.wg)(),(0,s.iD)("small",kt," Тема встречи является обязательным полем! ")):(0,s.kq)("",!0)]),(0,s._)("div",Dt,[(0,s.wy)((0,s._)("input",{type:"date",class:(0,a.C_)(["date-input",{invalid:o.v$.date.$error||!this.isCorrectDate}]),placeholder:"Дата",id:"datepicker","onUpdate:modelValue":t[5]||(t[5]=e=>c.date=e),onChange:t[6]||(t[6]=(...e)=>r.changeTime&&r.changeTime(...e))},null,34),[[i.nr,c.date]]),o.v$.date.$error?((0,s.wg)(),(0,s.iD)("small",bt," Поле даты - обязательное поле! ")):(0,s.kq)("",!0),r.isCorrectDate?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("small",Mt," Дата должна быть >= текущей даты! "))]),(0,s._)("div",Pt,[(0,s._)("div",St,[(0,s.wy)((0,s._)("input",{type:"time",class:(0,a.C_)(["date-start-input",{invalid:o.v$.start.$error||!this.isCorrectSelectedTime}]),placeholder:"Время начала",id:"start-picker","onUpdate:modelValue":t[7]||(t[7]=e=>c.start=e),onChange:t[8]||(t[8]=(...e)=>r.changeTime&&r.changeTime(...e))},null,34),[[i.nr,c.start]]),o.v$.start.$error?((0,s.wg)(),(0,s.iD)("small",It," Время начала встречи - обязательное поле! ")):(0,s.kq)("",!0),r.isCorrectSelectedTime?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("small",$t," Время начало должно быть меньше время конца встречи! "))]),(0,s._)("div",Ht,[(0,s.wy)((0,s._)("input",{type:"time",class:(0,a.C_)(["date-end-input",{invalid:o.v$.end.$error}]),placeholder:"Время окончания",id:"end-picker","onUpdate:modelValue":t[9]||(t[9]=e=>c.end=e),onChange:t[10]||(t[10]=(...e)=>r.changeTime&&r.changeTime(...e))},null,34),[[i.nr,c.end]]),o.v$.end.$error?((0,s.wg)(),(0,s.iD)("small",Lt," Время окончания встречи - обязательное поле! ")):(0,s.kq)("",!0)])]),(0,s._)("div",Tt,[(0,s.wy)((0,s._)("select",{class:(0,a.C_)(["place-input",{invalid:o.v$.end.$error}]),"onUpdate:modelValue":t[11]||(t[11]=e=>c.place=e)},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(c.freePlaces,(e=>((0,s.wg)(),(0,s.iD)("option",{value:e,disabled:0===e.id},(0,a.zw)(e.name),9,Bt)))),256))],2),[[i.bM,c.place]]),o.v$.place.$error?((0,s.wg)(),(0,s.iD)("small",Et," Место встречи - обязательное поле! ")):(0,s.kq)("",!0)])]),(0,s._)("div",Ft,[(0,s.wy)((0,s._)("select",{class:"worker-input","onUpdate:modelValue":t[12]||(t[12]=e=>c.selectedUsersInMeeting=e),multiple:"",style:{padding:"5px 0 0 5px"}},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(c.users,(e=>((0,s.wg)(),(0,s.iD)("option",{value:e,disabled:0===e.id},(0,a.zw)(r.prepareUserForDisplay(e)),9,Ut)))),256))],512),[[i.bM,c.selectedUsersInMeeting]])])]),(0,s._)("div",xt,[(0,s._)("div",Wt,[(0,s.wy)((0,s._)("textarea",{type:"text",class:"note-input",placeholder:"Заметки","onUpdate:modelValue":t[13]||(t[13]=e=>c.note=e),style:{padding:"5px 0 0 5px"},maxlength:"4096"},null,512),[[i.nr,c.note]])])])]),(0,s._)("div",Nt,[n.isCreatePopup?(0,s.kq)("",!0):((0,s.wg)(),(0,s.j4)(l,{key:0,class:"popup-footer-btn popup-edit",onClick:r.touchCancelMeetingButtonHandler},{default:(0,s.w5)((()=>[Ot])),_:1},8,["onClick"])),(0,s.Wm)(l,{class:"popup-footer-btn popup-save",onClick:r.touchSaveButtonHandler},{default:(0,s.w5)((()=>[zt])),_:1},8,["onClick"])])],32)],512)}var jt=n(9117),Zt=n(3053),Vt={components:{Popup:G,AddButton:et},props:{isCreatePopup:{type:Boolean,default:!0},editingMeet:{type:Object,default:null}},setup(){return{v$:(0,Zt.ZP)()}},validations(){return{theme:{required:jt.C1},start:{required:jt.C1},end:{required:jt.C1},date:{required:jt.C1},place:{required:jt.C1}}},data(){return{selectedClient:{name:"Клиент",id:0,inn:""},selectedContact:{name:"Контактное лицо",id:0},selectedUsersInMeeting:[{name:"Сотрудники",id:0,direction:""}],clients:[{name:"Клиент",id:0,inn:""}],contacts:[{name:"Контактное лицо",id:0}],freePlaces:[{name:"Свободные переговорки",id:0,is_private:!1}],start:"",end:"",date:"",theme:"",place:{name:"Свободные переговорки",id:0,is_private:!1},note:"",users:[{name:"Сотрудники",id:0,direction:""}]}},methods:{async touchSaveButtonHandler(){const e=await this.isCorrectForm();if(!e)return;let t={date:this.date,start:this.start,end:this.end,place_name:this.place.name,place_id:null!==this.place.id?this.place.id:"",topic:this.theme,note:this.note,creator_id:d.state.user.id,contact_id:this.selectedContact.id,client_id:0!==this.selectedClient.id?this.selectedClient.id:"",employee_list:this.getEmployeeList()};if(this.isCreatePopup)t=await C.createMeeting(t),this.$emit("createMeeting",t);else{t["id"]=this.editingMeet.id;const e=await C.editMeeting(t);this.$emit("editMeeting",e)}this.closePopup()},closePopup(){this.$emit("closePopup"),this.clearPopup()},async isCorrectForm(){const e=await this.v$.theme.$validate(),t=await this.v$.start.$validate(),n=await this.v$.end.$validate(),i=await this.v$.date.$validate(),s=await this.v$.place.$validate();return!!(e&&t&&n&&i&&s&&this.isCorrectSelectedTime&&this.isCorrectDate)},clearPopup(){this.selectedClient="0",this.selectedContact="",this.clients=[],this.contacts=[],this.freePlaces=[],this.start="",this.end="",this.date="",this.theme="",this.place="",this.v$.$reset()},async selectClientHandler(){if(null!==this.selectedClient.id){const e=await C.getClientContacts(this.selectedClient.id);this.fillContactsForSelect(e)}},async changeTime(){""!==this.start&&""!==this.end&&""!==this.date&&await this.fillFreePlaces()},getEmployeeList(){const e=[];for(let t in this.selectedUsersInMeeting)0!==this.selectedUsersInMeeting[t].id&&e.push(this.selectedUsersInMeeting[t].id);return e},async fillDataInputs(){this.selectedClient={name:this.editingMeet.client_name,id:this.editingMeet.client_id,inn:this.editingMeet.client_inn},await this.selectClientHandler(),this.selectedContact={name:this.editingMeet.contact_name,id:this.editingMeet.contact_id},this.theme=this.editingMeet.topic,this.note=this.editingMeet.note,this.date=this.editingMeet.date,this.start=this.editingMeet.start,this.end=this.editingMeet.end,await this.fillFreePlaces(),this.place={name:this.editingMeet.place_name,id:this.editingMeet.place_id,is_private:!1},-1===this.freePlaces.indexOf(this.place)&&this.freePlaces.push(this.place),await this.fillUsers(),await this.fillSelectedUsers()},fillContactsForSelect(e){this.contacts=[{name:"Контактное лицо",id:0}];for(let t in e){const n=e[t].second_name+" "+e[t].first_name+" "+e[t].third_name;this.contacts.push({name:n,id:e[t].id})}},async fillFreePlaces(){const e=await C.getFreePlaces(this.start,this.end,this.date);this.freePlaces=[],this.freePlaces.push({name:"Свободные переговорки",id:0,is_private:!1});let t=!1;for(let n in e)e[n].id===this.place.id&&(t=!0),this.freePlaces.push(e[n]);t||(this.place={})},async fillUsers(){const e=await C.getUsers();this.users=[];for(let t in this.selectedUsersInMeeting)this.users.push(this.selectedUsersInMeeting[t]);for(let t in e){const n=e[t].second_name+" "+e[t].first_name[0]+"."+e[t].third_name[0];this.users.push({name:n,id:e[t].id,direction:null===e[t].direction_name?"":e[t].direction_name})}},async fillSelectedUsers(){const e=new Map;for(let n in this.editingMeet.employee_list)e.set(this.editingMeet.employee_list[n],null);const t=this.users;for(let n in t){const i=t[n].second_name+" "+t[n].first_name+" "+t[n].third_name;e.has(t[n].id)&&e.set(t[n].id,i)}this.selectedUsersInMeeting=[];for(let n in this.users)void 0!==e.get(this.users[n].id)&&this.selectedUsersInMeeting.push(this.users[n])},async touchCancelMeetingButtonHandler(){await C.deleteMeeting(this.editingMeet.id),this.$emit("cancelMeeting",this.editingMeet.id),this.closePopup()},prepareUserForDisplay(e){return e.name+(0!==e.id?"("+e.direction+")":"")}},async mounted(){let e=this;document.addEventListener("click",(function(t){t.target===e.$refs["popup_wrapper"]&&e.closePopup()}));const t=await C.getClients(!0);for(let n in t)this.clients.push(t[n]);this.isCreatePopup?await this.fillUsers():await this.fillDataInputs()},computed:{isCorrectSelectedTime(){if(""===this.start||""===this.end)return!0;const e=new Date,t=this.start.split(":")[0],n=this.start.split(":")[1];e.setHours(Number(t),Number(n));const i=new Date,s=this.end.split(":")[0],a=this.end.split(":")[1];return i.setHours(Number(s),Number(a)),e<i},isCorrectDate(){if(""===this.date)return!0;if(!this.isCreatePopup)return!0;const e=new Date(this.date),t=new Date;return t.setHours(0,0,0,0),e>=t},popupTitle(){return this.isCreatePopup?"Новая встреча":"Редактирование встречи"}}};const At=(0,y.Z)(Vt,[["render",qt],["__scopeId","data-v-bf464cfe"]]);var Yt=At,Kt={components:{AddButton:et,LoadingIndicate:ce,SegmentedControl:at,EditButton:dt,CreateMeet:Yt},data(){return{meetings:[],nearMeeting:void 0,isLoadedMeetings:!1,isCreateMeetMode:!1,displayCreateMeetPopup:!1,displayEditMeetPopup:!1,editingMeet:{}}},async mounted(){this.meetings=await C.getMeetings(),this.meetings.length&&(this.nearMeeting=this.meetings[0],this.prepareMeetingsForDisplay()),this.isLoadedMeetings=!0},methods:{async prepareMeetingsForDisplay(){this.meetings.forEach((e=>{e.start=e.start.substr(0,5),e.end=e.end.substr(0,5)}))},async selectedSegmentedControl(e){if(e)return this.meetings=await C.getMeetings(),void this.prepareMeetingsForDisplay();this.meetings=await C.getMeetings(!0),this.prepareMeetingsForDisplay()},touchCreateMeet(){this.showPopupForMeet()},showPopupForMeet(){this.displayCreateMeetPopup=!0},closeCreatePopup(){this.displayCreateMeetPopup=!1},closeEditPopup(){this.displayEditMeetPopup=!1},displayNewMeeting(e){e.start=e.start.substr(0,5),e.end=e.end.substr(0,5),this.meetings.push(e),this.meetings.length&&(this.nearMeeting=this.meetings[0])},editMeeting(e){this.displayEditMeetPopup=!0,this.editingMeet=e},deleteMeeting(e){this.meetings=this.meetings.filter((t=>t.id!==e)),this.meetings.length?this.nearMeeting=this.meetings[0]:this.newMeeting={}},changeEditedMeeting(e){this.meetings=this.meetings.map((t=>t.id===e.id?e:t)),this.meetings.length&&(this.nearMeeting=this.meetings[0]),this.prepareMeetingsForDisplay()}}};const Rt=(0,y.Z)(Kt,[["render",Re],["__scopeId","data-v-2dedb246"]]);var Qt=Rt,Jt={components:{NavBar:de,meetings:Qt}};const Gt=(0,y.Z)(Jt,[["render",b],["__scopeId","data-v-50463f30"]]);var Xt=Gt;const en=e=>((0,s.dD)("data-v-48251e62"),e=e(),(0,s.Cn)(),e),tn={class:"login-container"},nn=en((()=>(0,s._)("h1",{class:"title"},"Вход в систему",-1))),sn={key:0,class:"validate-error-message",id:"test"},an={key:1,class:"validate-error-message"},on={key:2,class:"validate-error-message"},cn={class:"save-container"},rn=en((()=>(0,s._)("label",{for:"save",class:"save-label"},"Запомнить",-1))),ln={key:3,class:"error-container"};function dn(e,t,n,o,c,r){return(0,s.wg)(),(0,s.iD)("div",tn,[(0,s._)("form",{onSubmit:t[4]||(t[4]=(0,i.iM)((()=>{}),["prevent"]))},[nn,(0,s.wy)((0,s._)("input",{type:"text",id:"login",name:"user_login","onUpdate:modelValue":t[0]||(t[0]=e=>c.username=e),placeholder:"Введите логин...",class:(0,a.C_)({invalid:o.v$.username.$error})},null,2),[[i.nr,c.username]]),o.v$.username.$error?((0,s.wg)(),(0,s.iD)("small",sn," Логин не должен быть пустым! ")):(0,s.kq)("",!0),(0,s.wy)((0,s._)("input",{type:"password",id:"password",name:"user_password","onUpdate:modelValue":t[1]||(t[1]=e=>c.password=e),placeholder:"Введите пароль...",class:(0,a.C_)({invalid:o.v$.password.$error})},null,2),[[i.nr,c.password]]),o.v$.password.$dirty&&o.v$.password.required.$invalid?((0,s.wg)(),(0,s.iD)("small",an," Пароль является обязательным полем! ")):(0,s.kq)("",!0),o.v$.password.minLength.$invalid?((0,s.wg)(),(0,s.iD)("small",on," Длина пароля должна быть больше 3 символов! ")):(0,s.kq)("",!0),(0,s._)("div",cn,[(0,s.wy)((0,s._)("input",{type:"checkbox",id:"save",name:"selected_save","onUpdate:modelValue":t[2]||(t[2]=e=>c.isSavedSession=e)},null,512),[[i.e8,c.isSavedSession]]),rn]),(0,s._)("button",{type:"submit",onClick:t[3]||(t[3]=(...e)=>r.touchLogIn&&r.touchLogIn(...e))},"Далее"),r.isHaveErrorAuth()?((0,s.wg)(),(0,s.iD)("div",ln,(0,a.zw)(this.$store.state.auth.errorMessage),1)):(0,s.kq)("",!0)],32)])}var hn={setup(){return{v$:(0,Zt.ZP)()}},data(){return{username:"",password:"",isSavedSession:!1,passwordPlaceholder:"Введите пароль...",loginPlaceholder:"Введите логин..."}},validations(){return{username:{required:jt.C1},password:{required:jt.C1,minLength:(0,jt.Ei)(4)}}},methods:{...(0,c.nv)(["logIn"]),async touchLogIn(){const e=await this.v$.$validate();if(!e)return;const t=await this.logIn({username:this.username,password:this.password,isSavedSession:this.isSavedSession});t?this.$router.push("/"):this.$router.push("/login")},isHaveErrorAuth(){return""!==this.$store.state.auth.errorMessage},isValidForm(){const e=4;return this.validationErrors=[],!!(this.username.length&&this.password.length>=e)}}};const un=(0,y.Z)(hn,[["render",dn],["__scopeId","data-v-48251e62"]]);var pn=un;const mn={class:"calendar-container"};function gn(e,t,n,i,a,o){const c=(0,s.up)("nav-bar"),r=(0,s.up)("calendar-container");return(0,s.wg)(),(0,s.iD)("div",mn,[(0,s.Wm)(c),(0,s._)("main",null,[(0,s.Wm)(r)])])}const wn={class:"multicheckbox-container"};function vn(e,t,n,i,a,o){const c=(0,s.up)("checkbox");return(0,s.wg)(),(0,s.iD)("div",wn,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(a.options,(e=>((0,s.wg)(),(0,s.j4)(c,{key:e,checked:e.isSelected,"onUpdate:checked":t=>e.isSelected=t,option:e.name,class:"option-item"},null,8,["checked","onUpdate:checked","option"])))),128))])}const Cn=e=>((0,s.dD)("data-v-5d833826"),e=e(),(0,s.Cn)(),e),_n={class:"checkbox-container"},yn=["checked"],fn=Cn((()=>(0,s._)("span",{class:"check-style"},null,-1))),kn={class:"option-content"};function Dn(e,t,n,i,o,c){return(0,s.wg)(),(0,s.iD)("label",_n,[(0,s._)("input",{onInput:t[0]||(t[0]=t=>e.$emit("update:checked",t.target.checked)),type:"checkbox",checked:n.checked,class:"checkbox"},null,40,yn),fn,(0,s._)("span",kn,(0,a.zw)(n.option),1)])}var bn={props:{option:String,checked:{type:Boolean}}};const Mn=(0,y.Z)(bn,[["render",Dn],["__scopeId","data-v-5d833826"]]);var Pn=Mn,Sn={components:{Checkbox:Pn},props:{dataOptions:{type:Array,default:[]}},data(){return{options:this.dataOptions}}};const In=(0,y.Z)(Sn,[["render",vn],["__scopeId","data-v-b1b2225a"]]);var $n=In;const Hn=e=>((0,s.dD)("data-v-68174d36"),e=e(),(0,s.Cn)(),e),Ln={class:"calendar-main-container"},Tn=Hn((()=>(0,s._)("h1",null,"Календарь",-1))),Bn={class:"calendar-header-level"},En=Hn((()=>(0,s._)("div",{class:"blank-space"},null,-1))),Fn={class:"calendar-body-level"},Un={class:"blank-mini-calendar"},xn={class:"slice-container"};function Wn(e,t,n,i,a,o){const c=(0,s.up)("calendar-header"),r=(0,s.up)("meet-places"),l=(0,s.up)("calendar-day-slice"),d=(0,s.up)("calendar-week-slice"),h=(0,s.up)("calendar-month-slice");return(0,s.wg)(),(0,s.iD)("div",Ln,[Tn,(0,s._)("div",Bn,[En,(0,s.Wm)(c,{class:"calendar-header",onSwitchSlice:o.showSelectedSlice,onSelectedDate:o.handleSelectDate},null,8,["onSwitchSlice","onSelectedDate"])]),(0,s._)("div",Fn,[(0,s._)("div",Un,[(0,s.Wm)(r,{onTakePlace:o.handleTakePlace},null,8,["onTakePlace"])]),(0,s._)("div",xn,[a.isPressedDayBtn?((0,s.wg)(),(0,s.j4)(l,{key:0,class:"day-slice-container","selected-place":a.selectedPlace,"selected-date":a.selectedDate},null,8,["selected-place","selected-date"])):(0,s.kq)("",!0),a.isPressedWeekBtn?((0,s.wg)(),(0,s.j4)(d,{key:1})):(0,s.kq)("",!0),a.isPressedMonthBtn?((0,s.wg)(),(0,s.j4)(h,{key:2})):(0,s.kq)("",!0)])])])}const Nn=e=>((0,s.dD)("data-v-170d124a"),e=e(),(0,s.Cn)(),e),On={class:"day-container",ref:"gridLine"},zn={class:"grid-container"},qn={class:"row-cell-container"},jn=["onClick"],Zn={class:"topic-meeting-event"},Vn={class:"place-meeting-event"},An={class:"current-time"},Yn={class:"red-point",ref:"redPoint"},Kn=Nn((()=>(0,s._)("div",{class:"red-line"},null,-1)));function Rn(e,t,n,o,c,r){const l=(0,s.up)("event-tooltip");return(0,s.wg)(),(0,s.iD)("div",On,[(0,s._)("ul",zn,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(this.cells,(e=>((0,s.wg)(),(0,s.iD)("li",{class:"grid-row",ref_for:!0,ref:"infoBox",key:e},[(0,s._)("div",qn,[(0,s._)("div",{class:"divider-cell-line-container",ref_for:!0,ref:"forStartCalculate"},[(0,s.wy)((0,s._)("span",{class:"time-item",ref_for:!0,ref:"lineTime"},(0,a.zw)(r.prepareHoursForDisplay(e)),513),[[i.F8,!c.hideTimeInLine.get(e)]]),(0,s._)("div",{class:"divider-cell-line",ref_for:!0,ref:"dividerLine"},null,512)],512)]),void 0!==c.meetingEvents.get(e)?((0,s.wg)(),(0,s.iD)("div",{key:0,onClick:t=>r.pressedOnMeetingEvent(c.meetingEvents.get(e)),class:"meeting-event-element",style:(0,a.j5)({top:c.meetingEvents.get(e)["start-coordinate"],height:c.meetingEvents.get(e)["end-coordinate"]})},[(0,s.Wm)(l,{"is-show":r.showTooltipForMeetingEvent(e),event:c.meetingEvents.get(e)},{default:(0,s.w5)((()=>[(0,s._)("label",Zn,(0,a.zw)(c.meetingEvents.get(e).topic),1),(0,s._)("label",Vn,(0,a.zw)(c.meetingEvents.get(e).place_name),1)])),_:2},1032,["is-show","event"])],12,jn)):(0,s.kq)("",!0)])))),128)),r.isToday?((0,s.wg)(),(0,s.iD)("li",{class:"red-line-container",style:(0,a.j5)({top:r.getRedLinePosition()}),key:c.updateRedLineComponent},[(0,s._)("label",An,(0,a.zw)(r.displayCurrentTime()),1),(0,s._)("div",Yn,null,512),Kn],4)):(0,s.kq)("",!0)])],512)}const Qn=6e4,Jn=e=>((0,s.dD)("data-v-1dff1371"),e=e(),(0,s.Cn)(),e),Gn={class:"tooltip-wrapper"},Xn={key:0,class:"tooltip-element"},ei=Jn((()=>(0,s._)("div",{class:"tooltip-header"},null,-1))),ti=Jn((()=>(0,s._)("div",{class:"tooltip-content-header"},null,-1))),ni={class:"tooltip-content"},ii={class:"content-title-container"},si={class:"content-title"},ai={class:"event-date-container"},oi={class:"start time"},ci={class:"event-date"},ri={class:"end time"},li={class:"event-place"},di={class:"event-creater"};function hi(e,t,n,i,o,c){return(0,s.wg)(),(0,s.iD)("div",Gn,[(0,s.WI)(e.$slots,"default",{},void 0,!0),n.isShow?((0,s.wg)(),(0,s.iD)("div",Xn,[ei,ti,(0,s._)("div",ni,[(0,s._)("div",ii,[(0,s._)("label",si,(0,a.zw)(n.event.topic),1)]),(0,s._)("div",ai,[(0,s._)("label",oi,(0,a.zw)(c.deleteSecondsInTime(n.event.start)),1),(0,s._)("label",ci,(0,a.zw)(n.event.date.toLocaleDateString())+",",1),(0,s._)("label",ri,(0,a.zw)(c.getWeekDay(n.event.date))+" - "+(0,a.zw)(c.deleteSecondsInTime(n.event.end)),1)]),(0,s._)("label",li,(0,a.zw)(n.event.place_name),1),(0,s._)("label",di,(0,a.zw)(n.event.creator_name),1)])])):(0,s.kq)("",!0)])}var ui={name:"EventTooltip",props:{event:{type:Object,default:{}},isShow:{type:Boolean,default:!1}},data(){return{}},mounted(){this.event.date=new Date(this.event.date)},methods:{getWeekDay(e){const t={"понедельник":"Пн","вторник":"Вт","среда":"Ср","четверг":"Чт","пятница":"Пт","суббота":"Сб","воскресенье":"Вс"},n={weekday:"long"};let i=e.toLocaleString("ru",n);return t[i]},deleteSecondsInTime(e){return e.slice(0,5)}}};const pi=(0,y.Z)(ui,[["render",hi],["__scopeId","data-v-1dff1371"]]);var mi=pi,gi={name:"CalendarDaySlice",components:{EventTooltip:mi},props:{selectedPlace:{type:Object,default:{id:1}},selectedDate:{type:Date,default:new Date}},data(){return{gridLineHeight:0,dividerLineDivHeight:0,redPointHeight:0,dividerLineHeight:0,cells:[],meetingEvents:new Map,updateRedLineComponent:0,hideTimeInLine:new Map,now:new Date,showTooltipForSelectedEvent:new Map}},created(){window.setInterval((()=>{this.updateRedLineComponent+=1,this.now=new Date}),Qn)},async mounted(){this.createTimeGrid();let e=await C.getMeetingsByDate(this.selectedDate);this.setHideTimeInLineMap(),await this.$nextTick((function(){this.gridLineHeight=this.getClientHeight(this.$refs.infoBox[0]),this.dividerLineDivHeight=this.getClientHeight(this.$refs.forStartCalculate[0]),this.redPointHeight=this.getClientHeight(this.$refs.redPoint),this.dividerLineHeight=this.getClientHeight(this.$refs.dividerLine[0]),this.now=new Date,this.handleMeetingEvents(e),this.scrollToStartWorkTime()})),this.meetingEvents.forEach((e=>this.showTooltipForSelectedEvent.set(e.id,!1)))},methods:{createTimeGrid(){for(let e=0;e<24;e++)this.cells.push(e)},handleMeetingEvents(e){e.forEach((e=>{let t=e.start.slice(0,2),n="0"===t[0]?+t[1]:+t;e["start-coordinate"]=this.calculateStartCoordinateForEvent(e.start),e["end-coordinate"]=this.calculateEndCoordinateForEvent(e.start,e.end),this.meetingEvents.set(n,e)}))},getClientHeight(e){return e.clientHeight},calculateStartCoordinateForEvent(e){e=this.deleteSecondsInTime(e);let t=+e.slice(3,e.length);return String(t/60*100-100+100*this.getStartOffsetByDividerLineInPercent())+"%"},calculateEndCoordinateForEvent(e,t){e=this.deleteSecondsInTime(e),t=this.deleteSecondsInTime(t);const n=+e.slice(0,2),i=+e.slice(3,e.length),s=+t.slice(0,2),a=+t.slice(3,t.length),o=new Date;o.setHours(n),o.setMinutes(i);const c=new Date;c.setHours(s),c.setMinutes(a);const r=(c-o)/1e3/60/60,l=r*this.gridLineHeight;return String(l)+"px"},deleteSecondsInTime(e){return e.slice(0,e.length-3)},scrollToStartWorkTime(){this.$refs.gridLine.scrollTop=this.$refs.gridLine.scrollHeight/3-this.dividerLineDivHeight/2},getRedLinePosition(){const e=new Date;e.setHours(0,0,0,0);const t=new Date;let n=100*(t-e)/1e3/60/60/24;return n+=100*this.getStartOffsetByDividerLineInPercent()/24,n-=100*this.getOffsetForRedLineByRedCircle()/24,String(n)+"%"},prepareHoursForDisplay(e){return e<10?"0"+e+":00":e+":00"},getStartOffsetByDividerLineInPercent(){return(this.dividerLineDivHeight-this.dividerLineHeight)/this.gridLineHeight/2},getOffsetForRedLineByRedCircle(){return this.redPointHeight/this.gridLineHeight/2},displayCurrentTime(){const e=new Date,t=e.getHours(),n=e.getMinutes(),i=t<10?"0"+String(t):String(t),s=n<10?"0"+String(n):String(n);return i+":"+s},setHideTimeInLineMap(){this.hideTimeInLine.clear();for(let e=0;e<24;e++)this.hideTimeInLine.set(e,!1)},hideTimeWhenIntersectWithTimeInRedLine(e){e.getHours()+1!==24&&this.isToday&&(e.getMinutes()>=50?this.hideTimeInLine.set(e.getHours()+1,!0):e.getMinutes()<=10?this.hideTimeInLine.set(e.getHours(),!0):this.hideTimeInLine.set(e.getHours(),!1))},pressedOnMeetingEvent(e){const t=!this.showTooltipForSelectedEvent.get(e.id);this.showTooltipForSelectedEvent.set(e.id,t)},showTooltipForMeetingEvent(e){const t=this.meetingEvents.get(e);return this.showTooltipForSelectedEvent.get(t.id)}},watch:{async selectedDate(e){let t=await C.getMeetingsByDate(e);this.meetingEvents.clear(),this.handleMeetingEvents(t),this.now=new Date,this.isToday||this.setHideTimeInLineMap()},async selectedPlace(e){let t=await C.getMeetingsInPlaceByDate(this.selectedDate,e);this.meetingEvents.clear(),this.handleMeetingEvents(t)},now(e){this.hideTimeWhenIntersectWithTimeInRedLine(e)}},computed:{isToday(){let e=this.selectedDate;e.setHours(0,0,0,0);let t=new Date;return t.setHours(0,0,0,0),e-t===0}}};const wi=(0,y.Z)(gi,[["render",Rn],["__scopeId","data-v-170d124a"]]);var vi=wi;const Ci=e=>((0,s.dD)("data-v-2535a8c4"),e=e(),(0,s.Cn)(),e),_i={class:"week-container"},yi=Ci((()=>(0,s._)("h1",null,"Week-container",-1))),fi=[yi];function ki(e,t,n,i,a,o){return(0,s.wg)(),(0,s.iD)("div",_i,fi)}var Di={name:"CalendarWeekSlice"};const bi=(0,y.Z)(Di,[["render",ki],["__scopeId","data-v-2535a8c4"]]);var Mi=bi;const Pi=e=>((0,s.dD)("data-v-1bb64320"),e=e(),(0,s.Cn)(),e),Si={class:"month-container"},Ii=Pi((()=>(0,s._)("h1",null,"Month-container",-1))),$i=[Ii];function Hi(e,t,n,i,a,o){return(0,s.wg)(),(0,s.iD)("div",Si,$i)}var Li={name:"CalendarMonthSlice"};const Ti=(0,y.Z)(Li,[["render",Hi],["__scopeId","data-v-1bb64320"]]);var Bi=Ti;const Ei=e=>((0,s.dD)("data-v-442b9e48"),e=e(),(0,s.Cn)(),e),Fi={class:"calendar-header-container"},Ui={class:"calendar-header-btns"},xi={class:"select-time-container"},Wi={class:"selected-date"},Ni=Ei((()=>(0,s._)("div",{class:"design-line-element"},null,-1)));function Oi(e,t,n,i,o,c){return(0,s.wg)(),(0,s.iD)("div",Fi,[(0,s._)("div",Ui,[(0,s._)("button",{class:"today-btn",onClick:t[0]||(t[0]=(...e)=>c.pressTodayBtn&&c.pressTodayBtn(...e))},"Сегодня"),(0,s._)("button",{class:(0,a.C_)(["day-btn slice",{activate:this.isPressedDayBtn}]),onClick:t[1]||(t[1]=(...e)=>c.pressDayBtn&&c.pressDayBtn(...e))},"День",2),(0,s._)("button",{class:(0,a.C_)(["week-btn slice",{activate:this.isPressedWeekBtn}]),onClick:t[2]||(t[2]=(...e)=>c.pressWeekBtn&&c.pressWeekBtn(...e))},"Неделя",2),(0,s._)("button",{class:(0,a.C_)(["month-btn slice",{activate:this.isPressedMonthBtn}]),onClick:t[3]||(t[3]=(...e)=>c.pressMonthBtn&&c.pressMonthBtn(...e))},"Месяц",2),(0,s._)("div",xi,[(0,s._)("label",Wi,(0,a.zw)(this.formatDate(o.selectedDate)),1),(0,s._)("i",{class:"material-icons prev-date-btn",onClick:t[4]||(t[4]=e=>c.selectedNewDate(-1))}," arrow_back_ios "),(0,s._)("i",{class:"material-icons next-date-btn",onClick:t[5]||(t[5]=e=>c.selectedNewDate())}," arrow_forward_ios ")])]),Ni])}var zi={name:"CalendarHeader",data(){return{isPressedDayBtn:!0,isPressedWeekBtn:!1,isPressedMonthBtn:!1,selectedDate:new Date}},mounted(){this.$emit("switchSlice",this.sliceState)},methods:{activateSliceBtn(e={day:!1,week:!1,month:!1}){this.isPressedMonthBtn=e.month,this.isPressedWeekBtn=e.week,this.isPressedDayBtn=e.day},pressDayBtn(){this.isPressedDayBtn=!this.isPressedDayBtn,this.activateSliceBtn({day:!0,month:!1,week:!1}),this.$emit("switchSlice",this.sliceState)},pressWeekBtn(){this.isPressedWeekBtn=!this.isPressedWeekBtn,this.activateSliceBtn({day:!1,week:!0,month:!1}),this.$emit("switchSlice",this.sliceState)},pressMonthBtn(){this.isPressedMonthBtn=!this.isPressedMonthBtn,this.activateSliceBtn({day:!1,week:!1,month:!0}),this.$emit("switchSlice",this.sliceState)},pressTodayBtn(){this.isPressedDayBtn=!0,this.activateSliceBtn({day:!0,month:!1,week:!1}),this.selectedDate=new Date,this.$emit("switchSlice",this.sliceState),this.$emit("selectedDate",this.selectedDate)},selectedNewDate(e=1){let t=this.selectedDate;t.setDate(t.getDate()+e),this.selectedDate=new Date(t),this.$emit("selectedDate",this.selectedDate)},formatDate(e){let t={year:"numeric",month:"long",day:"numeric"};return e.toLocaleString("ru",t)}},computed:{sliceState(){return{isPressedDayBtn:this.isPressedDayBtn,isPressedWeekBtn:this.isPressedWeekBtn,isPressedMonthBtn:this.isPressedMonthBtn,selectedDate:this.selectedDate}}}};const qi=(0,y.Z)(zi,[["render",Oi],["__scopeId","data-v-442b9e48"]]);var ji=qi;const Zi={class:"meet-places"},Vi={class:"meet-places-list"},Ai=["onClick"];function Yi(e,t,n,i,o,c){const r=(0,s.up)("loading-indicate");return(0,s.wg)(),(0,s.iD)("div",Zi,[(0,s._)("ul",Vi,[o.places.length?(0,s.kq)("",!0):((0,s.wg)(),(0,s.j4)(r,{key:0})),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(o.places,(e=>((0,s.wg)(),(0,s.iD)("li",{key:e,class:"meet-place-item"},[(0,s._)("button",{onClick:t=>c.takePlace(e),class:"meet-place-item-button"},(0,a.zw)(e.name),9,Ai)])))),128))])])}var Ki={components:{LoadingIndicate:ce},data(){return{places:[]}},async created(){this.places=await C.getPlaces()},methods:{takePlace(e){this.$emit("takePlace",e)}}};const Ri=(0,y.Z)(Ki,[["render",Yi],["__scopeId","data-v-d3e2eb68"]]);var Qi=Ri,Ji={name:"CalendarContainer",components:{CalendarDaySlice:vi,CalendarWeekSlice:Mi,CalendarMonthSlice:Bi,CalendarHeader:ji,MeetPlaces:Qi},data(){return{isPressedDayBtn:!1,isPressedWeekBtn:!1,isPressedMonthBtn:!1,selectedPlace:{},selectedDate:new Date}},methods:{showSelectedSlice(e){this.isPressedDayBtn=e.isPressedDayBtn,this.isPressedMonthBtn=e.isPressedMonthBtn,this.isPressedWeekBtn=e.isPressedWeekBtn},handleTakePlace(e){this.selectedPlace=e},handleSelectDate(e){this.selectedDate=e}}};const Gi=(0,y.Z)(Ji,[["render",Wn],["__scopeId","data-v-68174d36"]]);var Xi=Gi,es={components:{NavBar:de,LoadingIndicate:ce,MultiCheckbox:$n,CalendarContainer:Xi},data(){return{}},async mounted(){}};const ts=(0,y.Z)(es,[["render",gn],["__scopeId","data-v-f680bf2c"]]);var ns=ts;const is=e=>((0,s.dD)("data-v-1861f258"),e=e(),(0,s.Cn)(),e),ss={class:"wrapper"},as={class:"list-checkbox"},os=is((()=>(0,s._)("h1",null,"Список клиентов",-1))),cs={class:"checkbox"},rs={class:"display"},ls=is((()=>(0,s._)("label",{for:"highload1","data-onlabel":"","data-offlabel":"",class:"lb1"},null,-1))),ds={action:"",class:"search-form"},hs=is((()=>(0,s._)("img",{src:"/svg/search.svg",alt:"",class:"search-icon"},null,-1))),us={key:0,class:"client-list-container"},ps={class:"clients-container"},ms={key:0,class:"clients-list"},gs={key:1,class:"clients-list empty"},ws=is((()=>(0,s._)("li",{class:"clients-item clients-item-empty"},[(0,s._)("span",{class:"empty-message"},"Нет клиентов")],-1))),vs=[ws],Cs=(0,s.Uk)("Добавить нового клиента"),_s={class:"popup-title"},ys={class:"company-name-container"},fs={key:0,class:"validate-error-message"},ks={class:"company-inn-container"},Ds={key:0,class:"validate-error-message"},bs={key:1,class:"validate-error-message"},Ms={class:"directions-container"},Ps=is((()=>(0,s._)("div",{class:"multicheckbox-title-container"},[(0,s._)("label",{class:"multicheckbox-title"},"Выбрать менеджера")],-1))),Ss={key:0,class:"validate-error-message"},Is={class:"popup-title"},$s={class:"contact-name-container first-name"},Hs={key:0,class:"validate-error-message"},Ls={class:"contact-name-container second-name"},Ts={key:0,class:"validate-error-message"},Bs={class:"contact-name-container third-name"},Es={class:"contact-phone-container"},Fs={class:"contact-position-container"},Us={class:"contact-email-container"},xs={key:0,class:"validate-error-message"};function Ws(e,t,n,o,c,r){const l=(0,s.up)("nav-bar"),d=(0,s.up)("client"),h=(0,s.up)("add-button"),u=(0,s.up)("loading-indicate"),p=(0,s.up)("multicheckbox"),m=(0,s.up)("popup");return(0,s.wg)(),(0,s.iD)("div",ss,[(0,s.Wm)(l),(0,s._)("main",null,[(0,s._)("div",as,[os,(0,s._)("div",cs,[(0,s._)("h3",rs,(0,a.zw)(r.checkboxTitle),1),(0,s._)("input",{type:"checkbox",name:"highload1",id:"highload1",onClick:t[0]||(t[0]=(...e)=>r.touchCheckbox&&r.touchCheckbox(...e)),checked:""}),ls])]),(0,s._)("form",ds,[(0,s.wy)((0,s._)("input",{type:"text",class:"search-input","onUpdate:modelValue":t[1]||(t[1]=e=>c.searchQuery=e),placeholder:""},null,512),[[i.nr,c.searchQuery]]),hs]),c.isLoadedClientsFromApi?((0,s.wg)(),(0,s.iD)("div",us,[(0,s._)("div",ps,[c.clients.length?((0,s.wg)(),(0,s.iD)("ul",ms,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(r.searchedClients,(e=>((0,s.wg)(),(0,s.iD)("li",{key:e,class:"client-item"},[(0,s.Wm)(d,{clientData:e,onEdit:r.touchEditClient,onCreate:r.touchCreateContact,onEditContact:r.touchEditContact,newContact:r.prepareNewContactForChildComponent(e.id)},null,8,["clientData","onEdit","onCreate","onEditContact","newContact"])])))),128))])):((0,s.wg)(),(0,s.iD)("ul",gs,vs))]),(0,s.Wm)(h,{class:"add-button",onClick:r.touchCreateClient},{default:(0,s.w5)((()=>[Cs])),_:1},8,["onClick"])])):((0,s.wg)(),(0,s.j4)(u,{key:1})),c.displayClientPopup?((0,s.wg)(),(0,s.j4)(m,{key:2,onClosePopup:r.closePopupForClient,class:"client__modal-window"},{header:(0,s.w5)((()=>[(0,s._)("span",_s,(0,a.zw)(r.clientPopupTitle),1)])),content:(0,s.w5)((()=>[(0,s._)("div",ys,[(0,s.wy)((0,s._)("input",{type:"text",class:(0,a.C_)(["company-name-input",{invalid:o.v$.newClientName.$error}]),placeholder:"Имя клиента","onUpdate:modelValue":t[2]||(t[2]=e=>c.newClientName=e)},null,2),[[i.nr,c.newClientName]]),o.v$.newClientName.$error?((0,s.wg)(),(0,s.iD)("small",fs," Имя клиента не должно быть пустым! ")):(0,s.kq)("",!0)]),(0,s._)("div",ks,[(0,s.wy)((0,s._)("input",{type:"text",class:(0,a.C_)(["company-inn-input",{invalid:o.v$.newClientInn.$error}]),placeholder:"ИНН","onUpdate:modelValue":t[3]||(t[3]=e=>c.newClientInn=e)},null,2),[[i.nr,c.newClientInn]]),o.v$.newClientInn.$dirty&&o.v$.newClientInn.required.$invalid?((0,s.wg)(),(0,s.iD)("small",Ds," ИНН является обязательным полем! ")):(0,s.kq)("",!0),o.v$.newClientInn.minLength.$invalid||o.v$.newClientInn.maxLength.$invalid?((0,s.wg)(),(0,s.iD)("small",bs," Длина ИНН должна быть длиной 12 символов! ")):(0,s.kq)("",!0)]),(0,s._)("div",Ms,[Ps,(0,s.Wm)(p,{dataOptions:c.users,class:"directions-list"},null,8,["dataOptions"])])])),footer:(0,s.w5)((()=>[(0,s.Wm)(h,{class:"popup-footer-btn",onClick:r.clientPopupActionHandler},{default:(0,s.w5)((()=>[(0,s.Uk)((0,a.zw)(r.popupButtonTitle),1)])),_:1},8,["onClick"]),c.isExistClient?((0,s.wg)(),(0,s.iD)("small",Ss," Клиент с таким ИНН уже существует! ")):(0,s.kq)("",!0)])),_:1},8,["onClosePopup"])):(0,s.kq)("",!0),c.displayContactPopup?((0,s.wg)(),(0,s.j4)(m,{key:3,onClosePopup:r.closePopupForContact,class:"contact__modal-window"},{header:(0,s.w5)((()=>[(0,s._)("span",Is,(0,a.zw)(r.contactPopupTitle),1)])),content:(0,s.w5)((()=>[(0,s._)("div",$s,[(0,s.wy)((0,s._)("input",{type:"text",class:(0,a.C_)(["contact-name-input",{invalid:o.v$.newContactFirstName.$error}]),placeholder:"Имя","onUpdate:modelValue":t[4]||(t[4]=e=>c.newContactFirstName=e)},null,2),[[i.nr,c.newContactFirstName]]),o.v$.newContactFirstName.$error?((0,s.wg)(),(0,s.iD)("small",Hs," Имя контакта не должно быть пустым! ")):(0,s.kq)("",!0)]),(0,s._)("div",Ls,[(0,s.wy)((0,s._)("input",{type:"text",class:(0,a.C_)(["contact-name-input",{invalid:o.v$.newContactSecondName.$error}]),placeholder:"Фамилия","onUpdate:modelValue":t[5]||(t[5]=e=>c.newContactSecondName=e)},null,2),[[i.nr,c.newContactSecondName]]),o.v$.newContactSecondName.$error?((0,s.wg)(),(0,s.iD)("small",Ts," Фамилия контакта не должна быть пустой! ")):(0,s.kq)("",!0)]),(0,s._)("div",Bs,[(0,s.wy)((0,s._)("input",{type:"text",class:"contact-name-input",placeholder:"Отчество","onUpdate:modelValue":t[6]||(t[6]=e=>c.newContactThirdName=e)},null,512),[[i.nr,c.newContactThirdName]])]),(0,s._)("div",Es,[(0,s.wy)((0,s._)("input",{type:"text",class:"contact-phone-input",placeholder:"Телефон","onUpdate:modelValue":t[7]||(t[7]=e=>c.newContactPhone=e)},null,512),[[i.nr,c.newContactPhone]])]),(0,s._)("div",Fs,[(0,s.wy)((0,s._)("input",{type:"text",class:"contact-position-input",placeholder:"Должность","onUpdate:modelValue":t[8]||(t[8]=e=>c.newContactPosition=e)},null,512),[[i.nr,c.newContactPosition]])]),(0,s._)("div",Us,[(0,s.wy)((0,s._)("input",{type:"text",class:"contact-email-input",placeholder:"Почта","onUpdate:modelValue":t[9]||(t[9]=e=>c.newContactEmail=e)},null,512),[[i.nr,c.newContactEmail]])])])),footer:(0,s.w5)((()=>[(0,s.Wm)(h,{class:"popup-footer-btn",onClick:r.contactPopupActionHandler},{default:(0,s.w5)((()=>[(0,s.Uk)((0,a.zw)(r.popupButtonTitle),1)])),_:1},8,["onClick"]),c.isExistContact?((0,s.wg)(),(0,s.iD)("small",xs," Контакт с таким именем и клиентом уже существует! ")):(0,s.kq)("",!0)])),_:1},8,["onClosePopup"])):(0,s.kq)("",!0)])])}n(6699);const Ns=e=>((0,s.dD)("data-v-9ccc5ff4"),e=e(),(0,s.Cn)(),e),Os={class:"client-container"},zs=Ns((()=>(0,s._)("div",{class:"client-icon-container"},[(0,s._)("img",{class:"client-icon",src:"/svg/client-icon.svg"})],-1))),qs={class:"client-name"},js={class:"client-name-content"},Zs={class:"client-inn"},Vs={class:"client-inn-content"},As={class:"header-buttons"},Ys={class:"direction-list"},Ks=["onClick"],Rs={key:1,class:"direction-users-list-container"},Qs={key:0,class:"direction-users-list"},Js=Ns((()=>(0,s._)("div",{class:"divider"},null,-1))),Gs={key:1,class:"direction-users-list"},Xs=Ns((()=>(0,s._)("div",{class:"divider"},null,-1))),ea={key:2,class:"contact-list-container"},ta={key:0,class:"contact-list"},na={key:1,class:"contact-list"};function ia(e,t,n,o,c,r){const l=(0,s.up)("edit-button"),d=(0,s.up)("show-info-btn"),h=(0,s.up)("client-history"),u=(0,s.up)("direction-user"),p=(0,s.up)("contact");return(0,s.wg)(),(0,s.iD)("div",Os,[(0,s._)("div",{class:"client",onClick:t[2]||(t[2]=(...e)=>r.touchClientInfoButton&&r.touchClientInfoButton(...e))},[zs,(0,s._)("div",qs,[(0,s._)("p",js,(0,a.zw)(c.client.name),1)]),(0,s._)("div",Zs,[(0,s._)("p",Vs,"ИНН: "+(0,a.zw)(c.client.inn),1)]),(0,s._)("div",As,[(0,s.Wm)(l,{class:"edit-btn",onClick:r.editClient},null,8,["onClick"]),(0,s._)("button",{class:"create-contact-btn",onClick:t[0]||(t[0]=(...e)=>r.touchCreateContact&&r.touchCreateContact(...e))}),(0,s._)("button",{class:"show-client-history",onClick:t[1]||(t[1]=(...e)=>r.touchShowCLientHistory&&r.touchShowCLientHistory(...e))}," Встречи "),(0,s.Wm)(d,{class:"show-info-btn",showInfo:c.isShowContactList},null,8,["showInfo"])])]),c.isShowClientHistory?((0,s.wg)(),(0,s.j4)(h,{key:0,onClose:r.closeHistory},null,8,["onClose"])):(0,s.kq)("",!0),(0,s.wy)((0,s._)("ul",Ys,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(c.directions,(e=>((0,s.wg)(),(0,s.iD)("li",{key:e,class:"direction-item"},[(0,s._)("button",{class:"direction-segment",onClick:t=>r.showUsersByDirection(e)},(0,a.zw)(e.name),9,Ks)])))),128))],512),[[i.F8,c.isShowContactList]]),-1!==c.selectedDirection?((0,s.wg)(),(0,s.iD)("div",Rs,[c.directionUsers.length?((0,s.wg)(),(0,s.iD)("ul",Qs,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(c.directionUsers,(e=>((0,s.wg)(),(0,s.iD)("li",{class:"direction-users-item",key:e},[(0,s.Wm)(u,{directionUserData:e},null,8,["directionUserData"])])))),128)),Js])):((0,s.wg)(),(0,s.iD)("ul",Gs,[(0,s.Wm)(u),Xs]))])):(0,s.kq)("",!0),c.isShowContactList?((0,s.wg)(),(0,s.iD)("div",ea,[r.allContacts.length?((0,s.wg)(),(0,s.iD)("ul",ta,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(r.allContacts,(e=>((0,s.wg)(),(0,s.iD)("li",{class:"contact-item",key:e},[(0,s.Wm)(p,{contactData:e,onEdit:t=>r.touchEditContact(e)},null,8,["contactData","onEdit"])])))),128))])):((0,s.wg)(),(0,s.iD)("ul",na,[(0,s.Wm)(p)]))])):(0,s.kq)("",!0)])}const sa=e=>((0,s.dD)("data-v-659f6a41"),e=e(),(0,s.Cn)(),e),aa={class:"contact-item__header"},oa={class:"contact-name"},ca={class:"contact-name-content"},ra={class:"header-buttons"},la={key:0,class:"contact-details__content"},da={class:"contact-email"},ha={class:"contact-email-content"},ua={class:"drop"},pa=sa((()=>(0,s._)("p",{class:"copy-true"},"Скопированно",-1))),ma={class:"contact-position"},ga={class:"contact-position-content"},wa={class:"contact-number"},va={class:"contact-number-content"},Ca={key:1,class:"contact-item empty"},_a=sa((()=>(0,s._)("span",null,"Нет контактов",-1))),ya=[_a];function fa(e,t,n,i,o,c){const r=(0,s.up)("edit-button"),l=(0,s.up)("show-info-btn");return void 0!==this.contact?((0,s.wg)(),(0,s.iD)("div",{key:0,class:"contact-item",onClick:t[3]||(t[3]=(...e)=>c.touchContactInfoButton&&c.touchContactInfoButton(...e))},[(0,s._)("div",aa,[(0,s._)("div",oa,[(0,s._)("span",ca,(0,a.zw)(o.contact.first_name)+" "+(0,a.zw)(o.contact.second_name)+" "+(0,a.zw)(o.contact.third_name),1)]),(0,s._)("div",ra,[(0,s.Wm)(r,{onClick:c.editContact},null,8,["onClick"]),(0,s.Wm)(l,{class:"show-info-btn",showInfo:o.showContactInfo},null,8,["showInfo"])])]),o.showContactInfo?((0,s.wg)(),(0,s.iD)("div",la,[(0,s._)("div",da,[(0,s._)("p",ha,"Почта: "+(0,a.zw)(o.contact.email),1),(0,s._)("div",ua,[(0,s._)("i",{class:"material-icons copy-btn qwe",onClick:t[0]||(t[0]=e=>c.copyContentToBuffer(o.contact.email))}," content_copy "),pa])]),(0,s._)("div",ma,[(0,s._)("p",ga," Должность: "+(0,a.zw)(o.contact.position),1),(0,s._)("i",{class:"material-icons copy-btn",onClick:t[1]||(t[1]=e=>c.copyContentToBuffer(o.contact.position))}," content_copy ")]),(0,s._)("div",wa,[(0,s._)("p",va,"Телефон: "+(0,a.zw)(o.contact.phone),1),(0,s._)("i",{class:"material-icons copy-btn",onClick:t[2]||(t[2]=e=>c.copyContentToBuffer(o.contact.phone))}," content_copy ")])])):(0,s.kq)("",!0)])):((0,s.wg)(),(0,s.iD)("div",Ca,ya))}const ka={class:"show-info"},Da={class:"show-info-content"};function ba(e,t,n,i,o,c){return(0,s.wg)(),(0,s.iD)("div",ka,[(0,s._)("button",Da,(0,a.zw)(c.buttonTitle),1)])}var Ma={props:{showInfo:{type:Boolean,default:!1}},computed:{buttonTitle:function(){return this.showInfo?"Скрыть":"Подробнее"}},data(){return{}}};const Pa=(0,y.Z)(Ma,[["render",ba],["__scopeId","data-v-15611764"]]);var Sa=Pa,Ia={components:{ShowInfoBtn:Sa,EditButton:dt},data(){return{showContactInfo:!1,contact:this.contactData}},props:{contactData:{type:Object,default:void 0}},methods:{touchContactInfoButton(){this.showContactInfo=!this.showContactInfo},async editContact(){this.$emit("edit",this.contact)},copyContentToBuffer(e){navigator.clipboard.writeText(null===e?"":e)}}};const $a=(0,y.Z)(Ia,[["render",fa],["__scopeId","data-v-659f6a41"]]);var Ha=$a;const La=e=>((0,s.dD)("data-v-61a1c5ba"),e=e(),(0,s.Cn)(),e),Ta={class:"client-history-container"},Ba={class:"close-container"},Ea=La((()=>(0,s._)("p",null,"x",-1))),Fa=[Ea],Ua={key:0,class:"history-list-container"},xa={key:0,class:"client-history-list"},Wa={class:"history-item-number"},Na={class:"history-item-date"},Oa={class:"history-item-meeting-topic"},za={key:1,class:"client-history-list empty"},qa=La((()=>(0,s._)("li",{class:"history-list-item empty-item"},"История пуста...",-1))),ja=[qa];function Za(e,t,n,i,o,c){const r=(0,s.up)("loading-indicate");return(0,s.wg)(),(0,s.iD)("div",Ta,[(0,s._)("div",Ba,[(0,s._)("button",{class:"close-btn",onClick:t[0]||(t[0]=(...e)=>c.closeHistory&&c.closeHistory(...e))},Fa)]),o.isLoadedData?((0,s.wg)(),(0,s.iD)("div",Ua,[o.historyList.length?((0,s.wg)(),(0,s.iD)("ul",xa,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(o.historyList,(e=>((0,s.wg)(),(0,s.iD)("li",{class:"history-list-item",key:e},[(0,s._)("span",Wa,(0,a.zw)(this.historyList.indexOf(e)+1)+".",1),(0,s._)("span",Na,(0,a.zw)(e.date),1),(0,s._)("span",Oa,(0,a.zw)(e.topic),1)])))),128))])):((0,s.wg)(),(0,s.iD)("ul",za,ja))])):((0,s.wg)(),(0,s.j4)(r,{key:1,class:"loading-indicate"}))])}var Va={components:{LoadingIndicate:ce},data(){return{historyList:[],isLoadedData:!1}},async mounted(){this.isLoadedData=!0},methods:{closeHistory(){this.$emit("close")}},props:{client:{type:Object}}};const Aa=(0,y.Z)(Va,[["render",Za],["__scopeId","data-v-61a1c5ba"]]);var Ya=Aa;const Ka=e=>((0,s.dD)("data-v-503f7a54"),e=e(),(0,s.Cn)(),e),Ra={key:0,class:"direction-user-item"},Qa={class:"direction-user__header"},Ja={class:"direction-user-name"},Ga={class:"direction-user-name-content"},Xa={key:1,class:"direction-user-item empty"},eo=Ka((()=>(0,s._)("span",null,"Нет сотрудников",-1))),to=[eo];function no(e,t,n,i,o,c){return void 0!==this.directionUser?((0,s.wg)(),(0,s.iD)("div",Ra,[(0,s._)("div",Qa,[(0,s._)("div",Ja,[(0,s._)("span",Ga,(0,a.zw)(o.directionUser.first_name)+" "+(0,a.zw)(o.directionUser.second_name)+" "+(0,a.zw)(o.directionUser.third_name),1)])])])):((0,s.wg)(),(0,s.iD)("div",Xa,to))}var io={data(){return{directionUser:this.directionUserData}},props:{directionUserData:{type:Object,default:void 0}}};const so=(0,y.Z)(io,[["render",no],["__scopeId","data-v-503f7a54"]]);var ao=so,oo={components:{Contact:Ha,ShowInfoBtn:Sa,EditButton:dt,ClientHistory:Ya,DirectionUser:ao},data(){return{isShowContactList:!1,directions:[],isShowClientHistory:!1,contacts:[],client:this.clientData,isCreateContactMode:!0,directionUsers:[],selectedDirection:-1}},props:{clientData:{type:Object,default:{}},newContact:{type:Object,default:void 0}},methods:{async touchClientInfoButton(){this.isShowContactList||(this.contacts=await C.getClientContacts(this.clientData.id)),this.isShowContactList=!this.isShowContactList,this.selectedDirection=-1},touchCreateContact(){this.$emit("create",this.clientData),this.isCreateContactMode=!0},editClient(){this.$emit("edit",this.clientData)},touchEditContact(e){this.$emit("editContact",e),this.isCreateContactMode=!1},touchShowCLientHistory(){this.isShowClientHistory=!0},closeHistory(){this.isShowClientHistory=!1},async showUsersByDirection(e){this.isShowContactList&&(this.selectedDirection!==e.id?(this.directionUsers=await C.getClientLinkedUsersByDirection(this.clientData.id,e.id),this.selectedDirection=e.id):this.selectedDirection=-1)}},computed:{allContacts(){if(void 0===this.newContact)return this.contacts;return this.contacts=this.contacts.map(((e,t)=>e.id===this.newContact.id?(!1,this.newContact):e)),this.isCreateContactMode&&this.contacts.push(this.newContact),this.contacts}},async mounted(){this.directions=await C.getDirections()}};const co=(0,y.Z)(oo,[["render",ia],["__scopeId","data-v-9ccc5ff4"]]);var ro=co,lo={components:{NavBar:de,LoadingIndicate:ce,Client:ro,AddButton:et,Popup:G,Multicheckbox:$n},setup(){return{v$:(0,Zt.ZP)()}},validations(){return{newClientName:{required:jt.C1},newClientInn:{required:jt.C1,minLength:(0,jt.Ei)(12),maxLength:(0,jt.BS)(12)},newContactFirstName:{required:jt.C1},newContactSecondName:{required:jt.C1}}},data(){return{clients:[],isLoadedClientsFromApi:!1,searchQuery:"",isMyClients:!0,displayClientPopup:!1,displayContactPopup:!1,newClientName:"",newClientInn:"",newContactFirstName:"",newContactThirdName:"",newContactSecondName:"",newContactPhone:"",newContactPosition:"",newContactEmail:"",isExistClient:!1,isExistContact:!1,isCreateClientMode:!1,isCreateContactMode:!1,editContactObject:{},clientIdForNewContact:"",newContactForClient:new Map,users:[],editClientObject:{name:"",inn:""}}},async mounted(){this.clients=await C.getClients(!0),this.users=await C.getUsers(),this.prepareUserOptions(),this.isLoadedClientsFromApi=!0},computed:{searchedClients(){return this.clients.filter((e=>e.name.toLowerCase().includes(this.searchQuery.toLowerCase())||e.inn.includes(this.searchQuery)))},checkboxTitle(){return this.isMyClients?"Мои клиенты":"Все клиенты"},employee_list(){let e=[];return this.isCreateClientMode&&e.push(d.state.user.id),this.users.forEach((t=>{t.isSelected&&e.push(t.id)})),e},popupButtonTitle(){return this.isCreateClientMode||this.isCreateContactMode?"Создать":"Сохранить"},clientPopupTitle(){return this.isCreateClientMode?"Создание клиента":"Редактирование клиента"},contactPopupTitle(){return this.isCreateContactMode?"Создание контакта":"Редактирование контакта"}},methods:{prepareNewContactForChildComponent(e){const t=this.newContactForClient.get(e);return this.newContactForClient.delete(e),t},async editClient(){const e=await this.isCorrectClientForm();e&&(this.editClientObject.name=this.newClientName,this.editClientObject.inn=this.newClientInn,this.editClientObject.employee_list=this.employee_list,await C.editClient(this.editClientObject),this.closePopupForClient())},async touchEditClient(e){this.editClientObject=e,this.newClientName=e.name,this.newClientInn=e.inn;const t=await C.getLinkedUsersByClientId(e.id);this.fillSelectedUsersLinkedWithClient(t),this.isCreateClientMode=!1,this.showPopupForClient()},touchCreateClient(){this.isCreateClientMode=!0,this.showPopupForClient()},touchCreateContact(e){this.isCreateContactMode=!0,this.showPopupForContact(),this.clientIdForNewContact=e.id},touchEditContact(e){this.isCreateContactMode=!1,this.showPopupForContact(),this.editContactObject=e,this.newContactFirstName=e.first_name,this.newContactSecondName=e.second_name,this.newContactThirdName=e.third_name,this.newContactPosition=e.position,this.newContactPhone=e.phone,this.newContactEmail=e.email},async createClient(){this.isExistClient=!1;const e=await this.isCorrectClientForm();if(!e)return;const t={name:this.newClientName,inn:this.newClientInn,employee_list:this.employee_list};if(this.isExistClient=await C.isExistClient(t),this.isExistClient)return;const n=await C.createClient(t);this.clients.push(n),this.closePopupForClient()},async touchCheckbox(){this.isLoadedClientsFromApi=!1,this.isMyClients=!this.isMyClients,this.clients=await C.getClients(this.isMyClients),this.isLoadedClientsFromApi=!0},closePopupForClient(){this.displayClientPopup=!1,this.cleareCreateClientPopup(),this.isExistClient=!1,this.isCreateClientMode=!1,this.users.forEach((e=>e.isSelected=!1))},closePopupForContact(){this.displayContactPopup=!1,this.cleareCreateContactPopup(),this.isExistContact=!1},showPopupForClient(){this.displayClientPopup=!0},showPopupForContact(){this.displayContactPopup=!0},cleareCreateClientPopup(){this.newClientName="",this.newClientInn="",this.v$.$reset()},cleareCreateContactPopup(){this.newContactFirstName="",this.newContactSecondName="",this.newContactThirdName="",this.newContactPhone="",this.newContactPosition="",this.newContactEmail="",this.v$.$reset()},async clientPopupActionHandler(){this.isCreateClientMode?await this.createClient():await this.editClient()},async contactPopupActionHandler(){this.isCreateContactMode?await this.createContact():await this.editContact()},async createContact(){this.isExistContact=!1;const e=await this.isCorrectContactForm();if(!e)return;const t={client:this.clientIdForNewContact,first_name:this.newContactFirstName,second_name:this.newContactSecondName,third_name:this.newContactThirdName,phone:this.newContactPhone,position:this.newContactPosition,email:this.newContactEmail};if(this.isExistContact=await C.isExistContact(t),this.isExistContact)return;const n=await C.createContact(t);this.newContactForClient.set(t.client,n),this.closePopupForContact()},async editContact(){const e=await this.isCorrectContactForm();if(!e)return;const t=await C.editContact({first_name:this.newContactFirstName,second_name:this.newContactSecondName,third_name:this.newContactThirdName,phone:this.newContactPhone,position:this.newContactPosition,email:this.newContactEmail,client:this.editContactObject.client,id:this.editContactObject.id});this.newContactForClient.set(this.editContactObject.client,t),this.closePopupForContact()},async isCorrectContactForm(){const e=await this.v$.newContactFirstName.$validate(),t=await this.v$.newContactSecondName.$validate();return!(!e||!t)},async isCorrectClientForm(){const e=await this.v$.newClientName.$validate(),t=await this.v$.newClientInn.$validate();return!(!e||!t)},prepareUserOptions(){return this.users=this.users.map((e=>(e.isSelected=!1,e.name=this.fullNameWithDirection(e),e))),this.users},fullNameWithDirection(e){return e.second_name+" "+e.first_name[0]+e.third_name[0]+"("+e.direction_name+")"},fillSelectedUsersLinkedWithClient(e){this.users.forEach((t=>{e.forEach((e=>{t.id===e.id&&(t.isSelected=!0)}))}))}}};const ho=(0,y.Z)(lo,[["render",Ws],["__scopeId","data-v-1861f258"]]);var uo=ho;const po=e=>((0,s.dD)("data-v-40dbb8c9"),e=e(),(0,s.Cn)(),e),mo={class:"wrapper"},go=po((()=>(0,s._)("h1",null,"Meeting results page",-1)));function wo(e,t,n,i,a,o){const c=(0,s.up)("nav-bar"),r=(0,s.up)("loading-indicate");return(0,s.wg)(),(0,s.iD)("div",mo,[(0,s.Wm)(c),go,(0,s.Wm)(r)])}var vo={components:{NavBar:de,LoadingIndicate:ce}};const Co=(0,y.Z)(vo,[["render",wo],["__scopeId","data-v-40dbb8c9"]]);var _o=Co,yo=n(2483);const fo=[{path:"/",component:Xt,name:"Главная"},{path:"/login",component:pn,name:"Вход"},{path:"/calendar",component:ns,name:"Календарь"},{path:"/results",component:_o,name:"Отчеты"},{path:"/clients",component:uo,name:"Клиенты"}],ko=(0,yo.p7)({routes:fo,history:(0,yo.PO)()});ko.beforeEach((async(e,t,n)=>{document.title=e.name,"Вход"===e.name||await C.isValidToken()?n():n("/login")}));var Do=ko;const bo=(0,c.MT)({modules:{auth:d}});var Mo=bo;const Po=(0,i.ri)(k);Po.use(Do),Po.use(Mo),Po.mount("#app")}},t={};function n(i){var s=t[i];if(void 0!==s)return s.exports;var a=t[i]={exports:{}};return e[i](a,a.exports,n),a.exports}n.m=e,function(){var e=[];n.O=function(t,i,s,a){if(!i){var o=1/0;for(d=0;d<e.length;d++){i=e[d][0],s=e[d][1],a=e[d][2];for(var c=!0,r=0;r<i.length;r++)(!1&a||o>=a)&&Object.keys(n.O).every((function(e){return n.O[e](i[r])}))?i.splice(r--,1):(c=!1,a<o&&(o=a));if(c){e.splice(d--,1);var l=s();void 0!==l&&(t=l)}}return t}a=a||0;for(var d=e.length;d>0&&e[d-1][2]>a;d--)e[d]=e[d-1];e[d]=[i,s,a]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,i){var s,a,o=i[0],c=i[1],r=i[2],l=0;if(o.some((function(t){return 0!==e[t]}))){for(s in c)n.o(c,s)&&(n.m[s]=c[s]);if(r)var d=r(n)}for(t&&t(i);l<o.length;l++)a=o[l],n.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return n.O(d)},i=self["webpackChunkvue_project"]=self["webpackChunkvue_project"]||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))}();var i=n.O(void 0,[998],(function(){return n(1780)}));i=n.O(i)})();
//# sourceMappingURL=app.0ddb5e19.js.map