(function(){"use strict";var t={606:function(t,e,n){var i=n(9242),s=n(3396),a=n(2268);function o(t,e,n,i,o,c){const l=(0,s.up)("router-view");return(0,s.wg)(),(0,s.iD)("div",{class:(0,a.C_)(["app",{loginColor:c.isSignIn}])},[(0,s.Wm)(l)],2)}var c=n(7139),l={computed:{isSignIn(){return"/login"===this.$route.path}},methods:{...(0,c.OI)(["loadDataFromLocalStorage","loadDataFromSessionStorage"])},mounted(){null===sessionStorage.getItem("token")?null===localStorage.getItem("token")?this.$router.push("/login"):this.loadDataFromLocalStorage():this.loadDataFromSessionStorage()}},r=n(89);const d=(0,r.Z)(l,[["render",o]]);var p=d;const u={class:"wrapper"};function h(t,e,n,i,a,o){const c=(0,s.up)("nav-bar"),l=(0,s.up)("meetings");return(0,s.wg)(),(0,s.iD)("div",u,[(0,s.Wm)(c),(0,s.Wm)(l)])}const m=t=>((0,s.dD)("data-v-46acdb7b"),t=t(),(0,s.Cn)(),t),C={class:"header"},w=m((()=>(0,s._)("div",{class:"title-name title-names"},[(0,s._)("h3",{class:"logo-name"},"Sber clients")],-1))),g={class:"nav-bar-list"},v=m((()=>(0,s._)("input",{type:"checkbox",name:"",id:"checkbox_toggle"},null,-1))),_=m((()=>(0,s._)("label",{for:"checkbox_toggle",class:"hamburger"},[(0,s._)("span",{class:"hamburger-line"})],-1))),y={class:"menu-items"},f=(0,s.Uk)("Главная страница"),k=(0,s.Uk)("Мои клиенты"),b=(0,s.Uk)("Календарь"),M=(0,s.Uk)("Отчёты по встречам"),P=m((()=>(0,s._)("button",{class:"log-out-item"},"Выйти",-1))),I=[P],D=m((()=>(0,s._)("button",{class:"nav-bar-notify-button"},[(0,s._)("img",{src:"/svg/notify.svg",alt:"",class:"nav-bar-notify-icon"})],-1))),$={class:"popup_wrapper"},S=m((()=>(0,s._)("h1",{class:"popup-title"},"Доступные комнаты",-1))),F=m((()=>(0,s._)("img",{src:"/svg/add-meet.svg",alt:"",class:"nav-bar-icon-add"},null,-1))),x=[F],E=m((()=>(0,s._)("button",{class:"nav-bar-profile"},[(0,s._)("img",{src:"/svg/profile.svg",alt:"",class:"nav-bar-profile-icon"})],-1))),H=m((()=>(0,s._)("hr",{class:"line-header"},null,-1)));function U(t,e,n,o,c,l){const r=(0,s.up)("router-link"),d=(0,s.up)("loading-indicate"),p=(0,s.up)("v-popup");return(0,s.wg)(),(0,s.iD)("header",C,[(0,s._)("nav",null,[w,(0,s._)("ul",g,[v,_,(0,s._)("div",y,[(0,s._)("li",{class:"nav-bar-list-item",onClick:e[0]||(e[0]=e=>t.$router.push("/"))},[(0,s.Wm)(r,{to:"/",class:"unactive","active-class":"active"},{default:(0,s.w5)((()=>[f])),_:1})]),(0,s._)("li",{class:"nav-bar-list-item",onClick:e[1]||(e[1]=e=>t.$router.push("/clients"))},[(0,s.Wm)(r,{to:"/clients",class:"unactive","active-class":"active"},{default:(0,s.w5)((()=>[k])),_:1})]),(0,s._)("li",{class:"nav-bar-list-item",onClick:e[2]||(e[2]=e=>t.$router.push("/calendar"))},[(0,s.Wm)(r,{to:"/calendar",class:"unactive","active-class":"active"},{default:(0,s.w5)((()=>[b])),_:1})]),(0,s._)("li",{class:"nav-bar-list-item",onClick:e[3]||(e[3]=e=>t.$router.push("/results"))},[(0,s.Wm)(r,{to:"/results",class:"unactive","active-class":"active"},{default:(0,s.w5)((()=>[M])),_:1})]),(0,s._)("li",{class:"nav-bar-list-item button-exit",onClick:e[4]||(e[4]=(...t)=>l.logOutWrapper&&l.logOutWrapper(...t))},I)])]),D,(0,s._)("div",$,[c.isInfoPopupVisible?((0,s.wg)(),(0,s.j4)(p,{key:0,onClosePopup:l.closeInfoPopup,class:"modal-window"},{header:(0,s.w5)((()=>[S])),content:(0,s.w5)((()=>[c.isLoadedPlaces?(0,s.wy)(((0,s.wg)(),(0,s.iD)("select",{key:0,name:"",id:"",class:"select-room","onUpdate:modelValue":e[5]||(e[5]=t=>c.selected=t)},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(c.places,(t=>((0,s.wg)(),(0,s.iD)("option",{key:t},(0,a.zw)(t.name),1)))),128))],512)),[[i.bM,c.selected]]):((0,s.wg)(),(0,s.j4)(d,{key:1}))])),_:1},8,["onClosePopup"])):(0,s.kq)("",!0)]),(0,s._)("button",{class:"nav-bar-add-meet v-modal_add-meet",id:"btn-add",onClick:e[6]||(e[6]=(...t)=>l.showPopupInfo&&l.showPopupInfo(...t))},x),E,(0,s._)("button",{onClick:e[7]||(e[7]=(...t)=>l.logOutWrapper&&l.logOutWrapper(...t)),class:"log-out"},"Выйти")]),H])}const L={class:"popup_wrapper",ref:"popup_wrapper"},N={class:"v-popup__header"},T={class:"v-popup__content"},O={class:"v-popup__footer"};function q(t,e,n,a,o,c){return(0,s.wg)(),(0,s.iD)("div",L,[(0,s._)("form",{class:"v-popup animation",onSubmit:e[1]||(e[1]=(0,i.iM)((()=>{}),["prevent"]))},[(0,s._)("div",N,[(0,s.WI)(t.$slots,"header",{},void 0,!0),(0,s._)("span",null,[(0,s._)("i",{class:"material-icons",onClick:e[0]||(e[0]=(...t)=>c.closePopup&&c.closePopup(...t))}," close ")])]),(0,s._)("div",T,[(0,s.WI)(t.$slots,"content",{},void 0,!0)]),(0,s._)("div",O,[(0,s.WI)(t.$slots,"footer",{},void 0,!0)])],32)],512)}var z={props:{},data(){return{}},methods:{closePopup(){this.$emit("closePopup")}},mounted(){let t=this;document.addEventListener("click",(function(e){e.target===t.$refs["popup_wrapper"]&&t.closePopup()}))}};const W=(0,r.Z)(z,[["render",q],["__scopeId","data-v-b5ee4bea"]]);var j=W;const B=t=>((0,s.dD)("data-v-206c088c"),t=t(),(0,s.Cn)(),t),V={class:"loading-container"},A=B((()=>(0,s._)("div",{class:"loading-indicator"},null,-1))),Z=B((()=>(0,s._)("p",{class:"information-text"},"Загрузка данных...",-1))),K=[A,Z];function Y(t,e,n,i,a,o){return(0,s.wg)(),(0,s.iD)("div",V,K)}var Q={};const J=(0,r.Z)(Q,[["render",Y],["__scopeId","data-v-206c088c"]]);var R=J,G=n(6265),X=n.n(G),tt={actions:{async logIn(t,{username:e,password:n,isSavedSession:i}){const s=await ct.auth(e,n);if(null===s)return t.commit("setErrorMessage",ct.error),ct.error="",!1;t.commit("setToken",s.auth_token);let a=!0;const o=await t.dispatch("getUser");return null===o&&(a=!1),i&&t.commit("saveSessionToLocalStorage"),t.commit("saveSessionToSessionStorage"),a&&t.commit("setErrorMessage",""),a},async getUser(t){const e=await ct.currentUser(t.state.token);return null===e?(t.commit("setErrorMessage",ct.error),ct.error="",null):(t.commit("updateUser",e),e)}},mutations:{setToken(t,e){t.token=e,nt()},saveSessionToLocalStorage(t){localStorage.setItem("token",t.token),localStorage.setItem("user",JSON.stringify(t.user))},saveSessionToSessionStorage(t){sessionStorage.setItem("token",t.token),sessionStorage.setItem("user",JSON.stringify(t.user))},updateUser(t,e){t.user=e},loadDataFromLocalStorage(t){t.token=localStorage.getItem("token"),t.user=JSON.parse(localStorage.getItem("user")),nt()},loadDataFromSessionStorage(t){t.token=sessionStorage.getItem("token"),t.user=JSON.parse(sessionStorage.getItem("user")),nt()},logOut(t){t.token="",t.user={},localStorage.removeItem("token"),localStorage.removeItem("user"),sessionStorage.removeItem("token"),sessionStorage.removeItem("user")},setErrorMessage(t,e){t.errorMessage=e}},state:{token:null,user:{},errorMessage:""},getters:{}};const et=X().create({baseURL:"http://sbermeeting.tk/",headers:{accept:"application/json"}});function nt(){et.defaults.headers.common["Authorization"]="Token "+tt.state.token}var it=et;const st="api/v2/",at={auth:"users/auth/token/login/",user:"users/employee/current/",meetings:"meetings/",client:"clients/",contact:"clients/contacts/",place:"meetings/place/",employeelist:"employeelist/",users:"users/employee/"},ot={error:{},async auth(t,e){try{const n=await it.post(st+at["auth"],{username:t,password:e});return n.data}catch(n){return this.errorHandle(n),null}},async currentUser(){try{const t=await it.get(st+at["user"],{headers:{Authorization:"Token "+tt.state.token}});return t.data}catch(t){return this.errorHandle(t),null}},async getMeetings(t=!1){try{const e=await it.get(st+at["meetings"]+"?employee="+tt.state.user.id+(t?"&past=true":""));return e.data}catch(e){return this.errorHandle(e),[]}},async getClients(t){try{let e=await it.get(st+at["client"]+(t?"?employee="+tt.state.user.id:""));return e.data}catch(e){return this.errorHandle(e),[]}},async editClient(t){try{let e=await it.patch(st+at["client"]+t.id+"/",t);return e.data}catch(e){return this.errorHandle(e),{}}},async editContact(t){try{let e=await it.patch(st+at["contact"]+t.id+"/",t);return e.data}catch(e){return this.errorHandle(e),{}}},async getClientContacts(t){try{let e=await it.get(st+at["contact"]+"?client="+t);return e.data}catch(e){return this.errorHandle(e),[]}},async getPlaces(){try{let t=await it.get(st+at["place"]+"?my=true",{headers:{Authorization:"Token "+tt.state.token}});return t.data}catch(t){return this.errorHandle(t),[]}},async getFreePlaces(t,e,n){try{let i=await it.get(st+at["place"]+"?date="+n+"&start="+t+"&end="+e+"&my=true");return i.data}catch(i){return this.errorHandle(i),[]}},async createMeeting(t){try{const e=await it.post(st+at["meetings"],t);return e.data}catch(e){return this.errorHandle(e),{}}},async createClient(t){try{let e=await it.post(st+at["client"],t);return e.data}catch(e){return this.errorHandle(e),{}}},async createContact(t){try{let e=await it.post(st+at["contact"],t);return e.data}catch(e){return this.errorHandle(e),{}}},async isExistClient(t){try{let e=await it.get(st+at["client"]+"?inn="+t.inn);return!!e.data.length}catch(e){return this.errorHandle(e),!1}},async isExistContact(t){try{let e=await it.get(st+at["contact"]+"?client="+t.client+"&first_name="+t.first_name+"&second_name="+t.second_name);return!!e.data.length}catch(e){return this.errorHandle(e),!1}},async getUsers(){try{let t=await it.get(st+at["users"]);return t.data}catch(t){return this.errorHandle(t),[]}},async deleteMeeting(t){try{let e=await it["delete"](st+at["meetings"]+t+"/");return e.data}catch(e){return this.errorHandle(e),{}}},async editMeeting(t){try{let e=await it.patch(st+at["meetings"]+t.id+"/",t);return e.data}catch(e){return this.errorHandle(e),{}}},errorHandle(t){if(t.response)switch(t.response.status){case 400:this.error="Неверный логин/пароль";break;case 401:this.error=t.response.statusText+"."+t.response.data.detail;break;default:this.error=t.message+"."+t.response.statusText}else t.request&&(this.error="Bad connection")}};var ct=ot,lt={components:{vPopup:j,LoadingIndicate:R},methods:{...(0,c.OI)(["logOut"]),logOutWrapper(){this.$router.push("/login"),this.logOut()},showPopupInfo(){this.isInfoPopupVisible=!0},closeInfoPopup(){this.isInfoPopupVisible=!1}},data(){return{isInfoPopupVisible:!1,isLoadedPlaces:!1,places:[],selected:"test"}},async mounted(){const t=await ct.getPlaces();this.places=t,this.isLoadedPlaces=!0}};const rt=(0,r.Z)(lt,[["render",U],["__scopeId","data-v-46acdb7b"]]);var dt=rt;const pt=t=>((0,s.dD)("data-v-7fdaf440"),t=t(),(0,s.Cn)(),t),ut={class:"main-container"},ht={key:0,class:"near-meet"},mt=pt((()=>(0,s._)("h2",{class:"near-meet-text"},"Ближайшая встреча:",-1))),Ct={key:0,class:"container-window"},wt=pt((()=>(0,s._)("img",{src:"/svg/pencil.svg",alt:"",class:"pencil-icon"},null,-1))),gt=[wt],vt={class:"client-name"},_t={class:"window-tel-and-contact"},yt={class:"contact-window"},ft={class:"tel-window"},kt={class:"theme-window"},bt={class:"data-and-time-window"},Mt={class:"data-window"},Pt={class:"time-window"},It={class:"place-window"},Dt={key:1,class:"container-window empty"},$t=pt((()=>(0,s._)("p",null,"Нет ближайшей встречи",-1))),St=[$t],Ft={class:"green-button-add"},xt=(0,s.Uk)("Добавить встречу"),Et={key:3,class:"list-meet"},Ht=pt((()=>(0,s._)("h2",{class:"list-meet-text"},"Список встреч:",-1))),Ut=pt((()=>(0,s._)("span",null,"Текущие",-1))),Lt=pt((()=>(0,s._)("span",null,"Прошедшие",-1))),Nt={key:0,class:"list-all-meet"},Tt={class:"data-time-place-item"},Ot={class:"data-item"},qt={class:"time-item"},zt={class:"place-item"},Wt={class:"theme-item"},jt={class:"client-item"},Bt={key:1,class:"list-all-meet"},Vt=pt((()=>(0,s._)("li",{class:"all-meet-item empty"},[(0,s._)("p",null,"Нет встреч")],-1))),At=[Vt],Zt={class:"add-meeting-phone"},Kt=(0,s.Uk)("Добавить встречу");function Yt(t,e,n,i,o,c){const l=(0,s.up)("add-button"),r=(0,s.up)("create-meet"),d=(0,s.up)("segmented-control"),p=(0,s.up)("edit-button"),u=(0,s.up)("loading-indicate");return(0,s.wg)(),(0,s.iD)("main",ut,[o.isLoadedMeetings?((0,s.wg)(),(0,s.iD)("div",ht,[mt,void 0!==o.nearMeeting?((0,s.wg)(),(0,s.iD)("div",Ct,[(0,s._)("button",{class:"pencil-meet",onClick:e[0]||(e[0]=t=>c.editMeeting(this.nearMeeting))},gt),(0,s._)("p",vt,(0,a.zw)(o.nearMeeting.client_name),1),(0,s._)("div",_t,[(0,s._)("p",yt,(0,a.zw)(o.nearMeeting.contact_name),1),(0,s._)("p",ft,(0,a.zw)(o.nearMeeting.contact_phone),1)]),(0,s._)("p",kt,(0,a.zw)(o.nearMeeting.topic),1),(0,s._)("div",bt,[(0,s._)("p",Mt,(0,a.zw)(o.nearMeeting.date),1),(0,s._)("p",Pt,(0,a.zw)(o.nearMeeting.start)+" - "+(0,a.zw)(o.nearMeeting.end),1)]),(0,s._)("p",It,(0,a.zw)(o.nearMeeting.place_name),1)])):((0,s.wg)(),(0,s.iD)("div",Dt,St)),(0,s._)("div",Ft,[(0,s.Wm)(l,{onClick:e[1]||(e[1]=t=>this.displayCreateMeetPopup=!0)},{default:(0,s.w5)((()=>[xt])),_:1})])])):(0,s.kq)("",!0),o.displayEditMeetPopup?((0,s.wg)(),(0,s.j4)(r,{key:1,onClosePopup:c.closeEditPopup,isCreatePopup:!1,editingMeet:this.editingMeet,onCancelMeeting:c.deleteMeeting,onEditMeeting:c.changeEditedMeeting,class:"meet__modal-window"},null,8,["onClosePopup","editingMeet","onCancelMeeting","onEditMeeting"])):(0,s.kq)("",!0),o.displayCreateMeetPopup?((0,s.wg)(),(0,s.j4)(r,{key:2,onClosePopup:c.closeCreatePopup,onCreateMeeting:c.displayNewMeeting,class:"meet__modal-window"},null,8,["onClosePopup","onCreateMeeting"])):(0,s.kq)("",!0),o.isLoadedMeetings?((0,s.wg)(),(0,s.iD)("div",Et,[Ht,(0,s.Wm)(d,{class:"segmented-control",onSelected:c.selectedSegmentedControl},{item1:(0,s.w5)((()=>[Ut])),item2:(0,s.w5)((()=>[Lt])),_:1},8,["onSelected"]),o.meetings.length?((0,s.wg)(),(0,s.iD)("ul",Nt,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(o.meetings,(t=>((0,s.wg)(),(0,s.iD)("li",{key:t,class:"all-meet-item"},[(0,s._)("div",Tt,[(0,s._)("p",Ot,(0,a.zw)(t.date),1),(0,s._)("p",qt,(0,a.zw)(t.start)+" - "+(0,a.zw)(t.end),1),(0,s._)("p",zt,(0,a.zw)(t.place_name),1),(0,s.Wm)(p,{class:"edit-btn",onClick:e=>c.editMeeting(t)},null,8,["onClick"])]),(0,s._)("p",Wt,(0,a.zw)(t.topic),1),(0,s._)("p",jt,(0,a.zw)(t.client_name),1)])))),128))])):((0,s.wg)(),(0,s.iD)("ul",Bt,At))])):((0,s.wg)(),(0,s.j4)(u,{key:4,class:"indicator"})),(0,s._)("div",Zt,[(0,s.Wm)(l,{onClick:e[2]||(e[2]=t=>this.displayCreateMeetPopup=!0)},{default:(0,s.w5)((()=>[Kt])),_:1})])])}const Qt={class:"add-meet-but"};function Jt(t,e,n,i,a,o){return(0,s.wg)(),(0,s.iD)("button",Qt,[(0,s.WI)(t.$slots,"default",{},void 0,!0)])}var Rt={};const Gt=(0,r.Z)(Rt,[["render",Jt],["__scopeId","data-v-18ed6975"]]);var Xt=Gt;const te={class:"segmented-control-container"};function ee(t,e,n,i,o,c){return(0,s.wg)(),(0,s.iD)("div",te,[(0,s._)("button",{class:(0,a.C_)(["segmented-control-item",{active:o.isFirstItemActive}]),onClick:e[0]||(e[0]=(...t)=>c.touchItem&&c.touchItem(...t))},[(0,s.WI)(t.$slots,"item1",{class:"segmented-control-item-name"},void 0,!0)],2),(0,s._)("button",{class:(0,a.C_)(["segmented-control-item",{active:!o.isFirstItemActive}]),onClick:e[1]||(e[1]=(...t)=>c.touchItem&&c.touchItem(...t))},[(0,s.WI)(t.$slots,"item2",{class:"segmented-control-item-name"},void 0,!0)],2)])}var ne={data(){return{isFirstItemActive:!0}},methods:{touchItem(){this.isFirstItemActive=!this.isFirstItemActive,this.$emit("selected",this.isFirstItemActive)}}};const ie=(0,r.Z)(ne,[["render",ee],["__scopeId","data-v-12f33ba4"]]);var se=ie;const ae={class:"edit-btn"};function oe(t,e,n,i,a,o){return(0,s.wg)(),(0,s.iD)("button",ae,"...")}var ce={};const le=(0,r.Z)(ce,[["render",oe],["__scopeId","data-v-1adf17e5"]]);var re=le;const de={class:"popup_wrapper",ref:"popup_wrapper"},pe={class:"v-popup__header"},ue={class:"popup-title"},he={class:"v-popup__content"},me={class:"info-meeting"},Ce={class:"info-meet-main"},we={class:"client-container"},ge=["value","disabled"],ve={class:"contact-container"},_e=["value","disabled"],ye={class:"theme-container"},fe={key:0,class:"validate-error-message"},ke={class:"date-icon-all"},be={class:"date-container"},Me={key:0,class:"validate-error-message"},Pe={key:1,class:"validate-error-message"},Ie={class:"time-start-end"},De={class:"time-start"},$e={key:0,class:"validate-error-message"},Se={key:1,class:"validate-error-message"},Fe={class:"time-end"},xe={key:0,class:"validate-error-message"},Ee={class:"place-container"},He=["value","disabled"],Ue={key:0,class:"validate-error-message"},Le={class:"info-worker"},Ne={class:"worker-container"},Te=["value","disabled"],Oe={class:"info-note"},qe={class:"note-container"},ze={class:"footer_btns"},We=(0,s.Uk)("Сохранить"),je=(0,s.Uk)("Отменить");function Be(t,e,n,o,c,l){const r=(0,s.up)("add-button");return(0,s.wg)(),(0,s.iD)("div",de,[(0,s._)("form",{class:"v-popup animation",onSubmit:e[14]||(e[14]=(0,i.iM)((()=>{}),["prevent"]))},[(0,s._)("div",pe,[(0,s._)("span",ue,(0,a.zw)(l.popupTitle),1),(0,s._)("span",null,[(0,s._)("i",{class:"material-icons",onClick:e[0]||(e[0]=(...t)=>l.closePopup&&l.closePopup(...t))}," close ")])]),(0,s._)("div",he,[(0,s._)("div",me,[(0,s._)("div",Ce,[(0,s._)("div",we,[(0,s.wy)((0,s._)("select",{class:"client-input","onUpdate:modelValue":e[1]||(e[1]=t=>c.selectedClient=t),onChange:e[2]||(e[2]=(...t)=>l.selectClientHandler&&l.selectClientHandler(...t))},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(c.clients,(t=>((0,s.wg)(),(0,s.iD)("option",{value:t,disabled:0===t.id},(0,a.zw)(t.name),9,ge)))),256))],544),[[i.bM,c.selectedClient]])]),(0,s._)("div",ve,[(0,s.wy)((0,s._)("select",{class:"contact-input","onUpdate:modelValue":e[3]||(e[3]=t=>c.selectedContact=t)},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(c.contacts,(t=>((0,s.wg)(),(0,s.iD)("option",{value:t,disabled:0===t.id},(0,a.zw)(t.name),9,_e)))),256))],512),[[i.bM,c.selectedContact]])]),(0,s._)("div",ye,[(0,s.wy)((0,s._)("input",{type:"text",class:(0,a.C_)(["theme-input",{invalid:o.v$.theme.$error}]),placeholder:"Тема","onUpdate:modelValue":e[4]||(e[4]=t=>c.theme=t)},null,2),[[i.nr,c.theme]]),o.v$.theme.$error?((0,s.wg)(),(0,s.iD)("small",fe," Тема встречи является обязательным полем! ")):(0,s.kq)("",!0)]),(0,s._)("div",ke,[(0,s._)("div",be,[(0,s.wy)((0,s._)("input",{type:"date",class:(0,a.C_)(["date-input",{invalid:o.v$.date.$error||!this.isCorrectDate}]),placeholder:"Дата",id:"datepicker","onUpdate:modelValue":e[5]||(e[5]=t=>c.date=t),onChange:e[6]||(e[6]=(...t)=>l.changeTime&&l.changeTime(...t)),style:{padding:"5px, 0px, 0px, 5px"}},null,34),[[i.nr,c.date]]),o.v$.date.$error?((0,s.wg)(),(0,s.iD)("small",Me," Поле даты - обязательное поле! ")):(0,s.kq)("",!0),l.isCorrectDate?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("small",Pe," Дата должна быть >= текущей даты! "))])]),(0,s._)("div",Ie,[(0,s._)("div",De,[(0,s.wy)((0,s._)("input",{type:"time",class:(0,a.C_)(["date-start-input",{invalid:o.v$.start.$error||!this.isCorrectSelectedTime}]),placeholder:"Время начала",id:"startpicker","onUpdate:modelValue":e[7]||(e[7]=t=>c.start=t),onChange:e[8]||(e[8]=(...t)=>l.changeTime&&l.changeTime(...t))},null,34),[[i.nr,c.start]]),o.v$.start.$error?((0,s.wg)(),(0,s.iD)("small",$e," Время начала встречи - обязательное поле! ")):(0,s.kq)("",!0),l.isCorrectSelectedTime?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("small",Se," Время начало должно быть меньше время конца встречи! "))]),(0,s._)("div",Fe,[(0,s.wy)((0,s._)("input",{type:"time",class:(0,a.C_)(["date-end-input",{invalid:o.v$.end.$error}]),placeholder:"Время окончания",id:"endpicker","onUpdate:modelValue":e[9]||(e[9]=t=>c.end=t),onChange:e[10]||(e[10]=(...t)=>l.changeTime&&l.changeTime(...t))},null,34),[[i.nr,c.end]]),o.v$.end.$error?((0,s.wg)(),(0,s.iD)("small",xe," Время окончания встречи - обязательное поле! ")):(0,s.kq)("",!0)])]),(0,s._)("div",Ee,[(0,s.wy)((0,s._)("select",{class:(0,a.C_)(["place-input",{invalid:o.v$.end.$error}]),"onUpdate:modelValue":e[11]||(e[11]=t=>c.place=t)},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(c.freePlaces,(t=>((0,s.wg)(),(0,s.iD)("option",{value:t,disabled:0===t.id},(0,a.zw)(t.name),9,He)))),256))],2),[[i.bM,c.place]]),o.v$.place.$error?((0,s.wg)(),(0,s.iD)("small",Ue," Место встречи - обязательное поле! ")):(0,s.kq)("",!0)])]),(0,s._)("div",Le,[(0,s._)("div",Ne,[(0,s.wy)((0,s._)("select",{class:"worker-input","onUpdate:modelValue":e[12]||(e[12]=t=>c.selectedUsersInMeeting=t),multiple:"",style:{padding:"5px 0px 0px 5px"}},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(c.users,(t=>((0,s.wg)(),(0,s.iD)("option",{value:t,disabled:0===t.id},(0,a.zw)(t.name),9,Te)))),256))],512),[[i.bM,c.selectedUsersInMeeting]])])])]),(0,s._)("div",Oe,[(0,s._)("div",qe,[(0,s.wy)((0,s._)("textarea",{type:"text",class:"note-input",placeholder:"Заметки","onUpdate:modelValue":e[13]||(e[13]=t=>c.note=t),style:{padding:"5px 0px 0px 5px"}},null,512),[[i.nr,c.note]])])])]),(0,s._)("div",ze,[(0,s.Wm)(r,{class:"popup-footer-btn popup-save",onClick:l.touchSaveButtonHandler},{default:(0,s.w5)((()=>[We])),_:1},8,["onClick"]),n.isCreatePopup?(0,s.kq)("",!0):((0,s.wg)(),(0,s.j4)(r,{key:0,class:"popup-footer-btn popup-edit",onClick:l.touchCancelMeetingButtonHandler},{default:(0,s.w5)((()=>[je])),_:1},8,["onClick"]))])],32)],512)}var Ve=n(9117),Ae=n(3053),Ze={components:{AddButton:Xt},props:{isCreatePopup:{type:Boolean,default:!0},editingMeet:{type:Object,default:null}},setup(){return{v$:(0,Ae.ZP)()}},validations(){return{theme:{required:Ve.C1},start:{required:Ve.C1},end:{required:Ve.C1},date:{required:Ve.C1},place:{required:Ve.C1}}},data(){return{selectedClient:{name:"Клиент",id:0,inn:""},selectedContact:{name:"Контактное лицо",id:0},selectedUsersInMeeting:[{name:"Сотрудники",id:0}],clients:[{name:"Клиент",id:0,inn:""}],contacts:[{name:"Контактное лицо",id:0}],freePlaces:[{name:"Свободные переговорки",id:0,is_private:!1}],start:"",end:"",date:"",theme:"",place:{name:"Свободные переговорки",id:0,is_private:!1},note:"",users:[{name:"Сотрудники",id:0}]}},methods:{async touchSaveButtonHandler(){const t=await this.isCorrectForm();if(!t)return;let e={date:this.date,start:this.start,end:this.end,place_name:this.place.name,place_id:null!==this.place.id?this.place.id:"",topic:this.theme,note:this.note,creator_id:tt.state.user.id,contact_id:this.selectedContact.id,client_id:0!==this.selectedClient.id?this.selectedClient.id:"",employee_list:this.getEmployeeList()};if(this.isCreatePopup)e=await ct.createMeeting(e),this.$emit("createMeeting",e);else{e["id"]=this.editingMeet.id;const t=await ct.editMeeting(e);this.$emit("editMeeting",t)}this.closePopup()},closePopup(){this.$emit("closePopup"),this.clearePopup()},async isCorrectForm(){const t=await this.v$.theme.$validate(),e=await this.v$.start.$validate(),n=await this.v$.end.$validate(),i=await this.v$.date.$validate(),s=await this.v$.place.$validate();return!!(t&&e&&n&&i&&s&&this.isCorrectSelectedTime&&this.isCorrectDate)},clearePopup(){this.selectedClient="0",this.selectedContact="",this.selectedPlace="",this.clients=[],this.contacts=[],this.freePlaces=[],this.start="",this.end="",this.date="",this.theme="",this.place="",this.v$.$reset()},async selectClientHandler(){if(null!==this.selectedClient.id){const t=await ct.getClientContacts(this.selectedClient.id);this.fillContactsForSelect(t)}},contactPosition(t){return null===t.position||""===t.position?"":"("+t.position+")"},async changeTime(){""!==this.start&&""!==this.end&&""!==this.date&&await this.fillFreePlaces()},getEmployeeList(){const t=[];for(let e in this.selectedUsersInMeeting)0!==this.selectedUsersInMeeting[e].id&&t.push(this.selectedUsersInMeeting[e].id);return t},async fillDataInputs(){this.selectedClient={name:this.editingMeet.client_name,id:this.editingMeet.client_id,inn:this.editingMeet.client_inn},await this.selectClientHandler(),this.selectedContact={name:this.editingMeet.contact_name,id:this.editingMeet.contact_id},this.theme=this.editingMeet.topic,this.note=this.editingMeet.note,this.date=this.editingMeet.date,this.start=this.editingMeet.start,this.end=this.editingMeet.end,await this.fillFreePlaces(),this.place={name:this.editingMeet.place_name,id:this.editingMeet.place_id,is_private:!1},-1===this.freePlaces.indexOf(this.place)&&this.freePlaces.push(this.place),await this.fillUsers(),await this.fillSelectedUsers()},fillContactsForSelect(t){this.contacts=[{name:"Контактное лицо",id:0}];for(let e in t){const n=t[e].second_name+" "+t[e].first_name+" "+t[e].third_name;this.contacts.push({name:n,id:t[e].id})}},async fillFreePlaces(){const t=await ct.getFreePlaces(this.start,this.end,this.date);this.freePlaces=[],this.freePlaces.push({name:"Свободные переговорки",id:0,is_private:!1});let e=!1;for(let n in t)t[n].id===this.place.id&&(e=!0),this.freePlaces.push(t[n]);e||(this.place={})},async fillUsers(){const t=await ct.getUsers();this.users=[];for(let e in this.selectedUsersInMeeting)this.users.push(this.selectedUsersInMeeting[e]);for(let e in t){const n=t[e].second_name+" "+t[e].first_name+" "+t[e].third_name;this.users.push({name:n,id:t[e].id})}},async fillSelectedUsers(){const t=new Map;for(let n in this.editingMeet.employee_list)t.set(this.editingMeet.employee_list[n],null);const e=this.users;for(let n in e){const i=e[n].second_name+" "+e[n].first_name+" "+e[n].third_name;t.has(e[n].id)&&t.set(e[n].id,i)}this.selectedUsersInMeeting=[];for(let n in this.users)void 0!==t.get(this.users[n].id)&&this.selectedUsersInMeeting.push(this.users[n])},async touchCancelMeetingButtonHandler(){await ct.deleteMeeting(this.editingMeet.id),this.$emit("cancelMeeting",this.editingMeet.id),this.closePopup()}},async mounted(){let t=this;document.addEventListener("click",(function(e){e.target===t.$refs["popup_wrapper"]&&t.closePopup()}));const e=await ct.getClients(!0);for(let n in e)this.clients.push(e[n]);this.isCreatePopup?await this.fillUsers():this.fillDataInputs()},computed:{isCorrectSelectedTime(){if(""===this.start||""===this.end)return!0;const t=new Date,e=this.start.split(":")[0],n=this.start.split(":")[1];t.setHours(e,n);const i=new Date,s=this.end.split(":")[0],a=this.end.split(":")[1];return i.setHours(s,a),t<i},isCorrectDate(){if(""===this.date)return!0;if(!this.isCreatePopup)return!0;const t=new Date(this.date),e=new Date;return e.setHours(0,0,0,0),t>=e},popupTitle(){return this.isCreatePopup?"Новая встреча":"Редактирование встречи"}}};const Ke=(0,r.Z)(Ze,[["render",Be],["__scopeId","data-v-beea5e56"]]);var Ye=Ke,Qe={components:{AddButton:Xt,LoadingIndicate:R,SegmentedControl:se,EditButton:re,CreateMeet:Ye},data(){return{meetings:[],nearMeeting:void 0,isLoadedMeetings:!1,isCreateMeetMode:!1,displayCreateMeetPopup:!1,displayEditMeetPopup:!1,editingMeet:{}}},async mounted(){this.meetings=await ct.getMeetings(),this.meetings.length&&(this.nearMeeting=this.meetings[0],this.prepareMeetingsForDisplay()),this.isLoadedMeetings=!0},methods:{async prepareMeetingsForDisplay(){this.meetings.forEach((t=>{t.start=t.start.substr(0,5),t.end=t.end.substr(0,5)}))},async selectedSegmentedControl(t){if(t)return this.meetings=await ct.getMeetings(),void this.prepareMeetingsForDisplay();this.meetings=await ct.getMeetings(!0),this.prepareMeetingsForDisplay()},touchCreateMeet(){this.showPopupForMeet()},showPopupForMeet(){this.displayCreateMeetPopup=!0},closeCreatePopup(){this.displayCreateMeetPopup=!1},closeEditPopup(){this.displayEditMeetPopup=!1},displayNewMeeting(t){t.start=t.start.substr(0,5),t.end=t.end.substr(0,5),this.meetings.push(t),this.meetings.length&&(this.nearMeeting=this.meetings[0])},editMeeting(t){this.displayEditMeetPopup=!0,this.editingMeet=t},deleteMeeting(t){this.meetings=this.meetings.filter((e=>e.id!==t)),this.meetings.length?this.nearMeeting=this.meetings[0]:this.newMeeting={}},changeEditedMeeting(t){this.meetings=this.meetings.map((e=>e.id===t.id?t:e)),this.meetings.length&&(this.nearMeeting=this.meetings[0]),this.prepareMeetingsForDisplay()}}};const Je=(0,r.Z)(Qe,[["render",Yt],["__scopeId","data-v-7fdaf440"]]);var Re=Je,Ge={components:{NavBar:dt,meetings:Re}};const Xe=(0,r.Z)(Ge,[["render",h],["__scopeId","data-v-50463f30"]]);var tn=Xe;const en=t=>((0,s.dD)("data-v-116338af"),t=t(),(0,s.Cn)(),t),nn={class:"login-container"},sn=en((()=>(0,s._)("h1",{class:"title"},"Вход в систему",-1))),an={key:0,class:"validate-error-message",id:"test"},on={key:1,class:"validate-error-message"},cn={key:2,class:"validate-error-message"},ln={class:"save-container"},rn=en((()=>(0,s._)("label",{for:"save",class:"save-label"},"Запомнить",-1))),dn={key:3,class:"error-container"};function pn(t,e,n,o,c,l){return(0,s.wg)(),(0,s.iD)("div",nn,[(0,s._)("form",{onSubmit:e[4]||(e[4]=(0,i.iM)((()=>{}),["prevent"]))},[sn,(0,s.wy)((0,s._)("input",{type:"text",id:"login",name:"user_login","onUpdate:modelValue":e[0]||(e[0]=t=>c.username=t),placeholder:"Введите логин...",class:(0,a.C_)({invalid:o.v$.username.$error})},null,2),[[i.nr,c.username]]),o.v$.username.$error?((0,s.wg)(),(0,s.iD)("small",an," Логин не должен быть пустым! ")):(0,s.kq)("",!0),(0,s.wy)((0,s._)("input",{type:"password",id:"password",name:"user_password","onUpdate:modelValue":e[1]||(e[1]=t=>c.password=t),placeholder:"Введите пароль...",class:(0,a.C_)({invalid:o.v$.password.$error})},null,2),[[i.nr,c.password]]),o.v$.password.$dirty&&o.v$.password.required.$invalid?((0,s.wg)(),(0,s.iD)("small",on," Пароль является обязательным полем! ")):(0,s.kq)("",!0),o.v$.password.minLength.$invalid?((0,s.wg)(),(0,s.iD)("small",cn," Длина пароля должна быть больше 3 символов! ")):(0,s.kq)("",!0),(0,s._)("div",ln,[(0,s.wy)((0,s._)("input",{type:"checkbox",id:"save",name:"selected_save","onUpdate:modelValue":e[2]||(e[2]=t=>c.isSavedSession=t)},null,512),[[i.e8,c.isSavedSession]]),rn]),(0,s._)("button",{type:"submit",onClick:e[3]||(e[3]=(...t)=>l.touchLogIn&&l.touchLogIn(...t))},"Далее"),l.isHaveErrorAuth()?((0,s.wg)(),(0,s.iD)("div",dn,(0,a.zw)(this.$store.state.auth.errorMessage),1)):(0,s.kq)("",!0)],32)])}var un={setup(){return{v$:(0,Ae.ZP)()}},data(){return{username:"",password:"",isSavedSession:!1,passwordPlaceholder:"Введите пароль...",loginPlaceholder:"Введите логин..."}},validations(){return{username:{required:Ve.C1},password:{required:Ve.C1,minLength:(0,Ve.Ei)(4)}}},methods:{...(0,c.nv)(["logIn"]),async touchLogIn(){const t=await this.v$.$validate();if(!t)return;const e=await this.logIn({username:this.username,password:this.password,isSavedSession:this.isSavedSession});e?this.$router.push("/"):this.$router.push("/login")},isHaveErrorAuth(){return""!==this.$store.state.auth.errorMessage},isValidForm(){const t=4;return this.validationErrors=[],!!(this.username.length&&this.password.length>=t)}}};const hn=(0,r.Z)(un,[["render",pn],["__scopeId","data-v-116338af"]]);var mn=hn;const Cn=t=>((0,s.dD)("data-v-ebb14590"),t=t(),(0,s.Cn)(),t),wn={class:"calendar-container"},gn=Cn((()=>(0,s._)("h1",null,"Calendar page",-1)));function vn(t,e,n,i,a,o){const c=(0,s.up)("nav-bar"),l=(0,s.up)("loading-indicate");return(0,s.wg)(),(0,s.iD)("div",wn,[(0,s.Wm)(c),(0,s._)("main",null,[gn,(0,s.Wm)(l)])])}var _n={components:{NavBar:dt,LoadingIndicate:R}};const yn=(0,r.Z)(_n,[["render",vn],["__scopeId","data-v-ebb14590"]]);var fn=yn;const kn=t=>((0,s.dD)("data-v-d9b21228"),t=t(),(0,s.Cn)(),t),bn={class:"wrapper"},Mn={class:"list-checkbox"},Pn=kn((()=>(0,s._)("h1",null,"Список клиентов",-1))),In={class:"checkbox"},Dn={class:"display"},$n=kn((()=>(0,s._)("label",{for:"highload1","data-onlabel":"","data-offlabel":"",class:"lb1"},null,-1))),Sn={action:"",class:"search-form"},Fn=kn((()=>(0,s._)("img",{src:"/svg/search.svg",alt:"",class:"search-icon"},null,-1))),xn={key:0,class:"client-list-container"},En={class:"clients-container"},Hn={key:0,class:"clients-list"},Un={key:1,class:"clients-list empty"},Ln=kn((()=>(0,s._)("li",{class:"clients-item clients-item-empty"},[(0,s._)("span",{class:"empty-message"},"Нет клиентов")],-1))),Nn=[Ln],Tn=(0,s.Uk)("Добавить нового клиента"),On={class:"popup-title"},qn={class:"company-name-container"},zn={key:0,class:"validate-error-message"},Wn={class:"company-inn-container"},jn={key:0,class:"validate-error-message"},Bn={key:1,class:"validate-error-message"},Vn={key:0,class:"validate-error-message"},An={class:"popup-title"},Zn={class:"contact-name-container first-name"},Kn={key:0,class:"validate-error-message"},Yn={class:"contact-name-container second-name"},Qn={key:0,class:"validate-error-message"},Jn={class:"contact-name-container third-name"},Rn={class:"contact-phone-container"},Gn={class:"contact-position-container"},Xn={class:"contact-email-container"},ti={key:0,class:"validate-error-message"};function ei(t,e,n,o,c,l){const r=(0,s.up)("nav-bar"),d=(0,s.up)("client"),p=(0,s.up)("add-button"),u=(0,s.up)("loading-indicate"),h=(0,s.up)("popup");return(0,s.wg)(),(0,s.iD)("div",bn,[(0,s.Wm)(r),(0,s._)("main",null,[(0,s._)("div",Mn,[Pn,(0,s._)("div",In,[(0,s._)("h3",Dn,(0,a.zw)(l.checkboxTitle),1),(0,s._)("input",{type:"checkbox",name:"highload1",id:"highload1",onClick:e[0]||(e[0]=(...t)=>l.touchCheckbox&&l.touchCheckbox(...t)),checked:""}),$n])]),(0,s._)("form",Sn,[(0,s.wy)((0,s._)("input",{type:"text",class:"search-input","onUpdate:modelValue":e[1]||(e[1]=t=>c.searchQuery=t),placeholder:""},null,512),[[i.nr,c.searchQuery]]),Fn]),c.isLoadedClientsFromApi?((0,s.wg)(),(0,s.iD)("div",xn,[(0,s._)("div",En,[c.clients.length?((0,s.wg)(),(0,s.iD)("ul",Hn,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(l.searchedClients,(t=>((0,s.wg)(),(0,s.iD)("li",{key:t},[(0,s.Wm)(d,{clientData:t,onEdit:l.touchEditClient,onCreate:l.touchCreateContact,onEditContact:l.touchEditContact,newContact:l.prepareNewContactForChildComponent(t.id)},null,8,["clientData","onEdit","onCreate","onEditContact","newContact"])])))),128))])):((0,s.wg)(),(0,s.iD)("ul",Un,Nn))]),(0,s.Wm)(p,{class:"add-button",onClick:l.touchCreateClient},{default:(0,s.w5)((()=>[Tn])),_:1},8,["onClick"])])):((0,s.wg)(),(0,s.j4)(u,{key:1})),c.displayClientPopup?((0,s.wg)(),(0,s.j4)(h,{key:2,onClosePopup:l.closePopupForClient,class:"client__modal-window"},{header:(0,s.w5)((()=>[(0,s._)("span",On,(0,a.zw)(l.clientPopupTitle),1)])),content:(0,s.w5)((()=>[(0,s._)("div",qn,[(0,s.wy)((0,s._)("input",{type:"text",class:(0,a.C_)(["company-name-input",{invalid:o.v$.newClientName.$error}]),placeholder:"Имя клиента","onUpdate:modelValue":e[2]||(e[2]=t=>c.newClientName=t)},null,2),[[i.nr,c.newClientName]]),o.v$.newClientName.$error?((0,s.wg)(),(0,s.iD)("small",zn," Имя клиента не должно быть пустым! ")):(0,s.kq)("",!0)]),(0,s._)("div",Wn,[(0,s.wy)((0,s._)("input",{type:"text",class:(0,a.C_)(["company-inn-input",{invalid:o.v$.newClientInn.$error}]),placeholder:"ИНН","onUpdate:modelValue":e[3]||(e[3]=t=>c.newClientInn=t)},null,2),[[i.nr,c.newClientInn]]),o.v$.newClientInn.$dirty&&o.v$.newClientInn.required.$invalid?((0,s.wg)(),(0,s.iD)("small",jn," ИНН является обязательным полем! ")):(0,s.kq)("",!0),o.v$.newClientInn.minLength.$invalid||o.v$.newClientInn.maxLength.$invalid?((0,s.wg)(),(0,s.iD)("small",Bn," Длина ИНН должна быть длиной 12 символов! ")):(0,s.kq)("",!0)])])),footer:(0,s.w5)((()=>[(0,s.Wm)(p,{class:"popup-footer-btn",onClick:l.clientPopupActionHandler},{default:(0,s.w5)((()=>[(0,s.Uk)((0,a.zw)(l.popupButtonTitle),1)])),_:1},8,["onClick"]),c.isExistClient?((0,s.wg)(),(0,s.iD)("small",Vn," Клиент с таким ИНН уже существует! ")):(0,s.kq)("",!0)])),_:1},8,["onClosePopup"])):(0,s.kq)("",!0),c.displayContactPopup?((0,s.wg)(),(0,s.j4)(h,{key:3,onClosePopup:l.closePopupForContact,class:"contact__modal-window"},{header:(0,s.w5)((()=>[(0,s._)("span",An,(0,a.zw)(l.contactPopupTitle),1)])),content:(0,s.w5)((()=>[(0,s._)("div",Zn,[(0,s.wy)((0,s._)("input",{type:"text",class:(0,a.C_)(["contact-name-input",{invalid:o.v$.newContactFirstName.$error}]),placeholder:"Имя","onUpdate:modelValue":e[4]||(e[4]=t=>c.newContactFirstName=t)},null,2),[[i.nr,c.newContactFirstName]]),o.v$.newContactFirstName.$error?((0,s.wg)(),(0,s.iD)("small",Kn," Имя контакта не должно быть пустым! ")):(0,s.kq)("",!0)]),(0,s._)("div",Yn,[(0,s.wy)((0,s._)("input",{type:"text",class:(0,a.C_)(["contact-name-input",{invalid:o.v$.newContactSecondName.$error}]),placeholder:"Фамилия","onUpdate:modelValue":e[5]||(e[5]=t=>c.newContactSecondName=t)},null,2),[[i.nr,c.newContactSecondName]]),o.v$.newContactSecondName.$error?((0,s.wg)(),(0,s.iD)("small",Qn," Фамилия контакта не должна быть пустой! ")):(0,s.kq)("",!0)]),(0,s._)("div",Jn,[(0,s.wy)((0,s._)("input",{type:"text",class:"contact-name-input",placeholder:"Отчество","onUpdate:modelValue":e[6]||(e[6]=t=>c.newContactThirdName=t)},null,512),[[i.nr,c.newContactThirdName]])]),(0,s._)("div",Rn,[(0,s.wy)((0,s._)("input",{type:"text",class:"contact-phone-input",placeholder:"Телефон","onUpdate:modelValue":e[7]||(e[7]=t=>c.newContactPhone=t)},null,512),[[i.nr,c.newContactPhone]])]),(0,s._)("div",Gn,[(0,s.wy)((0,s._)("input",{type:"text",class:"contact-position-input",placeholder:"Должность","onUpdate:modelValue":e[8]||(e[8]=t=>c.newContactPosition=t)},null,512),[[i.nr,c.newContactPosition]])]),(0,s._)("div",Xn,[(0,s.wy)((0,s._)("input",{type:"text",class:"contact-email-input",placeholder:"Почта","onUpdate:modelValue":e[9]||(e[9]=t=>c.newContactEmail=t)},null,512),[[i.nr,c.newContactEmail]])])])),footer:(0,s.w5)((()=>[(0,s.Wm)(p,{class:"popup-footer-btn",onClick:l.contactPopupActionHandler},{default:(0,s.w5)((()=>[(0,s.Uk)((0,a.zw)(l.popupButtonTitle),1)])),_:1},8,["onClick"]),c.isExistContact?((0,s.wg)(),(0,s.iD)("small",ti," Контакт с таким именем и клиентом уже существует! ")):(0,s.kq)("",!0)])),_:1},8,["onClosePopup"])):(0,s.kq)("",!0)])])}n(6699);const ni=t=>((0,s.dD)("data-v-6f43a66c"),t=t(),(0,s.Cn)(),t),ii={class:"client-container"},si={class:"client"},ai=ni((()=>(0,s._)("div",{class:"client-icon-container"},[(0,s._)("img",{class:"client-icon",src:"/svg/client-icon.svg"})],-1))),oi={class:"client-name"},ci={class:"client-name-content"},li={class:"client-inn"},ri={class:"client-inn-content"},di={class:"header-buttons"},pi={key:1,class:"contact-list-container"},ui={key:0,class:"contact-list"},hi={key:1,"contact-list":""};function mi(t,e,n,i,o,c){const l=(0,s.up)("edit-button"),r=(0,s.up)("show-info-btn"),d=(0,s.up)("client-history"),p=(0,s.up)("contact");return(0,s.wg)(),(0,s.iD)("div",ii,[(0,s._)("div",si,[ai,(0,s._)("div",oi,[(0,s._)("p",ci,(0,a.zw)(o.client.name),1)]),(0,s._)("div",li,[(0,s._)("p",ri,"ИНН: "+(0,a.zw)(o.client.inn),1)]),(0,s._)("div",di,[(0,s.Wm)(l,{class:"edit-btn",onClick:c.editClient},null,8,["onClick"]),(0,s._)("button",{class:"create-contact-btn",onClick:e[0]||(e[0]=(...t)=>c.touchCreateContact&&c.touchCreateContact(...t))}),(0,s._)("button",{class:"show-client-history",onClick:e[1]||(e[1]=(...t)=>c.touchShowCLientHistory&&c.touchShowCLientHistory(...t))}," Встречи "),(0,s.Wm)(r,{class:"show-info-btn",onClick:c.touchClientInfoButton,showInfo:o.isShowContactList},null,8,["onClick","showInfo"])])]),o.isShowClientHistory?((0,s.wg)(),(0,s.j4)(d,{key:0,onClose:c.closeHistory},null,8,["onClose"])):(0,s.kq)("",!0),o.isShowContactList?((0,s.wg)(),(0,s.iD)("div",pi,[c.allContacts.length?((0,s.wg)(),(0,s.iD)("ul",ui,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(c.allContacts,(t=>((0,s.wg)(),(0,s.iD)("li",{class:"contact-item",key:t},[(0,s.Wm)(p,{contactData:t,onEdit:e=>c.touchEditContact(t)},null,8,["contactData","onEdit"])])))),128))])):((0,s.wg)(),(0,s.iD)("ul",hi,[(0,s.Wm)(p)]))])):(0,s.kq)("",!0)])}const Ci=t=>((0,s.dD)("data-v-79b1c917"),t=t(),(0,s.Cn)(),t),wi={key:0,class:"contact-item"},gi={class:"contact-item__header"},vi={class:"contact-name"},_i={class:"contact-name-content"},yi={class:"header-buttons"},fi={key:0,class:"contact-details__content"},ki={class:"contact-email"},bi={class:"contact-email-content"},Mi={class:"contact-position"},Pi={class:"contact-position-content"},Ii={class:"contact-number"},Di={class:"contact-number-content"},$i={key:1,class:"contact-item empty"},Si=Ci((()=>(0,s._)("span",null,"Нет контактов",-1))),Fi=[Si];function xi(t,e,n,i,o,c){const l=(0,s.up)("edit-button"),r=(0,s.up)("show-info-btn");return void 0!==this.contact?((0,s.wg)(),(0,s.iD)("div",wi,[(0,s._)("div",gi,[(0,s._)("div",vi,[(0,s._)("span",_i,(0,a.zw)(o.contact.first_name)+" "+(0,a.zw)(o.contact.second_name)+" "+(0,a.zw)(o.contact.third_name),1)]),(0,s._)("div",yi,[(0,s.Wm)(l,{onClick:c.editContact},null,8,["onClick"]),(0,s.Wm)(r,{class:"show-info-btn",onClick:c.touchContactInfoButton,showInfo:o.showContactInfo},null,8,["onClick","showInfo"])])]),o.showContactInfo?((0,s.wg)(),(0,s.iD)("div",fi,[(0,s._)("div",ki,[(0,s._)("p",bi,"Почта: "+(0,a.zw)(o.contact.email),1),(0,s._)("i",{class:"material-icons copy-btn",onClick:e[0]||(e[0]=t=>c.copyContentToBuffer(o.contact.email))}," content_copy ")]),(0,s._)("div",Mi,[(0,s._)("p",Pi," Должность: "+(0,a.zw)(o.contact.position),1),(0,s._)("i",{class:"material-icons copy-btn",onClick:e[1]||(e[1]=t=>c.copyContentToBuffer(o.contact.position))}," content_copy ")]),(0,s._)("div",Ii,[(0,s._)("p",Di,"Телефон: "+(0,a.zw)(o.contact.phone),1),(0,s._)("i",{class:"material-icons copy-btn",onClick:e[2]||(e[2]=t=>c.copyContentToBuffer(o.contact.phone))}," content_copy ")])])):(0,s.kq)("",!0)])):((0,s.wg)(),(0,s.iD)("div",$i,Fi))}const Ei={class:"show-info"},Hi={class:"show-info-content"};function Ui(t,e,n,i,o,c){return(0,s.wg)(),(0,s.iD)("div",Ei,[(0,s._)("button",Hi,(0,a.zw)(c.buttonTitle),1)])}var Li={props:{showInfo:{type:Boolean,default:!1}},computed:{buttonTitle:function(){return this.showInfo?"Скрыть":"Подробнее"}},data(){return{isShowContactList:!1}}};const Ni=(0,r.Z)(Li,[["render",Ui],["__scopeId","data-v-5e8434e5"]]);var Ti=Ni,Oi={components:{ShowInfoBtn:Ti,EditButton:re},data(){return{showContactInfo:!1,contact:this.contactData}},props:{contactData:{type:Object,default:void 0}},methods:{touchContactInfoButton(){this.showContactInfo=!this.showContactInfo},async editContact(){this.$emit("edit",this.contact)},copyContentToBuffer(t){navigator.clipboard.writeText(null===t?"":t)}}};const qi=(0,r.Z)(Oi,[["render",xi],["__scopeId","data-v-79b1c917"]]);var zi=qi;const Wi=t=>((0,s.dD)("data-v-61a1c5ba"),t=t(),(0,s.Cn)(),t),ji={class:"client-history-container"},Bi={class:"close-container"},Vi=Wi((()=>(0,s._)("p",null,"x",-1))),Ai=[Vi],Zi={key:0,class:"history-list-container"},Ki={key:0,class:"client-history-list"},Yi={class:"history-item-number"},Qi={class:"history-item-date"},Ji={class:"history-item-meeting-topic"},Ri={key:1,class:"client-history-list empty"},Gi=Wi((()=>(0,s._)("li",{class:"history-list-item empty-item"},"История пуста...",-1))),Xi=[Gi];function ts(t,e,n,i,o,c){const l=(0,s.up)("loading-indicate");return(0,s.wg)(),(0,s.iD)("div",ji,[(0,s._)("div",Bi,[(0,s._)("button",{class:"close-btn",onClick:e[0]||(e[0]=(...t)=>c.closeHistory&&c.closeHistory(...t))},Ai)]),o.isLoadedData?((0,s.wg)(),(0,s.iD)("div",Zi,[o.historyList.length?((0,s.wg)(),(0,s.iD)("ul",Ki,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(o.historyList,(t=>((0,s.wg)(),(0,s.iD)("li",{class:"history-list-item",key:t},[(0,s._)("span",Yi,(0,a.zw)(this.historyList.indexOf(t)+1)+".",1),(0,s._)("span",Qi,(0,a.zw)(t.date),1),(0,s._)("span",Ji,(0,a.zw)(t.topic),1)])))),128))])):((0,s.wg)(),(0,s.iD)("ul",Ri,Xi))])):((0,s.wg)(),(0,s.j4)(l,{key:1,class:"loading-indicate"}))])}var es={components:{LoadingIndicate:R},data(){return{historyList:[],isLoadedData:!1}},async mounted(){this.isLoadedData=!0},methods:{closeHistory(){this.$emit("close")}},props:{client:{type:Object}}};const ns=(0,r.Z)(es,[["render",ts],["__scopeId","data-v-61a1c5ba"]]);var is=ns,ss={components:{Contact:zi,ShowInfoBtn:Ti,EditButton:re,ClientHistory:is},data(){return{isShowContactList:!1,isShowClientHistory:!1,contacts:[],client:this.clientData,isCreateContactMode:!0}},props:{clientData:{type:Object,default:{}},newContact:{type:Object,default:void 0}},methods:{async touchClientInfoButton(){this.isShowContactList||(this.contacts=await ct.getClientContacts(this.clientData.id)),this.isShowContactList=!this.isShowContactList},touchCreateContact(){this.$emit("create",this.clientData),this.isCreateContactMode=!0},editClient(){this.$emit("edit",this.clientData)},touchEditContact(t){this.$emit("editContact",t),this.isCreateContactMode=!1},touchShowCLientHistory(){this.isShowClientHistory=!0},closeHistory(){this.isShowClientHistory=!1}},computed:{allContacts(){if(void 0===this.newContact)return this.contacts;return this.contacts=this.contacts.map(((t,e)=>t.id===this.newContact.id?(!1,this.newContact):t)),this.isCreateContactMode&&this.contacts.push(this.newContact),this.contacts}}};const as=(0,r.Z)(ss,[["render",mi],["__scopeId","data-v-6f43a66c"]]);var os=as,cs={components:{NavBar:dt,LoadingIndicate:R,Client:os,AddButton:Xt,Popup:j},setup(){return{v$:(0,Ae.ZP)()}},validations(){return{newClientName:{required:Ve.C1},newClientInn:{required:Ve.C1,minLength:(0,Ve.Ei)(12),maxLength:(0,Ve.BS)(12)},newContactFirstName:{required:Ve.C1},newContactSecondName:{required:Ve.C1}}},data(){return{clients:[],isLoadedClientsFromApi:!1,searchQuery:"",isMyClients:!0,displayClientPopup:!1,displayContactPopup:!1,newClientName:"",newClientInn:"",newContactFirstName:"",newContactThirdName:"",newContactSecondName:"",newContactPhone:"",newContactPosition:"",newContactEmail:"",isExistClient:!1,isExistContact:!1,isCreateClientMode:!1,isCreateContactMode:!1,editClientObject:{},editContactObject:{},clientIdForNewContact:"",newContactForClient:new Map,editClientObject:{name:"",inn:""}}},async mounted(){this.clients=await ct.getClients(!0),this.isLoadedClientsFromApi=!0},computed:{searchedClients(){return this.clients.filter((t=>t.name.toLowerCase().includes(this.searchQuery.toLowerCase())||t.inn.includes(this.searchQuery)))},checkboxTitle(){return this.isMyClients?"Мои клиенты":"Все клиенты"},employee_list(){let t=new Array;return t.push(tt.state.user.id),t},popupButtonTitle(){return this.isCreateClientMode||this.isCreateContactMode?"Создать":"Сохранить"},clientPopupTitle(){return this.isCreateClientMode?"Создание клиента":"Редактирование клиента"},contactPopupTitle(){return this.isCreateContactMode?"Создание контакта":"Редактирование контакта"}},methods:{prepareNewContactForChildComponent(t){const e=this.newContactForClient.get(t);return this.newContactForClient.delete(t),e},async editClient(){const t=await this.isCorrectClientForm();if(!t)return;this.editClientObject.name=this.newClientName,this.editClientObject.inn=this.newClientInn;await ct.editClient(this.editClientObject);this.closePopupForClient()},touchEditClient(t){this.editClientObject=t,this.newClientName=t.name,this.newClientInn=t.inn,this.isCreateClientMode=!1,this.showPopupForClient()},touchCreateClient(){this.isCreateClientMode=!0,this.showPopupForClient()},touchCreateContact(t){this.isCreateContactMode=!0,this.showPopupForContact(),this.clientIdForNewContact=t.id},touchEditContact(t){this.isCreateContactMode=!1,this.showPopupForContact(),this.editContactObject=t,this.newContactFirstName=t.first_name,this.newContactSecondName=t.second_name,this.newContactThirdName=t.third_name,this.newContactPosition=t.position,this.newContactPhone=t.phone,this.newContactEmail=t.email},async createClient(){this.isExistClient=!1;const t=await this.isCorrectClientForm();if(!t)return;const e={name:this.newClientName,inn:this.newClientInn,employee_list:this.employee_list};if(this.isExistClient=await ct.isExistClient(e),this.isExistClient)return;const n=await ct.createClient(e);this.clients.push(n),this.closePopupForClient()},async touchCheckbox(){this.isLoadedClientsFromApi=!1,this.isMyClients=!this.isMyClients,this.clients=await ct.getClients(this.isMyClients),this.isLoadedClientsFromApi=!0},closePopupForClient(){this.displayClientPopup=!1,this.cleareCreateClientPopup(),this.isExistClient=!1,this.isCreateClientMode=!1},closePopupForContact(){this.displayContactPopup=!1,this.cleareCreateContactPopup(),this.isExistContact=!1},showPopupForClient(){this.displayClientPopup=!0},showPopupForContact(){this.displayContactPopup=!0},cleareCreateClientPopup(){this.newClientName="",this.newClientInn="",this.v$.$reset()},cleareCreateContactPopup(){this.newContactFirstName="",this.newContactSecondName="",this.newContactThirdName="",this.newContactPhone="",this.newContactPosition="",this.newContactEmail="",this.v$.$reset()},async clientPopupActionHandler(){this.isCreateClientMode?await this.createClient():await this.editClient()},async contactPopupActionHandler(){this.isCreateContactMode?await this.createContact():await this.editContact()},async createContact(){this.isExistContact=!1;const t=await this.isCorrectContactForm();if(!t)return;const e={client:this.clientIdForNewContact,first_name:this.newContactFirstName,second_name:this.newContactSecondName,third_name:this.newContactThirdName,phone:this.newContactPhone,position:this.newContactPosition,email:this.newContactEmail};if(this.isExistContact=await ct.isExistContact(e),this.isExistContact)return;const n=await ct.createContact(e);this.newContactForClient.set(e.client,n),this.closePopupForContact()},async editContact(){const t=await this.isCorrectContactForm();if(!t)return;const e=await ct.editContact({first_name:this.newContactFirstName,second_name:this.newContactSecondName,third_name:this.newContactThirdName,phone:this.newContactPhone,position:this.newContactPosition,email:this.newContactEmail,client:this.editContactObject.client,id:this.editContactObject.id});this.newContactForClient.set(this.editContactObject.client,e),this.closePopupForContact()},async isCorrectContactForm(){const t=await this.v$.newContactFirstName.$validate(),e=await this.v$.newContactSecondName.$validate();return!(!t||!e)},async isCorrectClientForm(){const t=await this.v$.newClientName.$validate(),e=await this.v$.newClientInn.$validate();return!(!t||!e)}}};const ls=(0,r.Z)(cs,[["render",ei],["__scopeId","data-v-d9b21228"]]);var rs=ls;const ds=t=>((0,s.dD)("data-v-69d823c9"),t=t(),(0,s.Cn)(),t),ps={class:"wrapper"},us=ds((()=>(0,s._)("h1",null,"Meeting results page",-1)));function hs(t,e,n,i,a,o){const c=(0,s.up)("nav-bar"),l=(0,s.up)("loading-indicate");return(0,s.wg)(),(0,s.iD)("div",ps,[(0,s.Wm)(c),us,(0,s.Wm)(l)])}var ms={components:{NavBar:dt,LoadingIndicate:R}};const Cs=(0,r.Z)(ms,[["render",hs],["__scopeId","data-v-69d823c9"]]);var ws=Cs,gs=n(2483);const vs=[{path:"/",component:tn,name:"Главная"},{path:"/login",component:mn,name:"Вход"},{path:"/calendar",component:fn,name:"Календарь"},{path:"/results",component:ws,name:"Отчеты"},{path:"/clients",component:rs,name:"Клиенты"}],_s=(0,gs.p7)({routes:vs,history:(0,gs.PO)()});_s.beforeEach(((t,e,n)=>{document.title=t.name,n()}));var ys=_s;const fs=(0,c.MT)({modules:{auth:tt}});var ks=fs;const bs=(0,i.ri)(p);bs.use(ys),bs.use(ks),bs.mount("#app")}},e={};function n(i){var s=e[i];if(void 0!==s)return s.exports;var a=e[i]={exports:{}};return t[i](a,a.exports,n),a.exports}n.m=t,function(){var t=[];n.O=function(e,i,s,a){if(!i){var o=1/0;for(d=0;d<t.length;d++){i=t[d][0],s=t[d][1],a=t[d][2];for(var c=!0,l=0;l<i.length;l++)(!1&a||o>=a)&&Object.keys(n.O).every((function(t){return n.O[t](i[l])}))?i.splice(l--,1):(c=!1,a<o&&(o=a));if(c){t.splice(d--,1);var r=s();void 0!==r&&(e=r)}}return e}a=a||0;for(var d=t.length;d>0&&t[d-1][2]>a;d--)t[d]=t[d-1];t[d]=[i,s,a]}}(),function(){n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,{a:e}),e}}(),function(){n.d=function(t,e){for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={143:0};n.O.j=function(e){return 0===t[e]};var e=function(e,i){var s,a,o=i[0],c=i[1],l=i[2],r=0;if(o.some((function(e){return 0!==t[e]}))){for(s in c)n.o(c,s)&&(n.m[s]=c[s]);if(l)var d=l(n)}for(e&&e(i);r<o.length;r++)a=o[r],n.o(t,a)&&t[a]&&t[a][0](),t[a]=0;return n.O(d)},i=self["webpackChunkvue_project"]=self["webpackChunkvue_project"]||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))}();var i=n.O(void 0,[998],(function(){return n(606)}));i=n.O(i)})();
//# sourceMappingURL=app.34bd06f2.js.map