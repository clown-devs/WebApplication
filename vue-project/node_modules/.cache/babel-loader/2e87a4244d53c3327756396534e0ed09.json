{"ast":null,"code":"import axios from \"./instance\";\nimport auth from '@/store/modules/auth';\nconst API_KEY = 'api/v2/';\nconst OLD_API_KEY = 'api/v1/';\nconst API_PATHS = {\n  auth: 'users/auth/token/login/',\n  user: 'users/employee/current/',\n  meetings: 'meeting',\n  client: 'users/employee/current',\n  contact: 'contact/',\n  place: 'place/',\n  employeelist: 'employeelist/'\n};\nconst api = {\n  error: {},\n\n  async auth(username, password) {\n    try {\n      const res = await axios.post(API_KEY + API_PATHS['auth'], {\n        username,\n        password\n      });\n      return res.data;\n    } catch (error) {\n      this.errorHandle(error);\n      return null;\n    }\n  },\n\n  async currentUser(token) {\n    try {\n      const res = await axios.get(API_KEY + API_PATHS['user']);\n      return res.data;\n    } catch (error) {\n      this.errorHandle(error);\n      return null;\n    }\n  },\n\n  async getMeetings(past = false) {\n    try {\n      const res = await axios.get(OLD_API_KEY + API_PATHS['meetings'] + (past ? '?past=true' : '/'));\n      return res.data;\n    } catch (error) {\n      this.errorHandle(error);\n      return [];\n    }\n  },\n\n  async getClient(id) {\n    try {\n      const res = await axios.get(API_KEY + API_PATHS['client'] + String(id));\n      return res.data;\n    } catch (error) {\n      this.errorHandle(error);\n      return {};\n    }\n  },\n\n  async getClients() {\n    try {\n      let clients = await axios.get(API_KEY + API_PATHS['client']);\n      return clients.data;\n    } catch (error) {\n      this.errorHandle(error);\n      return [];\n    }\n  },\n\n  async getContact(id) {\n    try {\n      let contact = await axios.get(OLD_API_KEY + API_PATHS['contact'] + String(id));\n      return contact.data;\n    } catch (error) {\n      this.errorHandle(error);\n      return {};\n    }\n  },\n\n  async getContacts() {\n    try {\n      let contacts = await axios.get(OLD_API_KEY + API_PATHS['contact']);\n      return contacts.data;\n    } catch (error) {\n      this.errorHandle(error);\n      return [];\n    }\n  },\n\n  async getPlaces() {\n    try {\n      let places = await axios.get(OLD_API_KEY + API_PATHS['place']);\n      return places.data;\n    } catch (error) {\n      this.errorHandle(error);\n      return [];\n    }\n  },\n\n  async getFreePlaces(start, end, date) {\n    try {\n      let places = await axios.get(OLD_API_KEY + API_PATHS['place'] + '?date=' + date + '&start=' + start + '&end=' + end);\n      return places.data;\n    } catch (error) {\n      this.errorHandle(error);\n      return [];\n    }\n  },\n\n  async createMeeting(meeting) {\n    try {\n      const newMeeting = await axios.post(OLD_API_KEY + API_PATHS['meetings'] + '/', meeting);\n      const newEmployee = await axios.post(OLD_API_KEY + API_PATHS['employeelist'], {\n        \"employee\": newMeeting.data().creator,\n        \"meeting\": newMeeting.data().id\n      });\n      return newEmployee.data();\n    } catch (error) {\n      this.errorHandle(error);\n      return {};\n    }\n  },\n\n  errorHandle(error) {\n    if (error.response) {\n      switch (error.response.status) {\n        case 400:\n          this.error = \"Неверный логин/пароль\";\n          break;\n\n        case 401:\n          this.error = error.response.statusText + \".\" + error.response.data.detail;\n          break;\n\n        default:\n          this.error = error.message + \".\" + error.response.statusText;\n      }\n    } else if (error.request) {\n      this.error = \"Bad connection\";\n    } else {//\n    }\n  }\n\n};\nexport default api;","map":{"version":3,"names":["axios","auth","API_KEY","OLD_API_KEY","API_PATHS","user","meetings","client","contact","place","employeelist","api","error","username","password","res","post","data","errorHandle","currentUser","token","get","getMeetings","past","getClient","id","String","getClients","clients","getContact","getContacts","contacts","getPlaces","places","getFreePlaces","start","end","date","createMeeting","meeting","newMeeting","newEmployee","creator","response","status","statusText","detail","message","request"],"sources":["/Users/root1/Developments/SberMeetingsWeb/WebApplication/vue-project/src/api/index.js"],"sourcesContent":["import axios from \"./instance\";\nimport auth from '@/store/modules/auth'\n\nconst API_KEY = 'api/v2/';\nconst OLD_API_KEY = 'api/v1/';\n\nconst API_PATHS = {\n    auth: 'users/auth/token/login/',\n    user: 'users/employee/current/',\n    meetings: 'meeting',\n    client: 'users/employee/current',\n    contact: 'contact/',\n    place: 'place/',\n    employeelist: 'employeelist/'\n}\n\nconst api = {\n\n    error: {},\n\n    async auth(username, password) {\n\n        try {\n            const res = await axios.post(API_KEY + API_PATHS['auth'], {\n                username,\n                password\n            });\n\n            return res.data;\n\n        } catch (error) {\n            this.errorHandle(error);\n            return null;\n        }\n\n    },\n\n    async currentUser(token) {\n        try {\n            const res = await axios.get(API_KEY + API_PATHS['user']);\n\n            return res.data;\n\n        } catch (error) {\n            this.errorHandle(error);\n            return null;\n        }\n    },\n\n    async getMeetings(past = false) {\n\n        try {\n            const res = await axios.get(\n                OLD_API_KEY + API_PATHS['meetings'] + (past ? '?past=true' : '/')\n            );\n            return res.data;\n\n        } catch (error) {\n            this.errorHandle(error);\n            return [];\n        }\n\n    },\n\n    async getClient(id) {\n        try {\n            const res = await axios.get(\n                API_KEY + API_PATHS['client'] + String(id)\n            );\n            return res.data;\n\n        } catch (error) {\n            this.errorHandle(error);\n            return {};\n        }\n    },\n\n    async getClients() {\n        try {\n            let clients = await axios.get(\n                API_KEY + API_PATHS['client']\n            );\n            return clients.data;\n\n        } catch (error) {\n            this.errorHandle(error);\n            return [];\n        }\n    },\n\n    async getContact(id) {\n        try {\n            let contact = await axios.get(\n                OLD_API_KEY + API_PATHS['contact'] + String(id)\n            );\n            return contact.data;\n\n        } catch (error) {\n            this.errorHandle(error);\n            return {};\n        }\n    },\n\n    async getContacts() {\n        try {\n            let contacts = await axios.get(\n                OLD_API_KEY + API_PATHS['contact']\n            );\n            return contacts.data;\n\n        } catch (error) {\n            this.errorHandle(error);\n            return [];\n        }\n    },\n\n    async getPlaces() {\n        try {\n            let places = await axios.get(\n                OLD_API_KEY + API_PATHS['place']\n            );\n            return places.data;\n\n        } catch (error) {\n            this.errorHandle(error);\n            return [];\n        }\n    },\n\n    async getFreePlaces(start, end, date) {\n        try {\n            let places = await axios.get(\n                OLD_API_KEY \n                + API_PATHS['place']\n                + '?date=' + date\n                + '&start=' + start\n                + '&end=' + end\n            );\n            return places.data;\n\n        } catch (error) {\n            this.errorHandle(error);\n            return [];\n        }\n    },\n\n    async createMeeting(meeting) {\n        try {\n            const newMeeting = await axios.post(\n                OLD_API_KEY + API_PATHS['meetings'] + '/', meeting\n            );\n            \n            const newEmployee = await axios.post(\n                OLD_API_KEY + API_PATHS['employeelist'], {\n                \"employee\": newMeeting.data().creator,\n                \"meeting\": newMeeting.data().id\n            });\n            \n            return newEmployee.data();\n\n        } catch(error) {\n            this.errorHandle(error);\n            return {};\n        }\n    },\n\n    errorHandle(error) {\n\n        if (error.response) {\n\n            switch (error.response.status) {\n                case 400:\n                    this.error = \"Неверный логин/пароль\";\n                    break;\n                case 401:\n                    this.error =\n                        error.response.statusText\n                        + \".\"\n                        + error.response.data.detail\n                        ;\n                    break;\n                default:\n                    this.error = error.message + \".\" + error.response.statusText;\n            }\n\n        } else if (error.request) {\n\n            this.error = \"Bad connection\";\n\n        } else {\n\n            //\n\n        }\n    }\n\n};\n\nexport default api;"],"mappings":"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"},"metadata":{},"sourceType":"module"}